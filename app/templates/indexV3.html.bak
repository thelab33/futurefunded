{# =========================
   PRECOMPUTE SAFE VARS
   ========================= #}
{% set PROGRESS_PCT   = PROGRESS_PCT|default(progress|default(0)) %}
{% set pct_int        = PROGRESS_PCT|int %}
{% set IS_NEAR_GOAL   = pct_int>= 80 and pct_int < 100 %}
{% set IS_GOAL_MET    = pct_int>= 100 %}
{% set html_classes   = 'fc-theme fc-diamond-2025'
  ~ (' near-goal' if IS_NEAR_GOAL else '')
  ~ (' goal-met'  if IS_GOAL_MET else '')
%}
{% set NONCE = NONCE if NONCE is defined else (csp_nonce if csp_nonce is defined else '') %}
{% macro nonce_attr() -%}{% if NONCE %}nonce="{{ NONCE }}"{% endif %}{%- endmacro %}

{# ---------- Canonical naming + sharing copy ---------- #}
{% set platform_name = brand_name|default('FundChamps') %}
{% set team_name     = team_name|default('Your Program') %}
{% set ORG_TEAM_NAME = ORG_TEAM_NAME if ORG_TEAM_NAME is defined and ORG_TEAM_NAME else team_name %}
{% set TAGLINE       = TAGLINE|default('Fuel the season. Fund the future.') %}
{% set SPORT_LABEL   = SPORT_LABEL|default('season') %}

{# platform / powered-by branding #}
{% set platform_logo_url    = platform_logo_url|default('/static/images/logo.webp') %}
{% set POWERED_BY_NAME      = POWERED_BY_NAME|default(platform_name) %}
{% set POWERED_BY_LOGO_URL  = POWERED_BY_LOGO_URL|default(CONNECTATX_LOGO_URL|default(platform_logo_url)) %}

{% set SHARE_TITLE = share_title|default(ORG_TEAM_NAME ~ ' ¬∑ ' ~ TAGLINE) %}
{% set SHARE_DESC  = meta_desc|default('A transparent, mobile-first fundraiser for ' ~ ORG_TEAM_NAME) %}
{% set SHARE_URL   = canonical_url|default(request.url if request is defined else '') %}
{% set SHARE_IMAGE = share_image_url|default(og_image_url|default('/static/img/fundchamps-share.jpg')) %}

{# ---------- Campaign math / branding ---------- #}
{% set brand_color      = (org.brand_color if org and org.brand_color else accent_hex|default('#f97316')) %}
{% set GOAL             = goal.target_dollars if goal and goal.target_dollars is not none else goal|default(10000) %}
{% set RAISED           = RAISED|default(raised|default(0)) %}
{% set remaining_pct    = 100 - pct_int if pct_int < 100 else 0 %}
{% set remaining_amt    = (GOAL - RAISED) if GOAL is not none and RAISED is not none and GOAL> RAISED else 0 %}
{% set DEADLINE_COPY    = DEADLINE_COPY|default('Now through the ' ~ SPORT_LABEL) %}
{% set DEADLINE_ISO     = DEADLINE_ISO|default('') %}
{% set DONOR_COUNT      = DONOR_COUNT|default(0) %}
{% set AVG_GIFT_DOLLARS = AVG_GIFT_DOLLARS|default(0) %}

{% set ANNOUNCEMENT_TEXT       = ANNOUNCEMENT_TEXT|default('All gifts this week help keep programs affordable for every family.') %}
{% set ANNOUNCEMENT_ID         = ANNOUNCEMENT_ID|default('campaign-announcement') %}
{% set ANNOUNCEMENT_LINK_URL   = ANNOUNCEMENT_LINK_URL|default('') %}
{% set ANNOUNCEMENT_LINK_LABEL = ANNOUNCEMENT_LINK_LABEL|default('Details') %}

{# Safe current year for footer #}
{% set current_year = current_year|default(now().year) %}

{# ---------- Donate URL fallback ---------- #}
{% if DONATE_URL is not defined or not DONATE_URL %}
  {% if org is defined and org and org.slug is defined %}
    {% set DONATE_URL = url_for('payments.start', org_slug=org.slug) %}
  {% else %}
    {% set DONATE_URL = '/donate' %}
  {% endif %}
{% endif %}
{% set donate_base = DONATE_URL|default('/donate') %}

{# ---------- Gamified tiers (no new data required) ---------- #}
{% if IS_GOAL_MET %}
  {% set GAME_TIER = 'Champions' %}
  {% set NEXT_TIER_AT = None %}
{% elif pct_int>= 75 %}
  {% set GAME_TIER = 'Gold' %}
  {% set NEXT_TIER_AT = 100 %}
{% elif pct_int>= 50 %}
  {% set GAME_TIER = 'Silver' %}
  {% set NEXT_TIER_AT = 75 %}
{% elif pct_int>= 25 %}
  {% set GAME_TIER = 'Bronze' %}
  {% set NEXT_TIER_AT = 50 %}
{% else %}
  {% set GAME_TIER = 'Kickoff' %}
  {% set NEXT_TIER_AT = 25 %}
{% endif %}

{# ---------- Reusable progress note copy ---------- #}
{% if IS_GOAL_MET %}
  {% set PROGRESS_NOTE = 'Goal met ‚Äî extra gifts now fuel scholarships, stretch goals, and future seasons.' %}
{% elif IS_NEAR_GOAL %}
  {% set PROGRESS_NOTE = 'Final push: just ' ~ remaining_pct ~ '% (about ' ~ money(remaining_amt) ~ ') left to close the gap.' %}
{% elif DONOR_COUNT == 0 %}
  {% set PROGRESS_NOTE = 'Just launched ‚Äî your gift can put the first points on the board.' %}
{% else %}
  {% set PROGRESS_NOTE = 'Every gift here helps ' ~ ORG_TEAM_NAME ~ ' say yes to more kids.' %}
{% endif %}

{# ---------- Final CTA subline copy ---------- #}
{% if IS_GOAL_MET %}
  {% set FINAL_CTA_LINE = 'Campaign funded ‚Äî every extra gift now fuels scholarships, stretch goals, and future seasons.' %}
{% elif IS_NEAR_GOAL %}
  {% set FINAL_CTA_LINE = 'In the red zone: just ' ~ remaining_pct ~ '% (about ' ~ money(remaining_amt) ~ ') left to go.' %}
{% elif DONOR_COUNT> 0 %}
  {% set FINAL_CTA_LINE = 'Join ' ~ DONOR_COUNT ~ ' supporter' ~ ('s' if DONOR_COUNT != 1 else '') ~ ' who‚Äôve already stepped up.' %}
{% else %}
  {% set FINAL_CTA_LINE = 'Be one of the first supporters to kick this off for ' ~ ORG_TEAM_NAME ~ '.' %}
{% endif %}

{% set TAX_FAQ_COPY = TAX_FAQ_COPY|default('Many contributions are processed through our nonprofit and booster partners. Receipts and details are provided after you give.') %}
{% set enh_announcement = ANNOUNCEMENT_ENH_TEXT|default('All gifts this week help keep programs affordable for every family.') %}
{% set check_payable_to = CHECK_PAYABLE_TO|default(ORG_TEAM_NAME) %}
{% set sponsor_email    = SPONSOR_CONTACT_EMAIL|default('sponsorships@example.org') %}
{% set sponsor_memo     = team_name|default(ORG_TEAM_NAME) %}
{% set footer_goal      = GOAL|default(10000) %}

{# Default impact tiles + leaderboard if none provided #}
{% set _default_tiles = [
  {"amount":25,"emoji":"üçé","short":"Covers post-practice snacks","label":"üçé $25 ¬∑ Covers team snacks after practice or rehearsal."},
  {"amount":50,"emoji":"üëü","short":"Helps with gear","label":"üëü $50 ¬∑ Helps cover shoes or gear for one player."},
  {"amount":100,"emoji":"üöå","short":"Helps with travel","label":"üöå $100 ¬∑ Helps cover travel for a game or event."},
  {"amount":250,"emoji":"üèüÔ∏è","short":"Funds space & facilities","label":"üèüÔ∏è $250 ¬∑ Helps cover gym time, field rental, or practice space."}
] %}
{% set impact_tiles   = IMPACT_TILES if IMPACT_TILES is defined and IMPACT_TILES else _default_tiles %}
{% set popular_amount = POPULAR_TILE_AMOUNT if POPULAR_TILE_AMOUNT is defined else impact_tiles[1].amount %}

{% set DEFAULT_LEADERBOARD = [
  {"name": "Local Business Ally", "amount": 1000, "tagline": "Proud community partner.", "avatar_url": "" },
  {"name": "The Walker Family", "amount": 750, "tagline": "Supporting every kid on the roster.", "avatar_url": "" },
  {"name": "Neighborhood Booster Club", "amount": 500, "tagline": "Fueling travel and tournaments.", "avatar_url": "" }
] %}
{% set HAS_REAL_LEADERBOARD = LEADERBOARD is defined and LEADERBOARD %}
{% set LEADERBOARD_DATA     = LEADERBOARD if HAS_REAL_LEADERBOARD else DEFAULT_LEADERBOARD %}

{% set DEFAULT_TEAM_GALLERY = [
  TEAM_PHOTO_URL|default('/static/images/connect-atx-team.jpg'),
  '/static/images/team-2.jpg',
  '/static/images/team-3.jpg',
  '/static/images/team-4.jpg',
  '/static/images/team-5.jpg',
  '/static/images/team-6.jpg'
] %}
{% set TEAM_GALLERY  = TEAM_GALLERY if TEAM_GALLERY is defined and TEAM_GALLERY else DEFAULT_TEAM_GALLERY %}
{% set GALLERY_COUNT = TEAM_GALLERY|length %}

<!doctype html>
<html
  lang="en"
  class="{{ html_classes }}"
  data-page="campaign"
  data-progress="{{ pct_int }}">
<head>
  <meta charset="utf-8" />
  <title>{{ ORG_TEAM_NAME }} ¬∑ {{ platform_name }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="description" content="{{ SHARE_DESC }}" />
  <meta name="robots" content="index,follow" />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="{{ brand_color|default('#f97316') }}" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#020617" media="(prefers-color-scheme: dark)">
  <meta name="application-name" content="{{ platform_name }}" />

  {% if canonical_url is defined and canonical_url %}
    <link rel="canonical" href="{{ canonical_url }}" />
  {% endif %}

  {# ---------- Open Graph & Twitter cards ---------- #}
  <meta property="og:type" content="website" />
  <meta property="og:title" content="{{ SHARE_TITLE }}" />
  <meta property="og:description" content="{{ SHARE_DESC }}" />
  {% if SHARE_URL %}<meta property="og:url" content="{{ SHARE_URL }}" />{% endif %}
  <meta property="og:image" content="{{ SHARE_IMAGE }}" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ SHARE_TITLE }}" />
  <meta name="twitter:description" content="{{ SHARE_DESC }}" />
  <meta name="twitter:image" content="{{ SHARE_IMAGE }}" />

  {# ---------- Icons ---------- #}
  <link rel="icon" href="{{ favicon_url|default('/static/img/favicon.png') }}" />
  <link rel="apple-touch-icon" href="{{ apple_touch_icon_url|default('/static/img/apple-touch-icon.png') }}" />

  {# ---------- Fonts ---------- #}
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..900&family=DM+Sans:wght@400..700&display=swap" rel="stylesheet" />

  {# ---------- Theme CSS (2025) ---------- #}
  <style {{ nonce_attr() }}>
    /* ===============================================
       FundChamps ¬∑ Diamond 2025
       - Unified tokens ‚Üí layout ‚Üí components ‚Üí motion
       - Clean rhythm, Nike/Apple-y type scale, tight CTAs
       =============================================== */

    /* TOKENS ------------------------------------------------------------- */
    :root {
      /* Brand */
      --accent: {{ brand_color|default('#f97316') }};
      --accent-2: #facc15; /* amber */
      --accent-3: #22c55e; /* green */

      /* Surface & ink */
      --bg: #f6f7fb;
      --bg-deep: #020617;
      --card: rgba(255,255,255,.98);
      --ink: #0b1220;
      --ink-2: #111827;
      --muted: #4b5563;

      /* Layout */
      --shell: 1120px;
      --gutter: clamp(1rem, 3vw, 1.8rem);
      --radius-xl: 28px; --radius-lg: 22px; --radius: 18px; --pill: 999px;
      --section-y: clamp(2.2rem, 3vw, 2.8rem);

      /* Shadows */
      --shadow-soft: 0 18px 45px rgba(15,23,42,.12);
      --shadow-strong: 0 28px 80px rgba(15,23,42,.24);
      --ease: cubic-bezier(.16,1,.3,1);

      /* Gradients */
      --grad-hero: radial-gradient(1100px 420px at -10% -10%, #fff 0, #f9fafb 50%, transparent 75%),
                   radial-gradient(900px 380px at 110% -10%, #ffedd5 0, #fee2b6 40%, transparent 70%),
                   linear-gradient(180deg,#f5f7fb 0%, #e8edf6 55%, #e2e8f0 100%);
      --grad-dark: radial-gradient(1400px 480px at 0% -10%, rgba(255,255,255,.06), transparent 60%),
                   linear-gradient(180deg, #020617 0%, #020617 60%, #020617 100%);

      /* Type */
      --display: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --body: "DM Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    html.near-goal, html.goal-met {
      --accent: #22c55e;
      --accent-2: #a3e635;
      --accent-3: #22c55e;
    }

    html { scroll-behavior: smooth; }
    body { margin:0; font-family: var(--body); color: var(--ink); background: var(--grad-hero); background-attachment: fixed; }

    .shell { max-width: var(--shell); margin: 0 auto; padding-inline: var(--gutter); }
    main> section { padding-block: var(--section-y); }

    /* A11y */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    a:focus-visible, button:focus-visible { outline: 2px solid var(--accent); outline-offset: 3px; }

    /* TYPE ---------------------------------------------------------------- */
    .eyebrow{ font-family:var(--display); font-size:.78rem; letter-spacing:.18em; text-transform:uppercase; color:#9ca3af; margin:0 0 .25rem; font-weight:700; }
    .title{ font-family:var(--display); font-weight:900; letter-spacing:-.03em; line-height:1.1; margin:0 0 .3rem; font-size:clamp(1.6rem,1.5rem + .9vw,2.2rem); color:#0b1220; }
    .sub{ font-size:1rem; line-height:1.85; color:#374151; margin:.25rem 0 .9rem; max-width:66ch; }
    .accent{ background: linear-gradient(110deg, var(--accent) 0%, var(--accent-2) 35%, var(--accent-3) 70%); -webkit-background-clip:text; background-clip:text; color:transparent; }

    /* CHIPS / BUTTONS ----------------------------------------------------- */
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.55rem; padding:.66rem 1.35rem; border-radius:var(--pill); border:1px solid #e5e7eb; background:#fff; color:#111827; font-weight:800; letter-spacing:.02em; font-family:var(--display); box-shadow:0 12px 30px rgba(15,23,42,.08); transition: transform .16s var(--ease), box-shadow .16s var(--ease), background .16s var(--ease), border-color .16s var(--ease); }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 16px 40px rgba(15,23,42,.12); }

    .btn-primary{ border-color:transparent; background: linear-gradient(135deg, var(--accent), var(--accent-2)); color:#111827; box-shadow:0 18px 40px rgba(248,113,29,.40); }
    .btn-primary:hover{ box-shadow:0 22px 52px rgba(234,88,12,.55); }

    .btn-ghost{ background:#fff; border-color:#e5e7eb; }

    .chip{ display:inline-flex; align-items:center; gap:.35rem; padding:.28rem .75rem; border-radius:var(--pill); border:1px solid rgba(148,163,184,.35); background:rgba(255,255,255,.96); color:#6b7280; font-size:.78rem; }

    /* HEADER --------------------------------------------------------------- */
    .site-header{ position:sticky; top:0; z-index:50; background: linear-gradient(180deg,#f9fafb 0%, #e7ebf3 55%, #dfe6f1 100%); border-bottom:1px solid rgba(148,163,184,.65); box-shadow:0 18px 50px rgba(15,23,42,.18); backdrop-filter: blur(18px) saturate(140%); }
    .header-inner{ max-width: var(--shell); margin:0 auto; padding:.8rem var(--gutter) .9rem; }
    .topbar{ display:grid; grid-template-columns:auto minmax(0,1fr) auto; gap:.9rem; align-items:center; }

    .brand{ display:inline-flex; align-items:center; gap:.7rem; }
    .brand-pill{ display:inline-flex; align-items:center; gap:.6rem; padding:.35rem 1rem; border-radius:var(--pill); border:1px solid rgba(148,163,184,.55); background: radial-gradient(circle at 10% 0, #fff 0, #f3f4f6 50%, #e5e7eb 100%); box-shadow:0 10px 28px rgba(15,23,42,.18); }
    .orb{ width:34px; height:34px; border-radius:50%; display:grid; place-items:center; background:radial-gradient(circle at 30% 0, #fff, #e5e7eb 55%, #d1d5db 90%); box-shadow:0 0 0 1px rgba(148,163,184,.9), 0 12px 30px rgba(15,23,42,.44); font-weight:900; letter-spacing:.16em; font-size:.78rem; color:#020617; }
    .wordmark{ font-family:var(--display); font-weight:800; letter-spacing:.22em; font-size:.8rem; }

    .header-title{ font-family:var(--display); font-weight:900; letter-spacing:-.01em; font-size:clamp(1.05rem,1.1rem + .3vw,1.55rem); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .header-title .warm{ background: linear-gradient(110deg, var(--accent) 0%, #f59e0b 40%); -webkit-background-clip:text; background-clip:text; color:transparent; }
    .header-title .fresh{ background: linear-gradient(110deg, #22c55e 0%, #a3e635 40%); -webkit-background-clip:text; background-clip:text; color:transparent; }

    .header-actions{ display:flex; align-items:center; justify-content:flex-end; gap:.5rem; flex-wrap:wrap; }

    .rail{ margin-top:.7rem; border-radius:999px; padding:.55rem .8rem; background: linear-gradient(180deg,#f9fafb 0%, #e5e7eb 60%, #d4d4dd 100%); border:1px solid rgba(148,163,184,.6); box-shadow:0 22px 60px rgba(15,23,42,.42), 0 1px 0 rgba(255,255,255,.95); display:flex; flex-direction:column; gap:.6rem; }
    .rail-main{ display:flex; flex-wrap:wrap; align-items:center; gap:.9rem; justify-content:space-between; }

    .progress{ min-width:0; flex:1 1 260px; }
    .progress-head{ display:flex; justify-content:space-between; align-items:center; font-size:.78rem; letter-spacing:.14em; text-transform:uppercase; color:#6b7280; margin-bottom:.25rem; }
    .bar{ height:10px; border-radius:999px; background:radial-gradient(circle at 0 0, #111827 0, #020617 75%); box-shadow: inset 0 0 0 1px rgba(15,23,42,.95); overflow:hidden; position:relative; }
    .bar> i{ display:block; height:100%; width:{{ pct_int }}%; background: linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent-3)); box-shadow: 0 0 18px rgba(250,204,21,.9); transition: width 1s var(--ease); }

    .announcement{ display:flex; align-items:center; justify-content:space-between; gap:.6rem; border-radius:999px; border:1px solid rgba(250,204,21,.45); background:linear-gradient(90deg,#fff7ed,#fffbeb); padding:.25rem .5rem; font-size:.8rem; }
    .announcement .pill{ border-radius:999px; padding:.14rem .6rem; background:linear-gradient(90deg,#f97316,#facc15); color:#111827; font-size:.7rem; letter-spacing:.16em; text-transform:uppercase; }

    /* HERO --------------------------------------------------------------- */
    #hero{ padding-block: calc(var(--section-y) * 1.1) var(--section-y); }
    .hero-grid{ display:grid; grid-template-columns: minmax(0,1.45fr) minmax(320px,1fr); gap:clamp(1.8rem,3vw,2.2rem); align-items:start; }
    .hero-title{ font-family:var(--display); font-weight:900; letter-spacing:-.015em; line-height:1.05; font-size: clamp(2rem, 2rem + 1.2vw, 2.9rem); margin:0 0 .5rem; }
    .hero-title .line{ display:block; color:#0b1220; }

    .meta-row{ display:flex; flex-wrap:wrap; gap:.45rem; margin:0 0 .6rem; }
    .meta-pill{ border-radius:var(--pill); border:1px solid #e5e7eb; padding:.18rem .7rem; font-size:.72rem; letter-spacing:.16em; text-transform:uppercase; color:#6b7280; background:#fff; }
    .meta-live{ border-color:rgba(34,197,94,.9); background:#dcfce7; color:#166534; }

    .hero-ctas{ display:flex; flex-wrap:wrap; gap:.65rem; margin:.35rem 0 .8rem; }

    .hero-stats{ display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:.75rem; margin-top:.85rem; }
    .stat{ border-radius:18px; background: radial-gradient(circle at top left,#fff,#f9fafb); border:1px solid rgba(148,163,184,.26); box-shadow:0 18px 45px rgba(15,23,42,.08); padding:.85rem 1rem .95rem; }
    .stat dt{ margin-bottom:.15rem; font-size:.8rem; color:#6b7280; }
    .stat .val{ font-weight:900; color:#0f172a; font-size:1.25rem; }
    .stat .cap{ margin-top:.2rem; font-size:.8rem; color:#6b7280; }

    .hero-card{ background: radial-gradient(circle at 0 0, #fff, #f5f5f7 55%, #e5e7eb 100%); border:1px solid rgba(148,163,184,.4); border-radius:22px; box-shadow:var(--shadow-soft); padding:1.1rem 1.25rem 1.3rem; }
    .hero-card .top{ display:flex; justify-content:space-between; gap:.75rem; font-size:.9rem; font-weight:600; color:#111827; }
    .meter{ height:10px; border-radius:999px; background:linear-gradient(90deg,#e5e7f0,#d1d5e2); box-shadow: inset 0 0 0 1px rgba(148,163,184,.5), 0 6px 18px rgba(15,23,42,.18); overflow:hidden; margin-top:.6rem; }
    .meter> i{ display:block; height:100%; width:{{ pct_int }}%; background: linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent-3)); box-shadow:0 0 16px rgba(250,204,21,.75); transition: width .8s var(--ease); }

    .qr{ display:flex; align-items:center; gap:.65rem; padding:.7rem .85rem; border-radius:18px; border:1px dashed rgba(148,163,184,.6); background:#f9fafb; font-size:.86rem; color:#4b5563; margin-top:.8rem; }
    .qr img{ width:96px; height:96px; border-radius:1rem; border:1px solid rgba(148,163,184,.7); background:#fff; box-shadow:0 16px 34px rgba(15,23,42,.55), 0 0 0 1px rgba(148,163,184,.7); }

    .hero-card .actions{ display:flex; flex-wrap:wrap; gap:.55rem; margin-top:.9rem; }

    /* IMPACT STRIP -------------------------------------------------------- */
    #impact .strip{ display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:1.1rem; border:1px solid rgba(148,163,184,.4); border-radius:26px; background: radial-gradient(circle at 0% 0%, #fff 0, #f8fafc 45%, #eef2f7 100%); box-shadow: 0 22px 60px rgba(15,23,42,.18), 0 1px 0 rgba(255,255,255,.9); padding:.7rem; }
    .strip .copy{ min-width:220px; }
    .tiles{ flex:1; display:flex; gap:.8rem; overflow:auto; padding:.1rem .15rem .25rem; }
    .tile{ min-width:160px; border-radius:20px; border:1px solid rgba(203,213,225,.85); background: radial-gradient(circle at top left, #fff 0, #f7f8fc 55%, #eef1f8 100%); padding:.8rem 1rem; display:flex; flex-direction:column; gap:.16rem; font-size:.9rem; color:#111827; transition: transform .16s var(--ease), box-shadow .16s var(--ease), border-color .16s var(--ease); }
    .tile[aria-pressed="true"], .tile:hover{ transform: translateY(-3px); border-color: var(--accent); box-shadow:0 20px 55px rgba(15,23,42,.2), 0 0 0 1px rgba(249,115,22,.2); }
    .tile .pop{ align-self:flex-start; padding:.14rem .7rem; border-radius:999px; border:1px solid rgba(250,204,21,.9); background: linear-gradient(90deg,#fef9c3,#ffedd5); font-size:.68rem; letter-spacing:.18em; text-transform:uppercase; color:#92400e; font-weight:700; }

    /* STORY / GALLERY ----------------------------------------------------- */
    .story-grid{ display:grid; grid-template-columns: minmax(0,1.05fr) minmax(0,1.15fr); gap:1.6rem; align-items:stretch; }
    .frame{ position:relative; width:100%; padding-top:60%; border-radius:22px; overflow:hidden; background:#020617; box-shadow:0 28px 80px rgba(15,23,42,.55), 0 0 0 1px rgba(15,23,42,.9); }
    .frame img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transform:scale(1.02); transition: opacity .36s var(--ease), transform .36s var(--ease); }
    .frame img.is-active{ opacity:1; transform:scale(1); }
    .story-card{ border-radius:26px; background: radial-gradient(circle at 0 0, #fff 0, #f7f8fc 50%, #eef1f8 100%); border:1px solid rgba(148,163,184,.4); box-shadow: 0 22px 60px rgba(15,23,42,.18); padding:1.3rem 1.4rem 1.4rem; }

    /* SCOREBOARD ---------------------------------------------------------- */
    .score{ border-radius:26px; background: radial-gradient(circle at 0 0, #fff 0, #f9fafb 55%, #eef2f7 100%); border:1px solid rgba(148,163,184,.4); box-shadow: 0 22px 60px rgba(15,23,42,.18); padding:1.25rem 1.4rem 1.45rem; }
    .score-grid{ display:grid; grid-template-columns:minmax(0,1.15fr) minmax(0,1fr); gap:1.5rem; }
    .score .bar{ background: linear-gradient(90deg,#e5e7eb,#e2e8f0); box-shadow: inset 0 1px 2px rgba(148,163,184,.55), 0 0 0 1px rgba(255,255,255,.9); }

    /* VIP WALL ------------------------------------------------------------ */
    .vip{ border-radius:26px; background: radial-gradient(circle at 0 0, #fff 0, #f8fafc 50%, #eef2f7 100%); border:1px solid rgba(148,163,184,.4); box-shadow: 0 22px 60px rgba(15,23,42,.18); padding:1.25rem 1.4rem 1.45rem; }
    .vip ul{ list-style:none; margin:.6rem 0 0; padding:0; }
    .vip li{ display:flex; align-items:center; justify-content:space-between; gap:.75rem; padding:.45rem 0; border-bottom:1px solid rgba(226,232,240,.9); }
    .vip li:last-child{ border-bottom:none; }
    .vip .name{ font-weight:800; color:#111827; }
    .vip .amt{ font-weight:800; color:#0f172a; }

    /* WAYS TO GIVE -------------------------------------------------------- */
    .ways{ border-radius:26px; background: radial-gradient(circle at 0 0, #fff 0, #f9fafb 55%, #eef2ff 100%); border:1px solid rgba(148,163,184,.45); box-shadow: 0 22px 60px rgba(15,23,42,.18); padding:1.25rem 1.4rem 1.45rem; }
    .tabs{ display:inline-flex; gap:.25rem; border:1px solid rgba(148,163,184,.35); border-radius:999px; padding:.3rem; background: linear-gradient(135deg,#f9fafb,#eef2ff); box-shadow: inset 0 1px 0 rgba(255,255,255,.9), 0 10px 30px rgba(15,23,42,.08); }
    .tab{ border:none; background:transparent; padding:.42rem 1.4rem; border-radius:999px; font-size:.8rem; letter-spacing:.14em; text-transform:uppercase; color:#6b7280; cursor:pointer; }
    .tab.is-active{ color:#111827; background:linear-gradient(135deg,#fefce8,#fbbf24,#fed7aa); box-shadow:0 14px 34px rgba(248,181,35,.4), 0 1px 0 rgba(255,255,255,.9); }

    /* FAQ + INLINE DONATE ------------------------------------------------- */
    .faq{ max-width:780px; margin:0 auto; border-radius:26px; background: radial-gradient(circle at 0 0, #fff 0, #f9fafb 55%, #eef2ff 100%); border:1px solid rgba(148,163,184,.45); box-shadow:0 26px 70px rgba(15,23,42,.18); padding:1.25rem 1.4rem 1.45rem; }
    .faq-grid{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:.7rem 1rem; margin-top:.9rem; }
    .faq-q{ margin:0 0 .14rem; color:#0f172a; font-weight:800; font-size:.98rem; }
    .faq-a{ margin:0; color:#4b5563; line-height:1.6; font-size:.94rem; }

    .freq{ display:inline-flex; align-items:center; gap:.35rem; padding:.24rem .3rem; border-radius:999px; background:linear-gradient(135deg,#f9fafb,#e5edff); border:1px solid rgba(148,163,184,.5); }
    .freq .lbl{ font-size:.74rem; letter-spacing:.16em; text-transform:uppercase; color:#9ca3af; padding-inline:.7rem .4rem; }
    .freq .pill{ border:none; background:transparent; border-radius:999px; padding:.32rem 1.1rem; font-size:.8rem; letter-spacing:.13em; text-transform:uppercase; color:#6b7280; cursor:pointer; }
    .freq .pill.is-active{ background:linear-gradient(135deg, var(--accent), var(--accent-2)); color:#111827; box-shadow:0 16px 36px rgba(248,181,35,.45), 0 0 0 1px rgba(255,255,255,.9); }

    .inline-form{ display:flex; flex-wrap:wrap; gap:.75rem; margin-top:1.2rem; }
    .inline-form input{ flex:1 1 150px; border-radius:999px; border:1px solid rgba(148,163,184,.5); background:rgba(255,255,255,.98); color:#0f172a; padding:.7rem 1.05rem; font-size:.92rem; box-shadow:0 16px 40px rgba(15,23,42,.10); }

    .payment{ margin-top:1.1rem; padding:.85rem 1rem 1rem; border-radius:20px; border:1px dashed rgba(148,163,184,.7); background: radial-gradient(circle at 0 0,#fff 0,#f9fafb 50%,#eef2ff 100%); }

    /* FINAL CTA ----------------------------------------------------------- */
    .final{ position:relative; background: radial-gradient(circle at 20% 0%, rgba(148,163,184,.22) 0, transparent 42%), radial-gradient(circle at 80% 0%, rgba(56,189,248,.18) 0, transparent 48%), #020617; color:#e5e7eb; text-align:center; padding:2.2rem 1.3rem; border-top:1px solid rgba(15,23,42,.85); }
    .final .inner{ max-width:720px; margin:0 auto; }
    .final .title{ color:#f9fafb; }
    .final .accent{ text-shadow:0 0 16px rgba(250,204,21,.7); }
    .final-rail{ display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; background: radial-gradient(circle at 10% 0%, #111827 0, #020617 70%); border-radius:9999px; border:1px solid rgba(148,163,184,.75); padding:.6rem .9rem; box-shadow:0 18px 50px rgba(0,0,0,.9), inset 0 1px 0 rgba(255,255,255,.06); }
    .final-bar{ position:relative; flex:1 1 180px; height:9px; border-radius:9999px; background: rgba(15,23,42,.92); overflow:hidden; }
    .final-bar> i{ position:absolute; inset:0; width:{{ pct_int }}%; background: linear-gradient(90deg,#facc15,#22c55e,#38bdf8); background-size:220% 100%; animation: flow 7s linear infinite; }
    @keyframes flow{ 0%{background-position:0 50%} 100%{background-position:100% 50%} }

    /* FOOTER -------------------------------------------------------------- */
    .site-footer{ background:#020617; color:#9ca3af; border-top:1px solid rgba(15,23,42,1); box-shadow:0 -10px 30px rgba(0,0,0,.85); padding: .95rem 0 1.1rem; }
    .footer-inner{ max-width:var(--shell); margin:0 auto; padding-inline:var(--gutter); display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:.65rem 1.2rem; }
    .footer-nav{ display:flex; flex-wrap:wrap; gap:.9rem; font-size:.78rem; letter-spacing:.14em; text-transform:uppercase; }
    .footer-nav a{ color:#e5e7eb; opacity:.9; }
    .footer-nav a:hover{ opacity:1; }

    /* BACK TO TOP --------------------------------------------------------- */
    .to-top{ position:fixed; right:1rem; bottom:1rem; width:40px; height:40px; border-radius:999px; border:1px solid #e5e7eb; background:#fff; color:#111827; display:grid; place-items:center; box-shadow:0 14px 30px rgba(15,23,42,.18); opacity:0; pointer-events:none; transform:translateY(8px); transition: opacity .2s var(--ease), transform .2s var(--ease); z-index:40; }
    .to-top.is-visible{ opacity:1; pointer-events:auto; transform:translateY(0); }

    /* RESPONSIVE ---------------------------------------------------------- */
    @media (max-width:1040px){ .hero-grid{ grid-template-columns: minmax(0,1fr); } .hero-card{ order:-1; } .score-grid{ grid-template-columns:minmax(0,1fr); } .faq-grid{ grid-template-columns:minmax(0,1fr); } }
    @media (max-width:768px){ .hero-stats{ grid-template-columns:minmax(0,1fr); } .final-rail{ flex-direction:column; align-items:stretch; } .final .btn{ width:100%; justify-content:center; } .footer-nav{ gap:.7rem; } }

    /* DARK THEME ---------------------------------------------------------- */
    html[data-theme="dark"] body{ background: var(--grad-dark); color:#e5e7eb; }
    html[data-theme="dark"] .title{ color:#f9fafb; }
    html[data-theme="dark"] .sub{ color:#cbd5f5; }
    html[data-theme="dark"] .hero-card, html[data-theme="dark"] .story-card, html[data-theme="dark"] .score, html[data-theme="dark"] .vip, html[data-theme="dark"] .ways, html[data-theme="dark"] .faq{ background: rgba(15,23,42,.98); border-color: rgba(51,65,85,.85); box-shadow: var(--shadow-soft); }

    @media (prefers-reduced-motion: reduce){ *,*::before,*::after{ animation-duration: .001ms !important; animation-iteration-count: 1 !important; transition-duration: .001ms !important; } html{ scroll-behavior:auto; } }
  </style>

  {# ---------- Boot theme early ---------- #}
  <script {{ nonce_attr() }}>
    try {
      const t = localStorage.getItem('fc-theme') || 'light';
      document.documentElement.setAttribute('data-theme', t);
    } catch { document.documentElement.setAttribute('data-theme','light'); }
  </script>

  {# ---------- Structured data ---------- #}
  <script {{ nonce_attr() }} type="application/ld+json">
  {{ {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": platform_name|default('FundChamps'),
    "url": SHARE_URL|default(request.url if request is defined else ''),
    "description": SHARE_DESC|default('A transparent, mobile-first fundraiser for youth programs')
  }|tojson }}
  </script>

  {# ---------- Frontend config ---------- #}
  <script {{ nonce_attr() }}>
    window.FUNDRAISER_CONFIG = {
      platformName: {{ platform_name|default('FundChamps')|tojson }},
      teamName: {{ team_name|tojson }},
      orgTeamName: {{ ORG_TEAM_NAME|tojson }},
      tagline: {{ TAGLINE|tojson }},
      sportLabel: {{ SPORT_LABEL|tojson }},
      brandColor: {{ brand_color|default('#f97316')|tojson }},
      goal: {{ GOAL|default(10000) }},
      raised: {{ RAISED|default(0) }},
      deadlineISO: {{ DEADLINE_ISO|default('')|tojson }},
      donorCount: {{ DONOR_COUNT|default(0) }},
      avgGiftDollars: {{ AVG_GIFT_DOLLARS|default(0) }},
      announcement: {
        text: {{ ANNOUNCEMENT_TEXT|tojson }},
        id: {{ ANNOUNCEMENT_ID|tojson }},
        linkUrl: {{ ANNOUNCEMENT_LINK_URL|default('')|tojson }},
        linkLabel: {{ ANNOUNCEMENT_LINK_LABEL|default('Details')|tojson }}
      },
      currentYear: {{ current_year }},
      donateUrl: {{ DONATE_URL|default('/donate')|tojson }},
      share: {
        title: {{ SHARE_TITLE|tojson }},
        desc: {{ SHARE_DESC|tojson }},
        url: {{ SHARE_URL|default('')|tojson }} || window.location.href,
        image: {{ SHARE_IMAGE|tojson }}
      },
      poweredBy: { name: {{ POWERED_BY_NAME|tojson }}, logoUrl: {{ POWERED_BY_LOGO_URL|tojson }} },
      taxFaqCopy: {{ TAX_FAQ_COPY|tojson }},
      checkPayableTo: {{ check_payable_to|tojson }},
      sponsorEmail: {{ sponsor_email|tojson }},
      sponsorMemo: {{ sponsor_memo|tojson }},
      footerGoal: {{ footer_goal|default(10000) }},
      impactTiles: {{ impact_tiles|tojson }},
      popularAmount: {{ popular_amount|default(impact_tiles[1].amount)|tojson }},
      leaderboard: {{ LEADERBOARD_DATA|tojson }},
      teamGallery: {{ TEAM_GALLERY|tojson }}
    };
  </script>
</head>
<body class="skin-2025">
  <header class="site-header" id="top">
    <div class="header-inner">
      <div class="topbar">
        <div class="brand">
          <span class="brand-pill">
            <span class="orb">FC</span>
            <span class="wordmark">{{ platform_name }}</span>
          </span>
        </div>
        <div class="header-title">
          <span class="warm">Fuel the season</span>
          <span class="sep" aria-hidden="true"> ¬∑ </span>
          <span class="fresh">Fund the future</span>
        </div>
        <div class="header-actions">
          <button class="btn btn-ghost" type="button" data-theme-toggle aria-label="Toggle theme">üåì</button>
          <a class="btn btn-primary cta-sheen" href="{{ donate_base }}" data-donate-link>Donate</a>
        </div>
      </div>

      <div class="rail">
        <div class="rail-main">
          <div class="chip">Tier: <strong style="margin-left:.35rem">{{ GAME_TIER }}</strong>{% if NEXT_TIER_AT %}<span class="chip" style="margin-left:.4rem">Next at {{ NEXT_TIER_AT }}%</span>{% endif %}</div>
          <div class="progress">
            <div class="progress-head">
              <span class="tnums">{{ pct_int }}% funded</span>
              <span class="tnums">{{ money(RAISED) }} / {{ money(GOAL) }}</span>
            </div>
            <div class="bar"><i style="width:{{ pct_int }}%"></i></div>
          </div>
          <div class="announcement" id="rail-announcement">
            <span class="pill">Update</span>
            <span class="text">{{ ANNOUNCEMENT_TEXT }}</span>
            {% if ANNOUNCEMENT_LINK_URL %}<a class="btn btn-ghost" href="{{ ANNOUNCEMENT_LINK_URL }}">{{ ANNOUNCEMENT_LINK_LABEL }}</a>{% endif %}
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section id="hero" class="shell">
      <div class="hero-grid">
        <div class="hero-copy">
          <div class="meta-row">
            <span class="meta-pill meta-live">Live</span>
            <span class="meta-pill">{{ ORG_TEAM_NAME }}</span>
            <span class="meta-pill">{{ TAGLINE }}</span>
          </div>

          <h1 class="hero-title">
            <span class="line accent">Back {{ ORG_TEAM_NAME }}</span>
            <span class="line">and power the {{ SPORT_LABEL }}</span>
          </h1>

          <p class="sub">Transparent, mobile‚Äëfirst fundraising for families and fans. Every dollar helps kids participate, travel, and compete ‚Äî with instant receipts and a clean, secure checkout.</p>

          <div class="hero-ctas">
            <a class="btn btn-primary cta-sheen" href="{{ donate_base }}" data-donate-link>Donate now</a>
            <a class="btn" href="#impact">Choose your impact</a>
            <button class="btn" type="button" data-share>Share</button>
          </div>

          <dl class="hero-stats">
            <div class="stat">
              <dt>Raised</dt>
              <dd class="val tnums">{{ money(RAISED) }}</dd>
              <div class="cap">{{ PROGRESS_NOTE }}</div>
            </div>
            <div class="stat">
              <dt>Goal</dt>
              <dd class="val tnums">{{ money(GOAL) }}</dd>
              <div class="cap">Tier: {{ GAME_TIER }}</div>
            </div>
            <div class="stat">
              <dt>Supporters</dt>
              <dd class="val tnums">{{ DONOR_COUNT }}</dd>
              <div class="cap">Avg. gift {{ money(AVG_GIFT_DOLLARS) }}</div>
            </div>
          </dl>
        </div>

        <aside class="hero-card" aria-label="Campaign checkout preview">
          <div class="top">
            <span class="tnums">{{ money(RAISED) }} raised</span>
            <span class="tnums">{{ pct_int }}%</span>
          </div>
          <div class="meter" aria-hidden="true"><i style="width:{{ pct_int }}%"></i></div>
          <div class="qr">
            <img src="/static/img/qr.png" alt="QR code to donate" loading="lazy" decoding="async">
            <div>
              <strong>Scan to donate</strong><br>
              Or tap the button to give securely.
            </div>
          </div>
          <div class="actions">
            <a class="btn btn-primary cta-sheen" href="{{ donate_base }}" data-donate-link>Open secure checkout</a>
            <button class="btn" type="button" id="open-inline">Give inline</button>
          </div>
        </aside>
      </div>
    </section>

    <!-- IMPACT STRIP -->
    <section id="impact" class="shell">
      <div class="strip">
        <div class="copy">
          <p class="eyebrow">Choose your impact</p>
          <h2 class="title">Small gifts add up <span class="accent">fast</span></h2>
          <p class="sub">Pick a tile, hit donate, you‚Äôre done in seconds. Your support directly offsets fees, gear, and travel.</p>
        </div>
        <div class="tiles" role="group" aria-label="Impact options">
          {% for t in impact_tiles %}
          <button class="tile{% if t.amount == popular_amount %} is-popular{% endif %}" type="button" data-amount="{{ t.amount }}" aria-pressed="false">
            {% if t.amount == popular_amount %}<span class="pop">Popular</span>{% endif %}
            <span class="emoji" aria-hidden="true" style="font-size:1.35rem">{{ t.emoji }}</span>
            <strong class="amt tnums">${{ t.amount }}</strong>
            <span class="lbl">{{ t.short|default(t.label) }}</span>
          </button>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- STORY / GALLERY -->
    <section id="story" class="shell">
      <div class="story-grid">
        <div class="frame" id="gallery">
          {% for src in TEAM_GALLERY %}
            <img src="{{ src }}" alt="Team highlight {{ loop.index }}" loading="lazy" decoding="async" class="{% if loop.first %}is-active{% endif %}">
          {% endfor %}
        </div>
        <div class="story-card">
          <p class="eyebrow">Why this matters</p>
          <h2 class="title">Keep programs <span class="accent">affordable</span> and inclusive</h2>
          <div class="sub">Gifts help cover scholarships, safe travel, and facilities so every kid can play ‚Äî not just the ones who can afford it.</div>
          <div class="highlight" style="margin-top:.9rem; padding:.75rem .9rem; border-radius:16px; border:1px dashed rgba(234,179,8,.8); background:linear-gradient(90deg,#fffbeb,#fef9c3); color:#92400e; font-size:.9rem;">Campaign runs {{ DEADLINE_COPY }}. Share this page to multiply impact.</div>
        </div>
      </div>
    </section>

    <!-- SCOREBOARD -->
    <section id="scoreboard" class="shell">
      <div class="score">
        <div class="score-grid">
          <div>
            <p class="eyebrow">Scoreboard</p>
            <h2 class="title">Progress snapshot</h2>
            <p class="sub">Live numbers update automatically as supporters give.</p>
            <div class="progress" style="margin-top:.6rem">
              <div class="bar"><i style="width:{{ pct_int }}%"></i></div>
            </div>
            <div class="chips" style="display:flex; flex-wrap:wrap; gap:.4rem; margin-top:.6rem;">
              <span class="chip tnums">{{ pct_int }}% funded</span>
              <span class="chip tnums">{{ money(RAISED) }} raised</span>
              <span class="chip">{{ DONOR_COUNT }} supporters</span>
            </div>
          </div>
          <div>
            <ul class="scoreboard-list" style="margin:.3rem 0 .8rem; padding-left:1.1rem; color:#374151; font-size:.94rem;">
              <li>Donations are tax‚Äëacknowledged. {{ TAX_FAQ_COPY }}</li>
              <li>Checks payable to <strong>{{ check_payable_to }}</strong> (memo: {{ sponsor_memo }}).</li>
              <li>Corporate match welcome ‚Äî email <a href="mailto:{{ sponsor_email }}">{{ sponsor_email }}</a>.</li>
            </ul>
            <p class="sub" style="color:#6b7280; font-size:.86rem;">Have a question? We reply same‚Äëday.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- VIP WALL -->
    <section id="supporters" class="shell">
      <div class="vip {% if not HAS_REAL_LEADERBOARD %}leaderboard-card--sample{% endif %}">
        <p class="eyebrow">VIP Wall</p>
        <h2 class="title">Top supporters</h2>
        <ul>
          {% for row in LEADERBOARD_DATA %}
            <li>
              <div class="main">
                <div class="name">{{ row.name }}</div>
                <div class="tag" style="font-size:.86rem; color:#6b7280;">{{ row.tagline }}</div>
              </div>
              <div class="amt tnums">{{ money(row.amount) }}</div>
            </li>
          {% endfor %}
        </ul>
      </div>
    </section>

    <!-- WAYS TO GIVE -->
    <section id="ways-to-give" class="shell">
      <div class="ways">
        <p class="eyebrow">Ways to support</p>
        <h2 class="title">Give how you like</h2>
        <div class="tabs" role="tablist" aria-label="Ways to give">
          <button class="tab is-active" role="tab" aria-selected="true" data-tab="card">Card</button>
          <button class="tab" role="tab" aria-selected="false" data-tab="paypal">PayPal</button>
          <button class="tab" role="tab" aria-selected="false" data-tab="check">Check</button>
        </div>
        <div class="panel" id="panel-card" role="tabpanel" style="margin-top:.8rem;">
          <ul class="ways-list" style="list-style:none; padding:0; margin:.2rem 0 .2rem; font-size:.95rem; color:#374151;">
            <li>Visa, MasterCard, AmEx, and Apple/Google Pay supported via our secure processor.</li>
            <li>One‚Äëtime or monthly gifts. Cancel anytime from the receipt.</li>
          </ul>
          <div class="payment" id="payment-card">
            <!-- Stripe Payment Element mounts here -->
            <div id="payment-element"></div>
            <button class="btn btn-primary" id="pay-now" style="margin-top:.7rem; width:100%">Pay securely</button>
            <p class="sub" style="color:#9ca3af; font-size:.83rem; margin:.35rem 0 0">üîí PCI‚Äëcompliant. We never store card numbers.</p>
          </div>
        </div>
        <div class="panel" id="panel-paypal" role="tabpanel" hidden style="margin-top:.8rem;">
          <div id="paypal-button-container"></div>
          <p class="sub" style="color:#6b7280; font-size:.9rem;">Prefer PayPal? No problem ‚Äî use the button above.</p>
        </div>
        <div class="panel" id="panel-check" role="tabpanel" hidden style="margin-top:.8rem;">
          <p class="sub">Mail a check to <strong>{{ check_payable_to }}</strong> (memo: {{ sponsor_memo }}). For business invoices or ACH, contact <a href="mailto:{{ sponsor_email }}">{{ sponsor_email }}</a>.</p>
        </div>
      </div>
    </section>

    <!-- FAQ + INLINE DONATE -->
    <section id="faq" class="shell">
      <div class="faq">
        <div class="faq-head" style="display:flex; justify-content:space-between; gap:1.1rem; align-items:flex-start; flex-wrap:wrap;">
          <div>
            <p class="eyebrow">Questions</p>
            <h2 class="title">Quick answers</h2>
          </div>
          <span class="chip">üîí Secure checkout</span>
        </div>
        <div class="faq-grid">
          <div>
            <p class="faq-q">Is my gift tax‚Äëdeductible?</p>
            <p class="faq-a">{{ TAX_FAQ_COPY }}</p>
          </div>
          <div>
            <p class="faq-q">Can I donate monthly?</p>
            <p class="faq-a">Yes. Pick monthly below; you‚Äôll get a portal link in the receipt to manage it.</p>
          </div>
          <div>
            <p class="faq-q">Do you accept corporate matching?</p>
            <p class="faq-a">Absolutely. Email <a href="mailto:{{ sponsor_email }}">{{ sponsor_email }}</a> and we‚Äôll handle the paperwork.</p>
          </div>
          <div>
            <p class="faq-q">Can I leave a note?</p>
            <p class="faq-a">Yes ‚Äî there‚Äôs a message box at checkout. Great for dedication notes and shout‚Äëouts.</p>
          </div>
        </div>
        <div class="inline" style="margin-top:1.1rem; border-top:1px solid #e5e7eb; padding-top:1.2rem;">
          <div class="freq" role="group" aria-label="Frequency">
            <span class="lbl">Frequency</span>
            <button class="pill is-active" data-freq="once" type="button">Once</button>
            <button class="pill" data-freq="monthly" type="button">Monthly</button>
          </div>
          <form class="inline-form" id="donation-form" onsubmit="return false;">
            <input type="number" inputmode="decimal" min="1" step="1" placeholder="Amount (USD)" id="gift-amount" value="{{ popular_amount }}">
            <input type="text" placeholder="Your name (optional)" id="gift-name">
            <button class="btn btn-primary" id="inline-donate">Donate {{ money(popular_amount) }}</button>
          </form>
          <div id="payment-inline" class="payment" hidden>
            <div id="payment-element-inline"></div>
            <button class="btn btn-primary" id="pay-inline" style="margin-top:.7rem; width:100%">Pay now</button>
          </div>
          <p id="donation-error" class="sub" style="display:none; color:#7f1d1d; background:#fef2f2; border:1px solid #fecaca; border-radius:14px; padding:.55rem .75rem; font-size:.86rem; margin-top:.8rem;">There was an issue starting checkout. Please try again.</p>
        </div>
      </div>
    </section>

    <!-- FINAL CTA -->
    <section id="final-cta" class="final">
      <div class="inner">
        <h2 class="title">
          <span class="accent">Back the program.</span>
          <span class="title">Fund the future.</span>
        </h2>
        <p class="sub">{{ FINAL_CTA_LINE }}</p>
        <div class="final-rail" style="margin-top:1rem;">
          <span class="chip">{{ ORG_TEAM_NAME }}</span>
          <div class="final-bar" aria-hidden="true"><i style="width:{{ pct_int }}%"></i></div>
          <a class="btn btn-primary" href="{{ donate_base }}" data-donate-link>Donate</a>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer" id="page-footer">
    <div class="footer-inner">
      <p class="meta" style="margin:0; font-size:.86rem; display:inline-flex; gap:.45rem; align-items:center; max-width:32rem;">&copy; {{ current_year }} {{ platform_name }} ¬∑ Secure payments ¬∑ Transparent goals</p>
      <nav class="footer-nav" aria-label="Footer">
        <a href="#impact">Impact</a>
        <a href="#supporters">VIP Wall</a>
        <a href="#ways-to-give">Ways</a>
        <a href="#faq">FAQ</a>
        <a href="/privacy">Privacy</a>
      </nav>
    </div>
  </footer>

  <button class="to-top" id="to-top" aria-label="Back to top">‚Üë</button>

  <!-- Minimal JS: theme, share, tabs, gallery, reveal, inline checkout hooks -->
  <script {{ nonce_attr() }}>
    (function(){
      const doc = document.documentElement;
      // Animate header bar after load
      window.addEventListener('load', () => doc.classList.add('fc-loaded'));

      // Theme toggle
      const themeBtn = document.querySelector('[data-theme-toggle]');
      themeBtn?.addEventListener('click', () => {
        const next = (doc.getAttribute('data-theme') === 'dark') ? 'light' : 'dark';
        if (document.startViewTransition) {
          document.startViewTransition(() => doc.setAttribute('data-theme', next));
        } else {
          doc.setAttribute('data-theme', next);
        }
        try { localStorage.setItem('fc-theme', next); } catch {}
      });

      // Share API fallback
      const shareBtn = document.querySelector('[data-share]');
      shareBtn?.addEventListener('click', async () => {
        const cfg = window.FUNDRAISER_CONFIG?.share || {};
        const url = cfg.url || window.location.href;
        if (navigator.share) {
          try { await navigator.share({ title: cfg.title, text: cfg.desc, url }); } catch {}
        } else {
          try { await navigator.clipboard.writeText(url); alert('Link copied!'); } catch { prompt('Copy link:', url); }
        }
      });

      // Impact tiles ‚Üí set amount + jump to donate
      const tiles = document.querySelectorAll('.tile');
      const amountInput = document.getElementById('gift-amount');
      tiles.forEach(btn => btn.addEventListener('click', () => {
        tiles.forEach(b => b.setAttribute('aria-pressed','false'));
        btn.setAttribute('aria-pressed','true');
        const amt = parseInt(btn.dataset.amount || '0', 10);
        if (amountInput) amountInput.value = amt;
        document.querySelector('[data-donate-link]')?.focus();
      }));

      // Tabs (Ways to give)
      const tabs = document.querySelectorAll('.tab');
      const panels = { card: '#panel-card', paypal: '#panel-paypal', check: '#panel-check' };
      tabs.forEach(t => t.addEventListener('click', () => {
        tabs.forEach(x => { x.classList.remove('is-active'); x.setAttribute('aria-selected','false'); });
        t.classList.add('is-active'); t.setAttribute('aria-selected','true');
        Object.values(panels).forEach(sel => { const el = document.querySelector(sel); if(el){ el.hidden = true; }});
        document.querySelector(panels[t.dataset.tab])?.removeAttribute('hidden');
      }));

      // Gallery autoplay (pause on hover)
      const gallery = document.getElementById('gallery');
      if (gallery) {
        const imgs = Array.from(gallery.querySelectorAll('img'));
        let idx = imgs.findIndex(i => i.classList.contains('is-active')) || 0;
        const tick = () => { imgs.forEach(i => i.classList.remove('is-active')); idx = (idx + 1) % imgs.length; imgs[idx].classList.add('is-active'); };
        let iv = setInterval(tick, 4500);
        gallery.addEventListener('mouseenter', () => clearInterval(iv));
        gallery.addEventListener('mouseleave', () => iv = setInterval(tick, 4500));
      }

      // Back to top
      const toTop = document.getElementById('to-top');
      const onScroll = () => { if (window.scrollY> 600) toTop.classList.add('is-visible'); else toTop.classList.remove('is-visible'); };
      window.addEventListener('scroll', onScroll, { passive:true }); onScroll();
      toTop?.addEventListener('click', () => window.scrollTo({ top:0, behavior:'smooth' }));

      // Frequency pills
      const freqPills = document.querySelectorAll('.freq .pill');
      freqPills.forEach(p => p.addEventListener('click', () => {
        freqPills.forEach(x => x.classList.remove('is-active'));
        p.classList.add('is-active');
      }));

      // Inline checkout toggles (wire to your backend/Stripe)
      document.getElementById('open-inline')?.addEventListener('click', () => {
        document.getElementById('payment-inline')?.removeAttribute('hidden');
        document.getElementById('payment-element-inline')?.scrollIntoView({ behavior:'smooth', block:'center' });
      });

      // Donate buttons ‚Üí track via data attr (add analytics if needed)
      document.querySelectorAll('[data-donate-link]')
        .forEach(a => a.addEventListener('click', () => { window.dispatchEvent(new CustomEvent('fc:donate-click')); }));
    })();
  </script>
</body>
</html>

