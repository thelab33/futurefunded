/* ============================================================================
   FutureFunded — Flagship FULL STYLESHEET (v20.0.0 “Index Parity • Hyperglass • AA+”)
   File: app/static/css/ff.css
   DROP-IN REPLACEMENT • SAME MARKUP • WHITE-LABEL READY • CSP-SAFE

   Contracts:
   - Token-complete: no missing --ff-* vars
   - Hook-safe: styles are resilient to missing optional sections
   - No color-mix(), no @property reliance
   - Reduced motion respected, safe-area supported, strong focus-visible rings
============================================================================ */

@layer ff.tokens, ff.base, ff.layout, ff.surfaces, ff.components, ff.pages, ff.utilities;

/* ============================================================================
   TOKENS
============================================================================ */
@layer ff.tokens {
  .ff-root,
  [data-ff-brand]{
    /* Fonts */
    --ff-font: ui-sans-serif, system-ui, -apple-system, "SF Pro Text", "SF Pro Display",
      Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    --ff-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
      "Courier New", monospace;

    /* Type */
    --ff-line: 1.48;
    --ff-headline: -0.025em;

    /* Radii */
    --ff-r-sm: 12px;
    --ff-r-md: 14px;
    --ff-r-lg: 18px;
    --ff-r-xl: 24px;
    --ff-r-2xl: 28px;
    --ff-r-pill: 999px;

    /* Layout */
    --ff-max: 1120px;
    --ff-gutter: clamp(16px, 4vw, 28px);
    --ff-tap: 44px;

    /* Spacing */
    --ff-s-0: 0px;
    --ff-s-1: 6px;
    --ff-s-2: 10px;
    --ff-s-3: 14px;
    --ff-s-4: 18px;
    --ff-s-5: 24px;
    --ff-s-6: 32px;
    --ff-s-7: 40px;
    --ff-s-8: 56px;
    --ff-s-9: 72px;

    /* Motion */
    --ff-ease: cubic-bezier(.2,.8,.2,1);
    --ff-ease2: cubic-bezier(.16,1,.3,1);
    --ff-fast: 140ms;
    --ff-med: 180ms;
    --ff-slow: 260ms;

    /* Brand */
    --ff-accent: #f97316;
    --ff-accent2: #38bdf8;
    --ff-good: #22c55e;
    --ff-warn: #fbbf24;
    --ff-bad:  #fb7185;

    --ff-brand: var(--ff-accent);
    --ff-brand-contrast: #0b0f17;
    --ff-brand-grad: linear-gradient(90deg, #f97316 0%, #38bdf8 100%);

    /* Accent alpha helpers (no color-mix) */
    --ff-accent-08: rgba(249,115,22,0.08);
    --ff-accent-14: rgba(249,115,22,0.14);
    --ff-accent-16: rgba(249,115,22,0.16);
    --ff-accent-22: rgba(249,115,22,0.22);
    --ff-accent-28: rgba(249,115,22,0.28);
    --ff-accent-32: rgba(249,115,22,0.32);
    --ff-accent-40: rgba(249,115,22,0.40);

    --ff-accent2-08: rgba(56,189,248,0.08);
    --ff-accent2-14: rgba(56,189,248,0.14);
    --ff-accent2-22: rgba(56,189,248,0.22);
    --ff-accent2-28: rgba(56,189,248,0.28);
    --ff-accent2-36: rgba(56,189,248,0.36);

    /* Theme (LIGHT default) */
    --ff-bg: #F6F7FB;
    --ff-text: rgba(15,18,28,0.92);
    --ff-muted: rgba(15,18,28,0.64);
    --ff-dim: rgba(15,18,28,0.52);

    --ff-card: rgba(255,255,255,0.92);
    --ff-surface: rgba(255,255,255,0.74);
    --ff-surface-2: rgba(255,255,255,0.96);
    --ff-surface-3: rgba(255,255,255,0.985);

    --ff-card-82: rgba(255,255,255,0.82);
    --ff-card-84: rgba(255,255,255,0.84);
    --ff-card-88: rgba(255,255,255,0.88);

    --ff-border: rgba(15,18,28,0.10);
    --ff-border-strong: rgba(15,18,28,0.16);

    --ff-text-06: rgba(15,18,28,0.06);
    --ff-text-08: rgba(15,18,28,0.08);
    --ff-text-10: rgba(15,18,28,0.10);
    --ff-text-12: rgba(15,18,28,0.12);
    --ff-text-14: rgba(15,18,28,0.14);

    /* Surface ladder tints (light) */
    --ff-s2-72: rgba(15,18,28,0.035);
    --ff-s2-70: rgba(15,18,28,0.040);
    --ff-s2-68: rgba(15,18,28,0.045);
    --ff-s2-65: rgba(15,18,28,0.055);
    --ff-s2-64: rgba(15,18,28,0.060);
    --ff-s2-62: rgba(15,18,28,0.065);
    --ff-s2-60: rgba(15,18,28,0.070);
    --ff-s2-55: rgba(15,18,28,0.085);

    --ff-s3-72: rgba(15,18,28,0.040);
    --ff-s3-70: rgba(15,18,28,0.050);

    /* Shadows */
    --ff-shadow-xs: 0 6px 16px rgba(15,18,28,0.06);
    --ff-shadow-sm: 0 10px 26px rgba(15,18,28,0.09);
    --ff-shadow-md: 0 14px 36px rgba(15,18,28,0.12);
    --ff-shadow-lg: 0 22px 60px rgba(15,18,28,0.15);
    --ff-shadow-xl: 0 36px 100px rgba(15,18,28,0.18);

    /* Focus ring */
    --ff-focus: 0 0 0 3px rgba(56,189,248,.22), 0 0 0 1px rgba(56,189,248,.52);

    /* Glass */
    --ff-blur: saturate(140%) blur(14px);
    --ff-inner-hi: rgba(255,255,255,0.64);

    /* Border gradients */
    --ff-ring-grad: linear-gradient(135deg, rgba(15,18,28,0.14), rgba(15,18,28,0.0));
    --ff-ring-grad-strong: linear-gradient(135deg, rgba(15,18,28,0.22), rgba(15,18,28,0.0));

    /* Page background gradient */
    --ff-grad:
      radial-gradient(900px 600px at 12% 10%, rgba(56,189,248,0.10), transparent 58%),
      radial-gradient(1000px 700px at 88% 0%, rgba(249,115,22,0.08), transparent 60%),
      radial-gradient(1000px 900px at 50% 110%, rgba(167,139,250,0.06), transparent 62%),
      linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));

    /* Section parity helpers */
    --ff-section-pad-y: clamp(32px, 5.6vw, 72px);
    --ff-section-frame: rgba(255,255,255,0.10);
    --ff-section-glowA: rgba(56,189,248,0.18);
    --ff-section-glowB: rgba(249,115,22,0.14);

    /* Skeleton palette */
    --ff-skel-a: rgba(15,18,28,0.06);
    --ff-skel-b: rgba(15,18,28,0.10);
    --ff-skel-hi: rgba(255,255,255,0.55);
    --ff-skel-border: rgba(15,18,28,0.10);

    /* Sticky / scroll padding */
    --ff-nav-h: 140px;
    --ff-tabs-h: 96px;

    /* Safe areas */
    --ff-safe-top: env(safe-area-inset-top, 0px);
    --ff-safe-right: env(safe-area-inset-right, 0px);
    --ff-safe-bottom: env(safe-area-inset-bottom, 0px);
    --ff-safe-left: env(safe-area-inset-left, 0px);

    /* Z-index scale (deterministic) */
    --ff-z-base: 0;
    --ff-z-chrome: 220;
    --ff-z-tabs: 350;
    --ff-z-backtotop: 400;
    --ff-z-drawer: 500;
    --ff-z-sheet: 550;
    --ff-z-modal: 600;
    --ff-z-toasts: 9999;
  }

  @supports not (backdrop-filter: blur(1px)) {
    .ff-root,
    [data-ff-brand] { --ff-blur: none; }
  }

  .ff-root[data-theme="dark"],
  html[data-theme="dark"].ff-root,
  body.ff-theme-dark,
  [data-ff-brand][data-theme="dark"]{
    color-scheme: dark;

    --ff-bg: #070A12;
    --ff-text: rgba(235,240,255,0.92);
    --ff-muted: rgba(235,240,255,0.70);
    --ff-dim: rgba(235,240,255,0.56);

    --ff-card: rgba(12,14,22,0.76);
    --ff-surface: rgba(12,14,22,0.50);
    --ff-surface-2: rgba(18,22,34,0.84);
    --ff-surface-3: rgba(18,22,34,0.92);

    --ff-card-82: rgba(12,14,22,0.82);
    --ff-card-84: rgba(12,14,22,0.84);
    --ff-card-88: rgba(12,14,22,0.88);

    --ff-border: rgba(255,255,255,0.12);
    --ff-border-strong: rgba(255,255,255,0.18);
    --ff-brand-contrast: #070A12;

    --ff-text-06: rgba(235,240,255,0.06);
    --ff-text-08: rgba(235,240,255,0.08);
    --ff-text-10: rgba(235,240,255,0.10);
    --ff-text-12: rgba(235,240,255,0.12);
    --ff-text-14: rgba(235,240,255,0.14);

    /* Surface ladder tints (dark) */
    --ff-s2-72: rgba(255,255,255,0.072);
    --ff-s2-70: rgba(255,255,255,0.070);
    --ff-s2-68: rgba(255,255,255,0.068);
    --ff-s2-65: rgba(255,255,255,0.065);
    --ff-s2-64: rgba(255,255,255,0.064);
    --ff-s2-62: rgba(255,255,255,0.062);
    --ff-s2-60: rgba(255,255,255,0.060);
    --ff-s2-55: rgba(255,255,255,0.055);

    --ff-s3-72: rgba(255,255,255,0.080);
    --ff-s3-70: rgba(255,255,255,0.070);

    --ff-inner-hi: rgba(255,255,255,0.10);
    --ff-ring-grad: linear-gradient(135deg, rgba(255,255,255,0.24), rgba(255,255,255,0.0));
    --ff-ring-grad-strong: linear-gradient(135deg, rgba(255,255,255,0.34), rgba(255,255,255,0.0));

    --ff-section-frame: rgba(255,255,255,0.08);
    --ff-section-glowA: rgba(56,189,248,0.22);
    --ff-section-glowB: rgba(249,115,22,0.18);

    --ff-skel-a: rgba(18,22,34,0.68);
    --ff-skel-b: rgba(18,22,34,0.48);
    --ff-skel-hi: rgba(255,255,255,0.10);
    --ff-skel-border: rgba(255,255,255,0.12);
  }

  @media (prefers-reduced-motion: reduce) {
    .ff-root { --ff-fast: 1ms; --ff-med: 1ms; --ff-slow: 1ms; }
  }
}

/* ============================================================================
   BASE
============================================================================ */
@layer ff.base {
  *, *::before, *::after { box-sizing: border-box; }
  html, body { height: 100%; }

  html{
    color-scheme: light dark;
    scroll-behavior: smooth;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    scroll-padding-top: var(--ff-nav-h);
    scroll-padding-bottom: var(--ff-tabs-h);
    width: 100%;
    max-width: 100%;
  }
  @media (prefers-reduced-motion: reduce){ html { scroll-behavior: auto; } }

  body{
    margin: 0;
    min-height: 100%;
    font-family: var(--ff-font);
    color: var(--ff-text);
    background: var(--ff-bg);
    line-height: var(--ff-line);
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    width: 100%;
    max-width: 100%;
    overflow-x: hidden;
  }
  @supports (overflow: clip) { body { overflow-x: clip; } }

  :where(input, textarea, select, button){ font: inherit; color: inherit; }
  :where(button){ cursor: pointer; }
  :where(textarea){ resize: vertical; min-height: 96px; }
  :where(input, textarea, select){ accent-color: var(--ff-accent2); }
  :where(::placeholder){ color: var(--ff-dim); opacity: 1; }

  ::selection{ background: var(--ff-accent2-22); }
  .ff-root[data-theme="light"] ::selection{ background: var(--ff-accent-14); }

  img, svg, video, canvas, iframe { max-width: 100%; display:block; }
  a { color: inherit; text-decoration: none; }
  * { -webkit-tap-highlight-color: transparent; }

  :focus { outline: none; }
  :focus-visible{
    box-shadow: var(--ff-focus);
    border-radius: 14px;
    outline-offset: 2px;
  }

  [hidden]{ display:none; }

  .ff-sr{
    position:absolute !important;
    width:1px; height:1px;
    margin:-1px; overflow:hidden;
    clip: rect(0,0,0,0);
    white-space:nowrap; border:0;
  }

  /* Skip links */
  .ff-skiplinks{
    position:absolute;
    inset: 0 auto auto 0;
    z-index: var(--ff-z-toasts);
    padding: 0;
    margin: 0;
  }
  .ff-skip{
    position:absolute;
    left: 12px;
    top: 10px;
    transform: translateY(-140%);
    padding: 10px 12px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-card), rgba(255,255,255,0.86)) padding-box,
      var(--ff-ring-grad-strong) border-box;
    box-shadow: var(--ff-shadow-md);
    color: var(--ff-text);
    transition: transform var(--ff-med) var(--ff-ease);
    will-change: transform;
  }
  .ff-skip:focus-visible{ transform: translateY(0); }

  /* Autofill parity */
  input:-webkit-autofill,
  textarea:-webkit-autofill,
  select:-webkit-autofill{
    -webkit-text-fill-color: var(--ff-text);
    transition: background-color 9999s ease-out 0s;
    box-shadow: 0 0 0px 1000px rgba(255,255,255,0.02) inset;
  }
  .ff-root[data-theme="light"] input:-webkit-autofill,
  .ff-root[data-theme="light"] textarea:-webkit-autofill,
  .ff-root[data-theme="light"] select:-webkit-autofill{
    box-shadow: 0 0 0px 1000px rgba(15,18,28,0.02) inset;
  }

  @media (forced-colors: active){
    :focus-visible{ outline: 2px solid Highlight; box-shadow: none; }
    .ff-skip{ border: 1px solid CanvasText; }
  }
}

/* ============================================================================
   LAYOUT
============================================================================ */
@layer ff.layout {
  .ff-container{
    width: min(100%, var(--ff-max));
    margin-inline:auto;
    padding-inline: var(--ff-gutter);
    max-width: 100%;
  }

  .ff-section{
    position: relative;
    padding: var(--ff-section-pad-y) 0;
    scroll-margin-top: var(--ff-nav-h);
    isolation: isolate;
  }

  .ff-row{
    display:flex;
    align-items:center;
    gap: 12px;
    min-width:0;
  }
  .ff-wrap{ flex-wrap: wrap; }
  .ff-ais{ align-items: stretch; }
  .ff-grow{ flex: 1 1 auto; min-width:0; }
  .ff-minw-0{ min-width:0; }
  .ff-row--between{ justify-content: space-between; }

  .ff-stack{ display:grid; gap: 12px; min-width:0; }
  .ff-grid{ display:grid; gap: 14px; min-width:0; }
  .ff-grid--2{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  @media (max-width: 820px){ .ff-grid--2{ grid-template-columns: 1fr; } }

  .ff-shell{
    position: relative;
    min-height: 100%;
  }

  .ff-shell::before{
    content:"";
    position: fixed;
    inset: 0;
    pointer-events:none;
    z-index: -2;
    background: var(--ff-grad);
    opacity: .95;
  }

  .ff-shellBg{
    position: fixed;
    inset: 0;
    z-index: -3;
    pointer-events: none;
    background: transparent;
  }

  /* Responsive chrome helpers used by your markup */
  .ff-topbar__desktop-only{ display:none; }
  .ff-topbar__mobile-only{ display:flex; }
  @media (min-width: 920px){
    .ff-topbar__desktop-only{ display:block; }
    .ff-topbar__mobile-only{ display:none; }
  }

  /* Prevent row/grid children overflow */
  .ff-row > *, .ff-grid > *, .ff-stack > * { min-width: 0; }
}

/* ============================================================================
   SURFACES
============================================================================ */
@layer ff.surfaces {
  .ff-surface,
  .ff-card,
  .ff-topbar__capsule,
  .ff-announce__inner,
  .ff-footerTray,
  .ff-drawer__panel,
  .ff-modal__panel,
  .ff-sheet__panel,
  .ff-checkoutShell,
  .ff-hero__capsule{
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-inner-hi), rgba(255,255,255,0)) padding-box,
      var(--ff-ring-grad) border-box;
  }

  .ff-surface{
    border-radius: var(--ff-r-2xl);
    box-shadow: var(--ff-shadow-xs);
    backdrop-filter: var(--ff-blur);
    -webkit-backdrop-filter: var(--ff-blur);
  }

  .ff-card{
    border-radius: var(--ff-r-2xl);
    background:
      linear-gradient(180deg, var(--ff-card), rgba(255,255,255,0.86)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-sm);
  }
  .ff-card--lift{ box-shadow: var(--ff-shadow-md); }
  .ff-card--premium{
    background:
      linear-gradient(180deg, var(--ff-card), rgba(255,255,255,0.86)) padding-box,
      var(--ff-ring-grad-strong) border-box;
    box-shadow: var(--ff-shadow-md);
  }

  .ff-pad{ padding: clamp(16px, 2.3vw, 26px); }
  .ff-glass{
    backdrop-filter: var(--ff-blur);
    -webkit-backdrop-filter: var(--ff-blur);
  }

  .ff-divider{
    height:1px;
    border:0;
    background: rgba(255,255,255,0.06);
  }
  .ff-root[data-theme="light"] .ff-divider{ background: rgba(15,18,28,0.10); }
}

/* ============================================================================
   COMPONENTS
============================================================================ */
@layer ff.components {
  /* Typography */
  .ff-display{ font-size: clamp(34px, 4.2vw, 54px); line-height:1.06; letter-spacing: var(--ff-headline); margin:0; text-wrap: balance; }
  .ff-h2{ font-size: clamp(20px, 2.2vw, 28px); line-height:1.16; letter-spacing:-0.02em; margin:0; text-wrap: balance; }
  .ff-h3{ font-size: clamp(16px, 1.7vw, 20px); line-height:1.22; letter-spacing:-0.015em; margin:0; }
  .ff-lead{ font-size: clamp(15px, 1.35vw, 18px); color: var(--ff-muted); margin: 8px 0 0; max-width: 70ch; }
  .ff-kicker{ font-size:12px; letter-spacing:.12em; text-transform:uppercase; color: var(--ff-dim); margin:0; }
  .ff-label{ font-size:14px; color: var(--ff-text); margin:0; }
  .ff-help{ font-size:13px; color: var(--ff-muted); }
  .ff-muted{ color: var(--ff-muted); }
  .ff-num{ font-variant-numeric: tabular-nums; }
  .ff-big{ font-size: clamp(22px, 2.2vw, 30px); }
  .ff-m-0{ margin:0; }

  .ff-link{
    color: inherit;
    text-decoration: underline;
    text-decoration-thickness:1px;
    text-underline-offset:3px;
    text-decoration-color: rgba(255,255,255,0.28);
  }
  .ff-root[data-theme="light"] .ff-link{ text-decoration-color: rgba(15,18,28,0.28); }
  .ff-link:hover{ text-decoration-color: rgba(56,189,248,0.60); }
  .ff-nounderline{ text-decoration:none; }
  .ff-nowrap{ white-space: nowrap; }

  /* Buttons */
  .ff-btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap: 10px;
    min-height: var(--ff-tap);
    padding: 10px 14px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-72), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-xs);
    transition: transform var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), opacity var(--ff-fast) var(--ff-ease);
    user-select:none;
    -webkit-user-select:none;
    will-change: transform;
    line-height:1.1;
    text-align:center;
  }
  .ff-btn:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-sm); filter:saturate(1.02); }
  .ff-btn:active{ transform: translateY(0); box-shadow: var(--ff-shadow-xs); filter:saturate(1); }
  .ff-btn:disabled,
  .ff-btn[aria-disabled="true"]{ opacity:.55; cursor:not-allowed; pointer-events:none; transform:none; }

  .ff-btn--primary{
    border: 1px solid rgba(255,255,255,0.18);
    background:
      linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.00)) padding-box,
      var(--ff-brand-grad) border-box;
    color: #fff;
    box-shadow: 0 14px 38px var(--ff-accent-22);
  }
  .ff-btn--primary:hover{ box-shadow: 0 18px 54px var(--ff-accent-28); }

  .ff-btn--secondary{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.16), rgba(56,189,248,0.10)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.42), rgba(255,255,255,0.00)) border-box;
  }

  .ff-btn--ghost{ background: transparent; border: 1px solid var(--ff-border); box-shadow:none; }
  .ff-btn--ghost:hover{ background: var(--ff-text-08); box-shadow: var(--ff-shadow-xs); }

  .ff-btn--sm{ min-height: 36px; padding: 8px 12px; font-size: 13px; }
  .ff-btn--lg{ min-height: 48px; padding: 12px 16px; font-size: 15px; }
  .ff-btn--pill{ border-radius: var(--ff-r-pill); }
  .ff-w-100{ width:100% !important; }

  .ff-btn__label{ display:block; font-weight: 750; }
  .ff-btn__sub{ display:block; font-size: 12px; }

  /* Icon buttons */
  .ff-iconbtn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-width: var(--ff-tap);
    min-height: var(--ff-tap);
    padding: 0 12px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-xs);
    transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
    line-height:1;
  }
  .ff-iconbtn:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-sm); filter:saturate(1.02); }
  .ff-iconbtn:active{ transform: translateY(0); box-shadow: var(--ff-shadow-xs); }
  .ff-themeToggle[aria-pressed="true"]{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.14), rgba(56,189,248,0.10)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.52), rgba(255,255,255,0.00)) border-box;
  }

  /* Pills + chips */
  .ff-pill{
    display:inline-flex;
    align-items:center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    font-size: 12px;
    color: var(--ff-muted);
    white-space: nowrap;
  }
  .ff-pill--soft{ background: var(--ff-text-08); border: 1px solid var(--ff-border); }
  .ff-pill--ghost{ background: transparent; border: 1px solid var(--ff-border); }
  .ff-pill--accent{
    background:
      linear-gradient(180deg, rgba(249,115,22,0.18), rgba(249,115,22,0.10)) padding-box,
      linear-gradient(135deg, rgba(249,115,22,0.46), rgba(255,255,255,0.00)) border-box;
    color: var(--ff-accent);
  }
  .ff-pill--live{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.18), rgba(56,189,248,0.10)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.48), rgba(255,255,255,0.00)) border-box;
  }
  .ff-pill--verified{
    background:
      linear-gradient(180deg, rgba(34,197,94,0.16), rgba(34,197,94,0.10)) padding-box,
      linear-gradient(135deg, rgba(34,197,94,0.44), rgba(255,255,255,0.00)) border-box;
  }
  .ff-dot{ width:8px; height:8px; border-radius:50%; background: var(--ff-accent2); box-shadow: 0 0 0 4px rgba(56,189,248,0.22); }

  .ff-chip{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-height: 38px;
    padding: 8px 12px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    font-size: 13px;
    transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
    line-height:1.1;
  }
  .ff-chip:hover{ transform: translateY(-1px); filter:saturate(1.02); box-shadow: var(--ff-shadow-xs); }
  .ff-chip.is-selected,
  .ff-chip[aria-pressed="true"]{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.16), rgba(56,189,248,0.10)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.52), rgba(255,255,255,0.00)) border-box;
    color: var(--ff-text);
  }
  .ff-chip--pill{ border-radius: var(--ff-r-pill); }
  .ff-chip--impact{
    justify-content: space-between;
    width: 100%;
    padding: 10px 12px;
    gap: 10px;
  }
  .ff-chip__amt{ font-weight: 800; font-variant-numeric: tabular-nums; }
  .ff-chip__meta{ color: var(--ff-muted); font-size: 12px; }

  /* Inputs */
  .ff-input{
    width:100%;
    min-height: var(--ff-tap);
    padding: 10px 12px;
    border-radius: var(--ff-r-lg);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s3-72), var(--ff-s3-70)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: inset 0 0 0 1px rgba(0,0,0,0.06);
    transition: box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
  }
  .ff-input:focus-visible{ box-shadow: var(--ff-focus), inset 0 0 0 1px rgba(56,189,248,0.40); filter:saturate(1.02); }
  .ff-input--amount{ text-align:right; font-variant-numeric: tabular-nums; letter-spacing:-0.01em; }

  /* Alerts + callouts */
  .ff-alert, .ff-callout{
    border-radius: var(--ff-r-xl);
    border: 1px solid transparent;
    padding: 12px 14px;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-xs);
    color: var(--ff-text);
  }
  .ff-alert--info{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.14), rgba(56,189,248,0.08)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.46), rgba(255,255,255,0.00)) border-box;
  }
  .ff-alert--error{
    background:
      linear-gradient(180deg, rgba(251,113,133,0.16), rgba(251,113,133,0.10)) padding-box,
      linear-gradient(135deg, rgba(251,113,133,0.44), rgba(255,255,255,0.00)) border-box;
  }
  .ff-callout--flagship{
    background:
      linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.00)) padding-box,
      var(--ff-ring-grad) border-box;
  }
  .ff-root[data-theme="light"] .ff-callout--flagship{
    background:
      linear-gradient(180deg, rgba(15,18,28,0.03), rgba(255,255,255,0.00)) padding-box,
      var(--ff-ring-grad) border-box;
  }

  /* Progress meter (supports <progress> markup) */
  .ff-meter{
    position: relative;
    height: 14px;
    border-radius: var(--ff-r-pill);
    background: var(--ff-text-10);
    overflow: hidden;
    border: 1px solid var(--ff-border);
  }
  .ff-meter__progress{
    width: 100%;
    height: 100%;
    display:block;
    border: 0;
    background: transparent;
    -webkit-appearance: none;
    appearance: none;
  }
  .ff-meter__progress::-webkit-progress-bar{
    background: var(--ff-text-10);
    border-radius: var(--ff-r-pill);
  }
  .ff-meter__progress::-webkit-progress-value{
    background: var(--ff-brand-grad);
    border-radius: var(--ff-r-pill);
    box-shadow: 0 12px 28px var(--ff-accent-22);
  }
  .ff-meter__progress::-moz-progress-bar{
    background: var(--ff-brand-grad);
    border-radius: var(--ff-r-pill);
    box-shadow: 0 12px 28px var(--ff-accent-22);
  }

  /* Skeletons */
  @keyframes ff_shimmer { 0% { transform: translateX(-45%); opacity:.55; } 100% { transform: translateX(45%); opacity:.55; } }

  .ff-skeleton{
    position: relative;
    overflow:hidden;
    border-radius: 16px;
    background: linear-gradient(180deg, var(--ff-skel-a), var(--ff-skel-b));
    border: 1px solid var(--ff-skel-border);
    min-height: 18px;
  }
  .ff-skeleton::after{
    content:"";
    position:absolute;
    inset:-40%;
    background: linear-gradient(90deg, transparent, var(--ff-skel-hi), transparent);
    transform: translateX(-45%);
    animation: ff_shimmer 1.15s ease-in-out infinite;
    pointer-events:none;
  }
  .ff-skeleton--payment{ min-height: 56px; border-radius: var(--ff-r-lg); }
  .ff-skeleton--video{ min-height: 220px; border-radius: var(--ff-r-xl); }

  @media (prefers-reduced-motion: reduce){
    .ff-skeleton::after{ animation:none; opacity:.35; }
    .ff-btn, .ff-chip, .ff-iconbtn{ transition:none; }
    .ff-btn:hover, .ff-chip:hover, .ff-iconbtn:hover{ transform:none; }
  }

  /* Disclosures (details/summary) */
  .ff-disclosure{
    border-radius: var(--ff-r-2xl);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-xs);
    overflow:hidden;
  }
  .ff-disclosure__sum{
    list-style:none;
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap: 12px;
    padding: 12px 14px;
    cursor:pointer;
    user-select:none;
    -webkit-user-select:none;
  }
  .ff-disclosure__sum::-webkit-details-marker{ display:none; }
  .ff-disclosure__panel{
    padding: 12px 14px 14px;
    border-top: 1px solid var(--ff-border);
    background: var(--ff-text-08);
  }
  .ff-root[data-theme="light"] .ff-disclosure__panel{ background: rgba(255,255,255,0.55); }

  /* QR */
  .ff-qr{
    border-radius: 14px;
    border: 1px solid var(--ff-border);
    background: #fff;
    padding: 8px;
    box-shadow: var(--ff-shadow-xs);
    display:grid;
    place-items:center;
    gap: 10px;
  }
  .ff-qr__img{ width: 140px; height: 140px; object-fit: contain; }

  /* Brand block (drawer/footer) */
  .ff-brand{ display:flex; align-items:center; gap: 12px; min-width:0; }
  .ff-brand__title{ font-weight: 800; letter-spacing:-0.02em; }
  .ff-brand__sub{ color: var(--ff-muted); font-size: 13px; }

  /* Small separator */
  .ff-sep{ opacity:.7; }
  .ff-sep--dot{ font-size: 14px; }

  /* Announcement */
  .ff-announce__inner{ border-radius: var(--ff-r-2xl); }
  .ff-announce__row{ display:flex; align-items:center; justify-content: space-between; gap: 12px; flex-wrap: wrap; padding: 12px 14px; }
  .ff-announce__badge{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding: 4px 10px;
    border-radius: var(--ff-r-pill);
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
    font-size: 12px;
    letter-spacing:.08em;
    text-transform: uppercase;
  }
  .ff-announce__text{ margin:0; color: var(--ff-text); }

  /* Toast host */
  .ff-toasts{
    position: fixed;
    right: 14px;
    bottom: calc(14px + var(--ff-safe-bottom));
    z-index: var(--ff-z-toasts);
    width: min(420px, calc(100% - 28px));
    display:grid;
    gap: 10px;
    pointer-events:none;
  }
  .ff-toast{
    pointer-events:auto;
    border-radius: var(--ff-r-xl);
    padding: 10px 12px;
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-card), rgba(255,255,255,0.86)) padding-box,
      var(--ff-ring-grad-strong) border-box;
    box-shadow: var(--ff-shadow-md);
    backdrop-filter: var(--ff-blur);
    -webkit-backdrop-filter: var(--ff-blur);
  }

  /* Live sr line */
  #ffLive.ff-sr{ position:absolute !important; }

  /* Reduced motion parity */
  @media (prefers-reduced-motion: reduce){
    .ff-disclosure{ scroll-behavior: auto; }
  }
}

/* ============================================================================
   PAGES
============================================================================ */
@layer ff.pages {
  /* Section parity glow */
  [data-ff-section]{ position: relative; }
  [data-ff-section]::before{
    content:"";
    position:absolute; left:0; right:0; top:0;
    height:1px;
    background: linear-gradient(90deg, transparent, var(--ff-section-frame), transparent);
    opacity:.75;
    pointer-events:none;
  }
  [data-ff-section]::after{
    content:"";
    position:absolute;
    inset: -24px 0 auto 0;
    height: 220px;
    background:
      radial-gradient(520px 240px at 18% 20%, var(--ff-section-glowA), transparent 60%),
      radial-gradient(520px 240px at 82% 10%, var(--ff-section-glowB), transparent 62%);
    opacity:.30;
    pointer-events:none;
    z-index:0;
  }
  [data-ff-section] > .ff-container{ position: relative; z-index:1; }

  /* Chrome (header) */
  .ff-chrome{
    position: sticky;
    top: 0;
    z-index: var(--ff-z-chrome);
    padding-top: 10px;
    backdrop-filter: var(--ff-blur);
    -webkit-backdrop-filter: var(--ff-blur);
  }
  .ff-chrome__stack{ display:grid; gap:10px; }
  .ff-topbar__capsule{ padding: 10px 12px; border-radius: var(--ff-r-2xl); }
  .ff-topbar__capsuleInner{ display:grid; gap: 10px; }
  .ff-topbar__mainRow{ gap: 14px; }

  .ff-platformBrand{
    display:inline-flex;
    align-items:center;
    gap: 10px;
    padding: 6px 8px;
    border-radius: var(--ff-r-pill);
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
  }
  .ff-platformBrand__disc{
    width: 26px;
    height: 26px;
    border-radius: 50%;
    display:grid;
    place-items:center;
    background:
      linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.0));
  }
  .ff-platformBrand__logo{ width: 22px; height: 22px; }

  .ff-topbarBrand{
    display:inline-flex;
    align-items:center;
    gap: 10px;
    padding: 6px 10px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-70), var(--ff-s2-60)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-xs);
    min-width:0;
  }
  .ff-topbarBrand img{ border-radius: 10px; }
  .ff-topbarBrand__text{ font-weight: 800; letter-spacing:-0.02em; white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
  .ff-topbarBrand__pill{ margin-left: 2px; }

  /* Primary nav pills */
  .ff-navPill{
    display:flex;
    align-items:center;
    gap: 10px;
    padding: 6px 8px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-64), var(--ff-s2-55)) padding-box,
      var(--ff-ring-grad) border-box;
  }
  .ff-nav__link{
    display:inline-flex;
    align-items:center;
    padding: 8px 10px;
    border-radius: var(--ff-r-pill);
    color: var(--ff-muted);
    font-size: 13px;
    border: 1px solid transparent;
    transition: background var(--ff-med) var(--ff-ease), color var(--ff-med) var(--ff-ease), transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease);
    will-change: transform;
  }
  .ff-nav__link:hover{ background: var(--ff-text-08); color: var(--ff-text); transform: translateY(-1px); box-shadow: var(--ff-shadow-xs); }

  /* Scroll indicator */
  .ff-scroll{ height: 2px; border-radius: 999px; background: var(--ff-text-08); overflow:hidden; }
  .ff-scroll > span{ display:block; height:100%; width: 36%; background: var(--ff-brand-grad); opacity:.55; }

  /* Section headers */
  .ff-sectionhead{
    display:flex;
    align-items:flex-end;
    justify-content: space-between;
    gap: 14px;
    flex-wrap: wrap;
  }
  .ff-sectionhead--compact{ align-items:flex-start; }
  .ff-sectionhead__text{ min-width: 0; }
  .ff-sectionhead__actions{ display:flex; align-items:center; gap: 10px; flex-wrap: wrap; }

  /* Hero */
  .ff-section--hero{ padding-top: clamp(22px, 3.8vw, 40px); }
  .ff-hero{ padding: clamp(26px, 4vw, 46px) 0; }

  .ff-hero__shell{
    position: relative;
    border-radius: var(--ff-r-2xl);
    overflow:hidden;
  }
  @supports (overflow: clip){ .ff-hero__shell{ overflow: clip; } }

  .ff-hero__bg{
    position:absolute;
    inset:-22px -10px -22px -10px;
    pointer-events:none;
    z-index:0;
  }
  .ff-hero__orb{ position:absolute; filter: blur(34px); opacity:.55; border-radius:999px; }
  .ff-hero__orb--a{ width:520px; height:520px; left:-100px; top:-70px; background: rgba(56,189,248,0.32); }
  .ff-hero__orb--b{ width:560px; height:560px; right:-120px; top:-110px; background: rgba(249,115,22,0.26); }
  .ff-hero__gridlines{
    position:absolute;
    inset: 0;
    background-image:
      linear-gradient(to right, rgba(255,255,255,0.05) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255,255,255,0.05) 1px, transparent 1px);
    background-size: 64px 64px;
    opacity: .25;
    mask-image: radial-gradient(circle at 50% 30%, rgba(0,0,0,0.9), transparent 70%);
  }
  .ff-root[data-theme="light"] .ff-hero__gridlines{
    background-image:
      linear-gradient(to right, rgba(15,18,28,0.06) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(15,18,28,0.06) 1px, transparent 1px);
  }

  .ff-hero__grid{
    position: relative;
    z-index:1;
    display:grid;
    grid-template-columns: 1.1fr 0.9fr;
    gap: 18px;
    align-items:start;
  }
  @media (max-width: 920px){ .ff-hero__grid{ grid-template-columns: 1fr; } }

  .ff-hero__capsuleInner{ padding: clamp(16px, 2.3vw, 26px); }
  .ff-heroContext{
    list-style:none;
    padding:0;
    margin:0 0 12px;
    display:flex;
    align-items:center;
    gap: 10px;
    flex-wrap: wrap;
  }

  .ff-heroHeader{ margin-top: 4px; }
  .ff-heroTitle{ margin:0; }
  .ff-heroLine{ display:block; }
  .ff-heroAccent{ color: var(--ff-text); }
  .ff-heroName{ color: var(--ff-accent); }
  .ff-heroLead{ margin-top: 10px; }

  .ff-hero__kpis{
    margin: 14px 0 0;
    padding:0;
    list-style:none;
    display:grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 10px;
  }
  @media (max-width: 620px){ .ff-hero__kpis{ grid-template-columns: 1fr; } }
  .ff-kpi{ min-width:0; }
  .ff-kpi__label{ margin:0; }
  .ff-kpi__value{ margin:0; }

  .ff-heroCtas{ margin-top: 14px; display:grid; gap: 10px; }
  .ff-heroCtas--flagship .ff-btn--primary{ width: 100%; justify-content: space-between; text-align:left; padding: 12px 16px; }

  .ff-donorTicker{
    border-radius: var(--ff-r-2xl);
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
    padding: 12px;
    overflow:hidden;
  }
  .ff-ticker__track{ display:grid; gap: 10px; }
  .ff-donorTicker p{ margin:0; }

  .ff-heroMedia{ margin-top: 16px; }
  .ff-rail__track{
    margin-top: 12px;
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: 12px;
  }
  @media (max-width: 920px){ .ff-rail__track{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (max-width: 520px){ .ff-rail__track{ grid-template-columns: 1fr; } }

  .ff-railcard{
    border-radius: var(--ff-r-2xl);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-card-84), rgba(255,255,255,0.72)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-sm);
    overflow:hidden;
    display:grid;
    gap: 10px;
    transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
  }
  @supports (overflow: clip){ .ff-railcard{ overflow: clip; } }
  .ff-railcard:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-md); filter:saturate(1.02); }

  .ff-railcard__img{ width:100%; aspect-ratio: 16 / 10; object-fit: cover; }
  .ff-railcard__meta{ padding: 0 12px 12px; display:grid; gap: 6px; }
  .ff-railcard__chip{
    display:inline-flex;
    width: fit-content;
    padding: 4px 10px;
    border-radius: var(--ff-r-pill);
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
    font-size: 12px;
  }
  .ff-railcard__name{ font-weight: 800; letter-spacing:-0.02em; }

  .ff-heroPanel .ff-card{ position: sticky; top: calc(var(--ff-nav-h) + 18px); }
  @media (max-width: 920px){ .ff-heroPanel .ff-card{ position: relative; top:auto; } }

  /* Impact */
  .ff-impactPick__chips{ margin:0; padding:0; list-style:none; display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap: 10px; }
  @media (max-width: 920px){ .ff-impactPick__chips{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (max-width: 520px){ .ff-impactPick__chips{ grid-template-columns: 1fr; } }

  .ff-impactTierGrid{
    margin:0;
    padding:0;
    list-style:none;
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: 12px;
  }
  @media (max-width: 920px){ .ff-impactTierGrid{ grid-template-columns: 1fr; } }
  .ff-impactTier{ min-width:0; }
  .ff-impactTier__head{ display:grid; gap: 8px; }
  .ff-impactTier__footer{ margin-top: 10px; }

  /* Story */
  .ff-storyGrid{
    display:grid;
    grid-template-columns: 1.05fr 0.95fr;
    gap: 14px;
    align-items:start;
  }
  @media (max-width: 920px){ .ff-storyGrid{ grid-template-columns: 1fr; } }

  .ff-storyPoster{
    display:block;
    position: relative;
    border-radius: var(--ff-r-2xl);
    overflow:hidden;
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
    box-shadow: var(--ff-shadow-sm);
  }
  @supports (overflow: clip){ .ff-storyPoster{ overflow: clip; } }
  .ff-storyPoster__img{ width:100%; height:auto; display:block; aspect-ratio: 16 / 9; object-fit: cover; }
  .ff-storyPoster__overlay{
    position:absolute;
    inset: 0;
    display:grid;
    place-items:center;
    gap: 8px;
    background: radial-gradient(600px 300px at 50% 30%, rgba(0,0,0,0.35), rgba(0,0,0,0.60));
    color:#fff;
  }
  .ff-storyPoster__play{
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display:grid;
    place-items:center;
    border: 1px solid rgba(255,255,255,0.28);
    background: rgba(255,255,255,0.10);
    box-shadow: 0 18px 60px rgba(0,0,0,0.28);
  }
  .ff-storyPoster__label{ font-weight: 800; letter-spacing:-0.02em; }

  .ff-storyList{ margin: 0; padding-left: 18px; color: var(--ff-muted); display:grid; gap: 6px; }
  .ff-quote{
    border-left: 3px solid rgba(56,189,248,0.55);
    padding-left: 12px;
    border-radius: 10px;
    background: var(--ff-text-08);
    padding-block: 10px;
    padding-right: 12px;
  }

  /* Teams */
  .ff-teamGrid{
    display:grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 12px;
    padding: 0;
    margin: 0;
    list-style:none;
  }
  .ff-teamGrid--compact{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  @media (max-width: 920px){ .ff-teamGrid, .ff-teamGrid--compact{ grid-template-columns: 1fr; } }

  .ff-teamCard{ min-width:0; overflow:hidden; transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease); }
  @supports (overflow: clip){ .ff-teamCard{ overflow: clip; } }
  .ff-teamCard:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-md); filter:saturate(1.02); }
  .ff-teamCard__inner{ display:grid; gap: 10px; min-width:0; }
  .ff-teamCard__media{ border-radius: var(--ff-r-xl); border: 1px solid var(--ff-border); background: var(--ff-text-08); overflow:hidden; }
  @supports (overflow: clip){ .ff-teamCard__media{ overflow: clip; } }
  .ff-teamCard__img{ width:100%; aspect-ratio: 3 / 2; object-fit: cover; }
  .ff-teamCard.is-selected{ box-shadow: var(--ff-shadow-lg); }

  /* Sponsors */
  .ff-sponsorCard{ padding: clamp(14px, 2vw, 22px); }
  .ff-sponsorWall{
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: 12px;
    padding: 12px;
    border-radius: var(--ff-r-2xl);
    border: 1px solid var(--ff-border);
    background: var(--ff-text-08);
  }
  @media (max-width: 820px){ .ff-sponsorWall{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (max-width: 520px){ .ff-sponsorWall{ grid-template-columns: 1fr; } }
  .ff-sponsorWall__item{ height: 92px; border-radius: var(--ff-r-xl); }

  .ff-sponsorGrid{
    list-style:none;
    padding: 0;
    margin: 14px 0 0;
    display:grid;
    grid-template-columns: repeat(2, minmax(0,1fr));
    gap: 12px;
  }
  @media (max-width: 820px){ .ff-sponsorGrid{ grid-template-columns: 1fr; } }

  .ff-tierCard{
    border-radius: var(--ff-r-2xl);
    padding: 14px;
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-card-84), rgba(255,255,255,0.72)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-sm);
    min-width:0;
    height:100%;
    display:grid;
    gap: 12px;
  }
  .ff-tierCard--recommended{
    background:
      linear-gradient(180deg, rgba(56,189,248,0.14), rgba(56,189,248,0.08)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.56), rgba(255,255,255,0.00)) border-box;
    box-shadow: 0 22px 70px rgba(56,189,248,0.12);
  }
  .ff-tierHead{ display:grid; gap: 6px; }
  .ff-tierTitleRow{ display:flex; align-items:center; justify-content: space-between; gap: 10px; min-width:0; }
  .ff-tierName{ margin:0; font-size:16px; letter-spacing:-0.01em; font-weight:750; color: var(--ff-text); min-width:0; }
  .ff-tierPrice{ display:flex; align-items: baseline; gap: 6px; margin:0; }
  .ff-tierAmt{ font-variant-numeric: tabular-nums; font-weight: 800; letter-spacing:-0.02em; }
  .ff-tierSuffix{ opacity: .75; }
  .ff-tierPill{ display:inline-flex; padding: 4px 8px; border-radius: var(--ff-r-pill); border: 1px solid var(--ff-border); background: var(--ff-text-08); font-size: 12px; white-space: nowrap; }
  .ff-tierList{ margin:0; padding-left: 18px; color: var(--ff-muted); display:grid; gap: 6px; }
  .ff-tierFoot{ margin-top:auto; }

  /* Footer */
  .ff-footer{ padding: clamp(34px, 6vw, 72px) 0; position: relative; }
  .ff-footerTray{ padding: clamp(14px, 2vw, 20px); border-radius: var(--ff-r-2xl); }
  .ff-footerTrust{ opacity: .9; }
  .ff-footer__grid{
    margin-top: 14px;
    display:grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 14px;
    align-items:start;
  }
  @media (max-width: 920px){ .ff-footer__grid{ grid-template-columns: 1fr; } }
  .ff-footer__linkgrid{ list-style:none; padding:0; margin:0; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 10px; }
  .ff-footer__link{ color: var(--ff-muted); text-decoration: underline; text-underline-offset:3px; text-decoration-color: rgba(255,255,255,0.22); }
  .ff-root[data-theme="light"] .ff-footer__link{ text-decoration-color: rgba(15,18,28,0.22); }
  .ff-footer__link:hover{ color: var(--ff-text); text-decoration-color: rgba(56,189,248,0.60); }

  /* Back to top */
  .ff-backtotop{
    position: fixed;
    right: calc(14px + var(--ff-safe-right));
    bottom: calc(88px + var(--ff-safe-bottom));
    z-index: var(--ff-z-backtotop);
    display:inline-flex;
    align-items:center;
    gap: 10px;
    padding: 10px 12px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s3-70), var(--ff-s3-72)) padding-box,
      var(--ff-ring-grad) border-box;
    box-shadow: var(--ff-shadow-md);
    transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
  }
  .ff-backtotop:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-lg); filter:saturate(1.02); }
  .ff-backtotop__text{ font-size: 13px; color: var(--ff-text); }

  /* Tabs (mobile bottom nav) */
  .ff-tabs{
    position: fixed;
    left:0; right:0;
    bottom:0;
    z-index: var(--ff-z-tabs);
    padding: 10px var(--ff-gutter);
    padding-bottom: calc(10px + var(--ff-safe-bottom));
    background: rgba(7,10,18,0.72);
    border-top: 1px solid var(--ff-border);
    backdrop-filter: var(--ff-blur);
    -webkit-backdrop-filter: var(--ff-blur);
  }
  .ff-root[data-theme="light"] .ff-tabs{ background: rgba(246,247,251,0.88); }
  @media (min-width: 920px){ .ff-tabs{ display:none; } }

  .ff-tabs__scroller{ overflow:auto; scrollbar-width:none; -webkit-overflow-scrolling: touch; }
  .ff-tabs__scroller::-webkit-scrollbar{ display:none; }
  .ff-tabs__list{ display:flex; gap: 10px; list-style:none; padding:0; margin:0; }
  .ff-tab{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-height: 42px;
    padding: 10px 12px;
    border-radius: var(--ff-r-pill);
    border: 1px solid transparent;
    background:
      linear-gradient(180deg, var(--ff-s2-65), var(--ff-s2-55)) padding-box,
      var(--ff-ring-grad) border-box;
    color: var(--ff-muted);
    white-space: nowrap;
    transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease), filter var(--ff-med) var(--ff-ease);
  }
  .ff-tab:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-xs); filter:saturate(1.02); }
  .ff-tab.is-active,
  .ff-tab[aria-current="page"]{
    color: var(--ff-text);
    background:
      linear-gradient(180deg, rgba(56,189,248,0.14), rgba(56,189,248,0.10)) padding-box,
      linear-gradient(135deg, rgba(56,189,248,0.52), rgba(255,255,255,0.00)) border-box;
    box-shadow: 0 18px 50px rgba(56,189,248,0.14);
    transform: translateY(0);
  }
  .ff-tab--cta{
    background:
      linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.00)) padding-box,
      var(--ff-brand-grad) border-box;
    color:#fff;
  }

  /* =========================================
   OVERLAYS (drawer / modal / sheet)
   Open: :target / .is-open / [data-open="true"] / [aria-hidden="false"]
   Closed: [hidden] / [data-open="false"] / [aria-hidden="true"]
   Notes:
   - Must win vs global [hidden]{display:none!important}
   - Backdrops must never sit above close buttons/panels
   ========================================= */

/* Drawer */
.ff-drawer{
  position: fixed;
  inset: 0;
  z-index: var(--ff-z-drawer);
  display: none;
  pointer-events: none;
}

/* CLOSED (explicit, must lose to OPEN) */
.ff-drawer[hidden],
.ff-drawer[data-open="false"],
.ff-drawer[aria-hidden="true"]{
  display: none !important;
  pointer-events: none !important;
}

/* OPEN (must win) */
.ff-drawer:target,
.ff-drawer.is-open,
.ff-drawer[data-open="true"],
.ff-drawer[aria-hidden="false"]{
  display: block !important;
  pointer-events: auto !important;
}

.ff-drawer__backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.45);
  border: 0;
  z-index: 0; /* below panel */
}
.ff-root[data-theme="light"] .ff-drawer__backdrop{ background: rgba(15,18,28,0.32); }

.ff-drawer__panel{
  position: absolute;
  right: 0; top: 0; bottom: 0;
  width: min(420px, 92vw);
  padding: 16px;
  box-shadow: var(--ff-shadow-xl);
  overflow: auto;
  border-radius: var(--ff-r-2xl) 0 0 var(--ff-r-2xl);
  backdrop-filter: var(--ff-blur);
  -webkit-backdrop-filter: var(--ff-blur);
  z-index: 1; /* above backdrop */
  transform: translateX(8px);
  opacity: 0;
  transition: transform var(--ff-slow) var(--ff-ease2), opacity var(--ff-med) var(--ff-ease);
  will-change: transform, opacity;
}

/* Panel animates in only when OPEN */
.ff-drawer:target .ff-drawer__panel,
.ff-drawer.is-open .ff-drawer__panel,
.ff-drawer[data-open="true"] .ff-drawer__panel,
.ff-drawer[aria-hidden="false"] .ff-drawer__panel{
  transform: translateX(0);
  opacity: 1;
}

@media (prefers-reduced-motion: reduce){
  .ff-drawer__panel{ transition: none; transform: none; opacity: 1; }
}

.ff-drawer__head{
  position: sticky;
  top: 0;
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom: 1px solid var(--ff-border);
  background: linear-gradient(180deg, rgba(0,0,0,0), var(--ff-card));
}
.ff-root[data-theme="light"] .ff-drawer__head{
  background: linear-gradient(180deg, rgba(255,255,255,0), var(--ff-card));
}
.ff-drawer__grid{ list-style: none; padding: 0; margin: 0; display: grid; gap: 8px; }
.ff-drawer__link{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  border-radius: var(--ff-r-xl);
  border: 1px solid var(--ff-border);
  background: var(--ff-text-08);
  color: var(--ff-text);
  transition: transform var(--ff-med) var(--ff-ease), box-shadow var(--ff-med) var(--ff-ease);
}
.ff-drawer__link:hover{ transform: translateY(-1px); box-shadow: var(--ff-shadow-xs); }


/* Modal */
.ff-modal{
  position: fixed;
  inset: 0;
  z-index: var(--ff-z-modal);
  display: none;
  place-items: center;
  padding: 14px;
  pointer-events: none;
}

/* CLOSED (explicit, must lose to OPEN) */
.ff-modal[hidden],
.ff-modal[data-open="false"],
.ff-modal[aria-hidden="true"]{
  display: none !important;
  pointer-events: none !important;
}

/* OPEN (must win) */
.ff-modal:target,
.ff-modal.is-open,
.ff-modal[data-open="true"],
.ff-modal[aria-hidden="false"]{
  display: grid !important;
  pointer-events: auto !important;
}

.ff-modal__backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.52);
  border: 0;
  z-index: 0; /* below panel */
}
.ff-root[data-theme="light"] .ff-modal__backdrop{ background: rgba(15,18,28,0.32); }

.ff-modal__panel{
  position: relative;
  width: min(820px, calc(100% - 28px));
  max-height: min(82vh, 820px);
  overflow: auto;
  border-radius: var(--ff-r-2xl);
  box-shadow: var(--ff-shadow-xl);
  padding: 16px;
  backdrop-filter: var(--ff-blur);
  -webkit-backdrop-filter: var(--ff-blur);
  z-index: 1; /* above backdrop */
  transform: translateY(10px);
  opacity: 0;
  transition: transform var(--ff-slow) var(--ff-ease2), opacity var(--ff-med) var(--ff-ease);
  will-change: transform, opacity;
}

.ff-modal:target .ff-modal__panel,
.ff-modal.is-open .ff-modal__panel,
.ff-modal[data-open="true"] .ff-modal__panel,
.ff-modal[aria-hidden="false"] .ff-modal__panel{
  transform: translateY(0);
  opacity: 1;
}

@media (prefers-reduced-motion: reduce){
  .ff-modal__panel{ transition: none; transform: none; opacity: 1; }
}

.ff-modal__panel--video{ width: min(980px, calc(100% - 28px)); }

.ff-modal__head{
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
  position: sticky;
  top: 0;
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom: 1px solid var(--ff-border);
  background: linear-gradient(180deg, rgba(0,0,0,0), var(--ff-card));
  z-index: 2;
}
.ff-root[data-theme="light"] .ff-modal__head{
  background: linear-gradient(180deg, rgba(255,255,255,0), var(--ff-card));
}
.ff-modal__body{ position: relative; z-index: 1; }

.ff-modal__foot--sticky,
.ff-modal__foot--flagship{
  position: sticky;
  bottom: 0;
  padding-top: 12px;
  margin-top: 12px;
  border-top: 1px solid var(--ff-border);
  background: linear-gradient(180deg, rgba(0,0,0,0), var(--ff-card));
  z-index: 2;
}
.ff-root[data-theme="light"] .ff-modal__foot--sticky,
.ff-root[data-theme="light"] .ff-modal__foot--flagship{
  background: linear-gradient(180deg, rgba(255,255,255,0), var(--ff-card));
}

.ff-videoFrame{
  border-radius: var(--ff-r-2xl);
  border: 1px solid var(--ff-border);
  background: var(--ff-text-08);
  overflow: hidden;
  aspect-ratio: 16 / 9;
  display: grid;
  place-items: center;
}


/* Sheet (checkout) */
.ff-sheet{
  position: fixed;
  inset: 0;
  z-index: var(--ff-z-sheet);
  display: none;
  pointer-events: none;
}

/* CLOSED (explicit, must lose to OPEN) */
.ff-sheet[hidden],
.ff-sheet[data-open="false"],
.ff-sheet[aria-hidden="true"]{
  display: none !important;
  pointer-events: none !important;
}

/* OPEN (must win) */
.ff-sheet:target,
.ff-sheet.is-open,
.ff-sheet[data-open="true"],
.ff-sheet[aria-hidden="false"]{
  display: block !important;
  pointer-events: auto !important;
}

/* Backdrop + panel stacking (backdrop must be under panel) */
.ff-sheet__backdrop{
  position: absolute;
  inset: 0;
  z-index: 0;
}
.ff-sheet__panel{
  position: relative;
  z-index: 1;
}

/* When OPEN, force panel/backdrop to be visibly “on” even if other rules set opacity/visibility */
.ff-sheet:target .ff-sheet__panel,
.ff-sheet.is-open .ff-sheet__panel,
.ff-sheet[data-open="true"] .ff-sheet__panel,
.ff-sheet[aria-hidden="false"] .ff-sheet__panel{
  opacity: 1 !important;
  transform: none !important;
  visibility: visible !important;
}
.ff-sheet:target .ff-sheet__backdrop,
.ff-sheet.is-open .ff-sheet__backdrop,
.ff-sheet[data-open="true"] .ff-sheet__backdrop,
.ff-sheet[aria-hidden="false"] .ff-sheet__backdrop{
  opacity: 1 !important;
  visibility: visible !important;
}

/* Reduced motion: no transition surprises */
@media (prefers-reduced-motion: reduce){
  .ff-sheet:target .ff-sheet__panel,
  .ff-sheet.is-open .ff-sheet__panel,
  .ff-sheet[data-open="true"] .ff-sheet__panel,
  .ff-sheet[aria-hidden="false"] .ff-sheet__panel{
    transform: none !important;
  }
}

/* ===============================
   IMPORTANT: KEEP THIS ONCE ONLY
   Paste INSIDE your existing
   @layer ff.utilities { ... } block
   near the end (before its closing }).
   This is the “wins vs [hidden]” hard override.
   =============================== */

/*
  #checkout:target,
  #checkout.is-open,
  #checkout[data-open="true"],
  #checkout[aria-hidden="false"]{
    display: block !important;
    pointer-events: auto !important;
  }

  #checkout:target[hidden]{
    display: block !important;
  }
*/




/* EOF: app/static/css/ff.css */
