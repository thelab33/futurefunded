/* ============================================================================
FutureFunded — Flagship FULL STYLESHEET (v32.0.0 “Graphite Aurora • Hyperglass • AA+”)
File: app/static/css/ff.css
DROP-IN REPLACEMENT • HOOK-SAFE • CSP-SAFE • PLAYWRIGHT-SAFE • WHITE-LABEL READY

Contracts honored:
- Tokens ONLY on .ff-root (theme/density only on .ff-root attrs)
- All component styling scoped under .ff-body
- Layer order declared exactly once; each @layer block appears exactly once
- Overlays open: :target, .is-open, [data-open="true"], [aria-hidden="false"]
- Overlays closed: [hidden], [data-open="false"], [aria-hidden="true"]
- No color-mix(), no @property reliance
- Reduced motion respected, safe-area supported, strong focus-visible rings
============================================================================ */

@layer ff.tokens, ff.base, ff.type, ff.layout, ff.surfaces, ff.controls, ff.pages, ff.utilities;

/* ============================================================================
TOKENS (ONLY on .ff-root)
============================================================================ */
@layer ff.tokens {
  .ff-root{
    --ff-font: ui-sans-serif, system-ui, -apple-system, "SF Pro Text", "SF Pro Display",
               Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
    --ff-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
               "Courier New", monospace;

    /* Radius */
    --ff-r-1: 10px;
    --ff-r-2: 14px;
    --ff-r-3: 18px;
    --ff-r-4: 24px;
    --ff-r-5: 30px;
    --ff-r-pill: 999px;

    /* Spacing */
    --ff-0: 0px;
    --ff-1: 6px;
    --ff-2: 10px;
    --ff-3: 14px;
    --ff-4: 18px;
    --ff-5: 24px;
    --ff-6: 32px;
    --ff-7: 40px;
    --ff-8: 56px;

    /* Layout */
    --ff-container: 1120px;
    --ff-gutter: clamp(14px, 3.4vw, 22px);
    --ff-section-pad: clamp(18px, 2.6vw, 40px);

    /* Density */
    --ff-density-pad: 16px;
    --ff-density-card: 16px;
    --ff-density-gap: 10px;

    /* Typography */
    --ff-leading: 1.58;
    --ff-leading-tight: 1.14;
    --ff-track-tight: -0.022em;
    --ff-track: -0.012em;
    --ff-track-wide: 0.085em;

    /* Safe-area */
    --ff-safe-t: env(safe-area-inset-top, 0px);
    --ff-safe-b: env(safe-area-inset-bottom, 0px);
    --ff-safe-r: env(safe-area-inset-right, 0px);
    --ff-safe-l: env(safe-area-inset-left, 0px);

    /* Z */
    --ff-z-tabs: 40;
    --ff-z-backtotop: 45;
    --ff-z-chrome: 50;
    --ff-z-drawer: 70;
    --ff-z-overlay: 80;
    --ff-z-toast: 90;

    /* Motion */
    --ff-ease: cubic-bezier(0.2, 0.8, 0.2, 1);
    --ff-ease-2: cubic-bezier(0.16, 1, 0.3, 1);
    --ff-fast: 140ms;
    --ff-med: 240ms;
    --ff-slow: 420ms;

    /* Brand accents (premium but calm) */
    --ff-accent: rgb(255, 95, 35);     /* citrus lava */
    --ff-accent-2: rgb(255, 146, 60);  /* warm highlight */
    --ff-iris: rgb(99, 102, 241);      /* electric hint */
    --ff-mint: rgb(52, 211, 153);      /* trust */
    --ff-accent-ink: rgb(10, 13, 20);
    --ff-accent-text: rgb(146, 49, 16);

    /* LIGHT */
    --ff-page-bg: rgb(245, 246, 249);
    --ff-page-bg2: rgb(236, 240, 246);
    --ff-canvas-grid: rgba(15, 23, 42, 0.065);
    --ff-canvas-dot: rgba(15, 23, 42, 0.045);
    --ff-canvas-opacity: 0.22;
    --ff-sep: rgba(15, 23, 42, 0.10);

    --ff-surface: rgba(255, 255, 255, 0.92);
    --ff-surface2: rgba(255, 255, 255, 0.98);
    --ff-glass: rgba(255, 255, 255, 0.86);
    --ff-glass-2: rgba(255, 255, 255, 0.76);

    --ff-outline: rgba(15, 23, 42, 0.14);
    --ff-outline-2: rgba(15, 23, 42, 0.22);

    --ff-text: rgb(10, 13, 20);
    --ff-muted: rgb(31, 41, 55);
    --ff-subtle: rgb(51, 65, 85);

    --ff-link: rgb(11, 58, 135);
    --ff-link-underline: rgba(255, 95, 35, 0.58);

    --ff-control-bg: rgba(2, 6, 23, 0.03);
    --ff-control-bg-hover: rgba(2, 6, 23, 0.05);
    --ff-control-bg-press: rgba(2, 6, 23, 0.07);
    --ff-control-bg-soft: rgba(2, 6, 23, 0.02);
    --ff-input-bg: rgba(255, 255, 255, 0.92);

    --ff-shadow: 0 18px 60px rgba(2, 6, 23, 0.12);
    --ff-shadow2: 0 10px 28px rgba(2, 6, 23, 0.14);
    --ff-shadow3: 0 6px 16px rgba(2, 6, 23, 0.12);

    --ff-backdrop: blur(14px) saturate(1.08);

    --ff-focus-outline: 2px solid rgba(255, 95, 35, 0.95);
    --ff-focus-ring: 0 0 0 4px rgba(255, 95, 35, 0.26), 0 0 0 1px rgba(255, 95, 35, 0.54);

    --ff-skel: rgba(2, 6, 23, 0.09);
    --ff-skel2: rgba(2, 6, 23, 0.15);
    --ff-skel-sheen: rgba(255, 255, 255, 0.22);

    --ff-good: rgb(22, 101, 52);
    --ff-warn: rgb(146, 64, 14);
    --ff-bad: rgb(153, 27, 27);
    --ff-info: rgb(29, 78, 216);

    --ff-glow: 0 0 0 1px rgba(255, 95, 35, 0.16), 0 16px 48px rgba(255, 95, 35, 0.10);

    color-scheme: light;
  }

  .ff-root[data-density="compact"]{
    --ff-density-pad: 16px;
    --ff-density-card: 16px;
    --ff-density-gap: 10px;
    --ff-section-pad: clamp(16px, 2.2vw, 36px);
  }
  .ff-root[data-density="cozy"],
  .ff-root[data-density="comfortable"]{
    --ff-density-pad: 20px;
    --ff-density-card: 20px;
    --ff-density-gap: 12px;
    --ff-section-pad: clamp(20px, 2.8vw, 44px);
  }

  /* DARK */
  .ff-root[data-theme="dark"]{
    color-scheme: dark;

    --ff-text: rgba(255, 255, 255, 0.94);
    --ff-muted: rgba(255, 255, 255, 0.78);
    --ff-subtle: rgba(255, 255, 255, 0.62);

    --ff-page-bg: rgb(6, 7, 9);
    --ff-page-bg2: rgb(10, 12, 16);
    --ff-canvas-grid: rgba(255, 255, 255, 0.075);
    --ff-canvas-dot: rgba(255, 255, 255, 0.050);
    --ff-canvas-opacity: 0.14;
    --ff-sep: rgba(255, 255, 255, 0.12);

    --ff-outline: rgba(255, 255, 255, 0.14);
    --ff-outline-2: rgba(255, 255, 255, 0.22);

    --ff-surface: rgba(14, 15, 18, 0.90);
    --ff-surface2: rgba(10, 12, 16, 0.96);
    --ff-glass: rgba(14, 15, 18, 0.80);
    --ff-glass-2: rgba(14, 15, 18, 0.68);

    --ff-control-bg: rgba(255, 255, 255, 0.06);
    --ff-control-bg-hover: rgba(255, 255, 255, 0.085);
    --ff-control-bg-press: rgba(255, 255, 255, 0.11);
    --ff-control-bg-soft: rgba(255, 255, 255, 0.05);
    --ff-input-bg: rgba(255, 255, 255, 0.085);

    --ff-shadow: 0 22px 86px rgba(0, 0, 0, 0.56);
    --ff-shadow2: 0 14px 44px rgba(0, 0, 0, 0.50);
    --ff-shadow3: 0 8px 20px rgba(0, 0, 0, 0.46);

    --ff-skel: rgba(255, 255, 255, 0.085);
    --ff-skel2: rgba(255, 255, 255, 0.14);
    --ff-skel-sheen: rgba(255, 255, 255, 0.18);

    --ff-accent-ink: rgb(10, 13, 20);
    --ff-accent-text: rgb(255, 187, 140);

    --ff-link: rgb(167, 243, 208);
    --ff-link-underline: rgba(255, 95, 35, 0.60);
  }

  /* system_dark */
  .ff-root[data-theme="system_dark"]{ color-scheme: light; }
  @media (prefers-color-scheme: dark){
    .ff-root[data-theme="system_dark"],
    .ff-root:not([data-theme]){
      color-scheme: dark;

      --ff-text: rgba(255, 255, 255, 0.94);
      --ff-muted: rgba(255, 255, 255, 0.78);
      --ff-subtle: rgba(255, 255, 255, 0.62);

      --ff-page-bg: rgb(6, 7, 9);
      --ff-page-bg2: rgb(10, 12, 16);
      --ff-canvas-grid: rgba(255, 255, 255, 0.075);
      --ff-canvas-dot: rgba(255, 255, 255, 0.050);
      --ff-canvas-opacity: 0.14;
      --ff-sep: rgba(255, 255, 255, 0.12);

      --ff-outline: rgba(255, 255, 255, 0.14);
      --ff-outline-2: rgba(255, 255, 255, 0.22);

      --ff-surface: rgba(14, 15, 18, 0.90);
      --ff-surface2: rgba(10, 12, 16, 0.96);
      --ff-glass: rgba(14, 15, 18, 0.80);
      --ff-glass-2: rgba(14, 15, 18, 0.68);

      --ff-control-bg: rgba(255, 255, 255, 0.06);
      --ff-control-bg-hover: rgba(255, 255, 255, 0.085);
      --ff-control-bg-press: rgba(255, 255, 255, 0.11);
      --ff-control-bg-soft: rgba(255, 255, 255, 0.05);
      --ff-input-bg: rgba(255, 255, 255, 0.085);

      --ff-shadow: 0 22px 86px rgba(0, 0, 0, 0.56);
      --ff-shadow2: 0 14px 44px rgba(0, 0, 0, 0.50);
      --ff-shadow3: 0 8px 20px rgba(0, 0, 0, 0.46);

      --ff-skel: rgba(255, 255, 255, 0.085);
      --ff-skel2: rgba(255, 255, 255, 0.14);
      --ff-skel-sheen: rgba(255, 255, 255, 0.18);

      --ff-accent-ink: rgb(10, 13, 20);
      --ff-accent-text: rgb(255, 187, 140);

      --ff-link: rgb(167, 243, 208);
      --ff-link-underline: rgba(255, 95, 35, 0.60);
    }
  }

  @media (prefers-contrast: more){
    .ff-root{
      --ff-outline: rgba(15, 23, 42, 0.24);
      --ff-outline-2: rgba(15, 23, 42, 0.38);
      --ff-surface: rgba(255, 255, 255, 0.98);
      --ff-glass: rgba(255, 255, 255, 0.94);
      --ff-glass-2: rgba(255, 255, 255, 0.90);
      --ff-control-bg: rgba(2, 6, 23, 0.05);
      --ff-control-bg-hover: rgba(2, 6, 23, 0.075);
      --ff-input-bg: rgba(255, 255, 255, 0.98);
      --ff-focus-ring: 0 0 0 5px rgba(255, 95, 35, 0.30), 0 0 0 1px rgba(255, 95, 35, 0.62);
    }
    .ff-root[data-theme="dark"],
    .ff-root[data-theme="system_dark"]{
      --ff-muted: rgba(255, 255, 255, 0.90);
      --ff-subtle: rgba(255, 255, 255, 0.76);
      --ff-outline: rgba(255, 255, 255, 0.22);
      --ff-outline-2: rgba(255, 255, 255, 0.36);
      --ff-surface: rgba(10, 12, 16, 0.94);
      --ff-glass: rgba(10, 12, 16, 0.92);
      --ff-glass-2: rgba(10, 12, 16, 0.90);
      --ff-control-bg: rgba(255, 255, 255, 0.085);
      --ff-control-bg-hover: rgba(255, 255, 255, 0.11);
      --ff-input-bg: rgba(255, 255, 255, 0.11);
    }
  }
}

/* ============================================================================
BASE (scoped to .ff-body)
============================================================================ */
@layer ff.base {
  .ff-body{
    margin: 0;
    font-family: var(--ff-font);
    color: var(--ff-text);
    background-color: var(--ff-page-bg);
    background-image:
      radial-gradient(1200px 640px at 12% 12%, rgba(255, 95, 35, 0.10), transparent 56%),
      radial-gradient(900px 560px at 86% 18%, rgba(99, 102, 241, 0.07), transparent 60%),
      radial-gradient(980px 720px at 52% 78%, rgba(52, 211, 153, 0.05), transparent 66%),
      radial-gradient(1100px 760px at 50% 108%, rgba(99, 102, 241, 0.06), transparent 62%),
      linear-gradient(180deg, rgba(2, 6, 23, 0.04), rgba(2, 6, 23, 0) 32%),
      linear-gradient(180deg, var(--ff-page-bg), var(--ff-page-bg2));
    background-repeat: no-repeat;
    background-size: cover;
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    padding-bottom: calc(72px + var(--ff-safe-b));
    line-height: var(--ff-leading);
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-kerning: normal;
    -webkit-tap-highlight-color: transparent;
    overscroll-behavior-x: none;
  }

  .ff-body::before{
    content:"";
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:0;
    background-image:
      repeating-linear-gradient(0deg, var(--ff-canvas-grid) 0, var(--ff-canvas-grid) 1px, transparent 1px, transparent 28px),
      repeating-linear-gradient(90deg, var(--ff-canvas-grid) 0, var(--ff-canvas-grid) 1px, transparent 1px, transparent 28px),
      radial-gradient(var(--ff-canvas-dot) 1px, transparent 1px),
      radial-gradient(var(--ff-canvas-dot) 1px, transparent 1px);
    background-size: 28px 28px, 28px 28px, 18px 18px, 22px 22px;
    background-position: 0 0, 0 0, 4px 6px, 13px 11px;
    opacity: var(--ff-canvas-opacity);
    transform: translateZ(0);
    -webkit-mask-image:
      radial-gradient(1100px 720px at 50% 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 72%),
      linear-gradient(180deg, rgba(0,0,0,1) 0%, rgba(0,0,0,0.55) 42%, rgba(0,0,0,0.18) 72%, rgba(0,0,0,0.06) 100%);
            mask-image:
      radial-gradient(1100px 720px at 50% 0%, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 72%),
      linear-gradient(180deg, rgba(0,0,0,1) 0%, rgba(0,0,0,0.55) 42%, rgba(0,0,0,0.18) 72%, rgba(0,0,0,0.06) 100%);
  }

  @media (min-width: 920px){ .ff-body{ padding-bottom: 0; } }

  .ff-body *,.ff-body *::before,.ff-body *::after{ box-sizing: border-box; }
  .ff-body img,.ff-body svg{ display:block; max-width:100%; height:auto; }

  .ff-body button,.ff-body input,.ff-body textarea,.ff-body select{ font:inherit; color:inherit; }

  .ff-body a{
    color: var(--ff-link);
    text-decoration: underline;
    text-underline-offset: 3px;
    text-decoration-thickness: 2px;
    text-decoration-color: var(--ff-link-underline);
    text-decoration-skip-ink: auto;
  }
  .ff-body a:hover{ text-decoration-color: rgba(255, 95, 35, 0.92); }

  .ff-body .ff-btn,
  .ff-body .ff-nav__link,
  .ff-body .ff-tab,
  .ff-body .ff-iconbtn,
  .ff-body .ff-nounderline{ text-decoration:none !important; color:inherit; }

  .ff-body code,.ff-body pre{ font-family: var(--ff-mono); }

  .ff-body :where(a,button,input,textarea,select,summary,[tabindex]):focus-visible{
    outline: var(--ff-focus-outline);
    outline-offset: 2px;
    box-shadow: var(--ff-focus-ring);
    border-radius: 12px;
  }
  .ff-body :where(a,button,input,textarea,select,summary,[tabindex]):focus{ outline:none; }

  .ff-body ::selection{ background: rgba(255, 95, 35, 0.22); }

  .ff-sr{
    position:absolute !important;
    width:1px !important; height:1px !important;
    padding:0 !important; margin:-1px !important;
    overflow:hidden !important; clip:rect(0,0,0,0) !important;
    white-space:nowrap !important; border:0 !important;
  }

  .ff-skiplinks{ position:absolute; inset:0 auto auto 0; z-index: var(--ff-z-chrome); }
  .ff-skip{
    position:absolute;
    left:-999px;
    top: calc(10px + var(--ff-safe-t));
    padding: 10px 12px;
    border-radius: 12px;
    background: var(--ff-surface2);
    border: 1px solid var(--ff-outline);
    box-shadow: var(--ff-shadow3);
    color: var(--ff-text);
    font-weight: 800;
    text-decoration: none !important;
  }
  .ff-skip:focus{ left:10px; }

  .ff-root.is-loading .ff-body{ opacity:0.86; pointer-events:none; }
  .ff-root.is-ready .ff-body{ opacity:1; }
  .ff-root.is-error .ff-body{ outline:2px solid rgba(239,68,68,0.62); outline-offset:2px; }

  @media (prefers-reduced-motion: reduce){
    .ff-body *,.ff-body *::before,.ff-body *::after{
      animation-duration:1ms !important;
      animation-iteration-count:1 !important;
      transition-duration:1ms !important;
      scroll-behavior:auto !important;
    }
  }

  @media (forced-colors: active){
    .ff-body :where(a,button,input,textarea,select,summary,[tabindex]):focus-visible{
      outline:2px solid Highlight;
      outline-offset:2px;
      box-shadow:none;
    }
  }
}

/* ============================================================================
TYPE
============================================================================ */
@layer ff.type{
  .ff-body .ff-num{ font-variant-numeric: tabular-nums; letter-spacing: 0.01em; }
  .ff-body .ff-muted{ color: var(--ff-muted); }
  .ff-body .ff-subtle{ color: var(--ff-subtle); }

  .ff-body .ff-kicker{
    font-size: 12px;
    letter-spacing: var(--ff-track-wide);
    text-transform: uppercase;
    color: var(--ff-muted);
    font-weight: 860;
    margin:0;
  }
  .ff-body .ff-lead{
    font-size: clamp(15px, 1.2vw, 18px);
    line-height: 1.62;
    color: var(--ff-text);
    text-wrap: pretty;
    margin:0;
  }
  .ff-body .ff-help{
    font-size: 13px;
    line-height: 1.62;
    color: var(--ff-muted);
    text-wrap: pretty;
    margin:0;
  }
  .ff-body .ff-label{
    font-size: 13px;
    font-weight: 780;
    letter-spacing: 0.005em;
    color: var(--ff-text);
  }
  .ff-body .ff-big{
    font-size: clamp(20px, 2.2vw, 28px);
    font-weight: 820;
    line-height: 1.1;
    letter-spacing: var(--ff-track);
    text-wrap: balance;
    margin:0;
  }
  .ff-body .ff-display{
    font-size: clamp(28px, 3.6vw, 46px);
    font-weight: 880;
    line-height: 1.03;
    letter-spacing: var(--ff-track-tight);
    text-wrap: balance;
    margin:0;
  }
  .ff-body .ff-h2{
    font-size: clamp(20px, 2.1vw, 28px);
    font-weight: 860;
    line-height: 1.12;
    letter-spacing: var(--ff-track);
    margin:0;
    text-wrap: balance;
  }
  .ff-body .ff-h3{
    font-size: clamp(16px, 1.6vw, 20px);
    font-weight: 860;
    line-height: 1.18;
    letter-spacing: var(--ff-track);
    margin:0;
    text-wrap: balance;
  }
  .ff-body .ff-code{
    font-family: var(--ff-mono);
    font-size: 12px;
    padding: 2px 8px;
    border-radius: var(--ff-r-pill);
    border: 1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    color: var(--ff-text);
    white-space: nowrap;
  }
  .ff-body :where(p,li){ text-wrap: pretty; }
  .ff-body :where(h1,h2,h3,h4){ text-wrap: balance; }
  .ff-body .ff-nounderline{ text-decoration:none !important; }
}

/* ============================================================================
LAYOUT
============================================================================ */
@layer ff.layout{
  .ff-body .ff-container{
    width:100%;
    max-width: var(--ff-container);
    margin-inline:auto;
    padding-inline: var(--ff-gutter);
    min-width:0;
  }
  .ff-body .ff-shell{ position:relative; z-index:1; width:100%; min-width:0; min-height:100vh; }
  .ff-body .ff-shellBg{ position:absolute; inset:0; pointer-events:none; z-index:-1; }

  .ff-body .ff-section{
    padding-block: var(--ff-section-pad);
    position:relative;
    isolation:isolate;
    scroll-margin-top: calc(84px + var(--ff-safe-t));
    min-width:0;
  }
  .ff-body :where(.ff-section + .ff-section)::before{
    content:"";
    position:absolute;
    top:0; left:0; right:0;
    height:1px;
    background:linear-gradient(90deg, transparent, var(--ff-sep), transparent);
    opacity:0.8;
    pointer-events:none;
  }

  .ff-body .ff-section--hero{
    padding-top: clamp(16px, 2.4vw, 30px);
    padding-bottom: clamp(22px, 2.8vw, 42px);
  }

  .ff-body .ff-stack{ display:flex; flex-direction:column; gap: var(--ff-density-gap); min-width:0; }
  .ff-body .ff-row{ display:flex; flex-direction:row; gap: var(--ff-density-gap); min-width:0; }
  .ff-body .ff-grid{ display:grid; gap: var(--ff-density-gap); min-width:0; }

  .ff-body .ff-row--between{ justify-content:space-between; }
  .ff-body .ff-row.ff-ais{ align-items:center; }
  .ff-body .ff-ais{ align-items:stretch; }
  .ff-body .ff-wrap{ flex-wrap:wrap; }
  .ff-body .ff-minw-0{ min-width:0; }

  .ff-body .ff-grid--2{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  @media (max-width: 520px){ .ff-body .ff-grid--2{ grid-template-columns: 1fr; } }

  .ff-body .ff-w-100{ width:100%; }
  .ff-body .ff-nowrap{ white-space:nowrap; }

  .ff-body .ff-sectionhead{
    display:grid;
    gap: var(--ff-4);
    align-items:end;
    grid-template-columns: 1fr;
    min-width:0;
  }
  .ff-body .ff-sectionhead--compact{ gap: var(--ff-3); }
  .ff-body .ff-sectionhead__actions{
    display:flex;
    gap: var(--ff-2);
    flex-wrap:wrap;
    align-items:center;
    justify-content:flex-start;
    min-width:0;
  }
  @media (min-width: 860px){
    .ff-body .ff-sectionhead{ grid-template-columns: minmax(0,1fr) auto; }
    .ff-body .ff-sectionhead__actions{ justify-content:flex-end; }
  }
  .ff-body .ff-inlineMeta{
    display:flex; flex-wrap:wrap; gap: var(--ff-2);
    padding:0; margin:0; list-style:none;
  }
  .ff-body .ff-inlineMeta__item{
    font-size:12px; line-height:1.25;
    color: var(--ff-muted);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    padding:6px 10px;
    border-radius: var(--ff-r-pill);
    white-space:nowrap;
  }

  @supports (content-visibility: auto){
    @media (min-width: 980px){
      .ff-body .ff-section:not(.ff-section--hero){ content-visibility:auto; contain-intrinsic-size: 560px 1px; }
    }
  }
}

/* ============================================================================
SURFACES
============================================================================ */
@layer ff.surfaces{
  .ff-body .ff-surface{
    background: var(--ff-surface);
    border:1px solid var(--ff-outline);
    box-shadow: var(--ff-shadow3);
    border-radius: var(--ff-r-4);
  }
  .ff-body .ff-glass{
    background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0)), var(--ff-glass);
    border:1px solid var(--ff-outline);
    box-shadow: var(--ff-shadow2);
    border-radius: var(--ff-r-4);
    transform: translateZ(0);
  }
  @supports ((backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px))){
    .ff-body .ff-glass{ -webkit-backdrop-filter: var(--ff-backdrop); backdrop-filter: var(--ff-backdrop); }
  }

  .ff-body .ff-card{
    background: var(--ff-surface2);
    border:1px solid var(--ff-outline);
    border-radius: var(--ff-r-4);
    box-shadow: var(--ff-shadow);
    transform: translateZ(0);
  }
  .ff-body .ff-card--premium{
    border-color: rgba(255,95,35,0.28);
    box-shadow: var(--ff-glow), var(--ff-shadow);
  }

  @media (hover:hover) and (pointer:fine) and (prefers-reduced-motion: no-preference){
    .ff-body .ff-card--lift{
      transition: transform var(--ff-med) var(--ff-ease-2), box-shadow var(--ff-med) var(--ff-ease-2), border-color var(--ff-med) var(--ff-ease-2);
      will-change: transform;
    }
    .ff-body .ff-card--lift:hover{
      transform: translateY(-3px);
      border-color: var(--ff-outline-2);
      box-shadow: var(--ff-shadow), 0 24px 80px rgba(2,6,23,0.10);
    }
  }

  .ff-body .ff-pad{ padding: var(--ff-density-card); border-radius: var(--ff-r-4); }

  .ff-body .ff-divider{ border:0; height:1px; background: var(--ff-outline); width:100%; margin:0; }

  .ff-body .ff-scroll{
    height:2px; border-radius: var(--ff-r-pill);
    overflow:hidden; background: rgba(15,23,42,0.10);
  }
  .ff-body .ff-scroll span{
    display:block; height:100%; width:30%;
    background: rgba(255,95,35,0.72);
    border-radius: var(--ff-r-pill);
  }
}

/* ============================================================================
CONTROLS
============================================================================ */
@layer ff.controls{
  .ff-body .ff-btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    min-height:44px;
    padding:10px 14px;
    border-radius: var(--ff-r-2);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    color: var(--ff-text);
    font-weight: 800;
    font-size: 14px;
    line-height: 1;
    cursor:pointer;
    user-select:none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    transition: transform var(--ff-fast) var(--ff-ease), box-shadow var(--ff-fast) var(--ff-ease),
                background var(--ff-fast) var(--ff-ease), border-color var(--ff-fast) var(--ff-ease),
                filter var(--ff-fast) var(--ff-ease);
  }
  .ff-body .ff-btn:active{ transform: translateY(1px); }
  .ff-body .ff-btn[disabled], .ff-body .ff-btn:disabled{ opacity:0.6; cursor:not-allowed; transform:none; filter:none; }

  .ff-body .ff-btn--pill{ border-radius: var(--ff-r-pill); }
  .ff-body .ff-btn--sm{ min-height:40px; padding:8px 12px; font-size:13px; }
  .ff-body .ff-btn--lg{ min-height:48px; padding:12px 16px; font-size:15px; }

  .ff-body .ff-btn__label{ font-weight: 900; }
  .ff-body .ff-btn__sub{ display:block; font-weight: 780; opacity:0.95; }

  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-btn:hover{
      border-color: var(--ff-outline-2);
      background: var(--ff-control-bg-hover);
      box-shadow: var(--ff-shadow3);
    }
  }

  .ff-body .ff-btn--primary{
    background: linear-gradient(180deg, rgba(255,95,35,0.98), rgba(255,95,35,0.84));
    border-color: rgba(255,95,35,0.62);
    color: var(--ff-accent-ink);
    box-shadow: 0 10px 26px rgba(255,95,35,0.22);
  }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-btn--primary:hover{ box-shadow: 0 14px 34px rgba(255,95,35,0.28); }
  }

  .ff-body .ff-btn--secondary{
    background: linear-gradient(180deg, rgba(52,211,153,0.18), rgba(52,211,153,0.10));
    border-color: rgba(52,211,153,0.30);
    color: var(--ff-text);
  }

  .ff-body .ff-btn--ghost{ background: transparent; border-color: rgba(255,255,255,0); box-shadow:none; }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-btn--ghost:hover{ background: var(--ff-control-bg-hover); border-color: var(--ff-outline); }
  }

  .ff-body .ff-iconbtn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:44px; height:44px;
    border-radius: var(--ff-r-pill);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    cursor:pointer;
    user-select:none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    transition: transform var(--ff-fast) var(--ff-ease), background var(--ff-fast) var(--ff-ease),
                border-color var(--ff-fast) var(--ff-ease), box-shadow var(--ff-fast) var(--ff-ease);
  }
  .ff-body .ff-iconbtn:active{ transform: translateY(1px); }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-iconbtn:hover{
      border-color: var(--ff-outline-2);
      background: var(--ff-control-bg-hover);
      box-shadow: var(--ff-shadow3);
    }
  }

  .ff-body .ff-pill{
    display:inline-flex; align-items:center; gap:8px;
    padding:6px 10px;
    border-radius: var(--ff-r-pill);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    font-size:12px;
    font-weight: 750;
    color: var(--ff-muted);
    line-height:1;
    white-space:nowrap;
  }
  .ff-body .ff-pill--accent{ background: rgba(255,95,35,0.16); border-color: rgba(255,95,35,0.34); color: var(--ff-text); }
  .ff-body .ff-pill--soft{ background: rgba(99,102,241,0.12); border-color: rgba(99,102,241,0.26); color: var(--ff-text); }
  .ff-body .ff-pill--live{ background: rgba(22,101,52,0.12); border-color: rgba(22,101,52,0.26); color: var(--ff-text); }
  .ff-body .ff-pill--ghost{ background: transparent; }

  .ff-body .ff-dot{
    width:8px; height:8px; border-radius: var(--ff-r-pill);
    background: var(--ff-good);
    box-shadow: 0 0 0 3px rgba(22,101,52,0.14);
    flex:0 0 auto;
  }

  .ff-body .ff-chip{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    min-height:44px;
    padding:10px 12px;
    border-radius: var(--ff-r-2);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg-soft);
    font-size:14px;
    font-weight: 820;
    cursor:pointer;
    user-select:none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    transition: transform var(--ff-fast) var(--ff-ease), background var(--ff-fast) var(--ff-ease),
                border-color var(--ff-fast) var(--ff-ease), box-shadow var(--ff-fast) var(--ff-ease);
  }
  .ff-body .ff-chip--pill{ border-radius: var(--ff-r-pill); }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-chip:hover{ border-color: var(--ff-outline-2); background: var(--ff-control-bg); }
  }
  .ff-body .ff-chip:active{ transform: translateY(1px); }
  .ff-body .ff-chip.is-selected,
  .ff-body .ff-chip[aria-pressed="true"]{ border-color: rgba(255,95,35,0.62); box-shadow: 0 0 0 4px rgba(255,95,35,0.14); }

  .ff-body .ff-chip--impact{ align-items:baseline; justify-content:space-between; width:100%; }
  .ff-body .ff-chip__amt{ font-weight:900; letter-spacing:-0.01em; }
  .ff-body .ff-chip__meta{ font-size:12px; color: var(--ff-muted); font-weight: 820; }

  .ff-body .ff-input{
    width:100%;
    min-height:44px;
    border-radius: var(--ff-r-2);
    border:1px solid var(--ff-outline);
    background: var(--ff-input-bg);
    padding:11px 12px;
    font-size:14px;
    line-height:1.25;
    outline:none;
    color: var(--ff-text);
    caret-color: rgba(255,95,35,0.92);
    transition: border-color var(--ff-fast) var(--ff-ease), box-shadow var(--ff-fast) var(--ff-ease), background var(--ff-fast) var(--ff-ease);
  }
  .ff-body .ff-input::placeholder{ color: var(--ff-subtle); opacity:0.85; }
  .ff-body .ff-input:hover{ border-color: var(--ff-outline-2); }
  .ff-body .ff-input:focus{ box-shadow: var(--ff-focus-ring); border-color: rgba(255,95,35,0.62); }
  .ff-body textarea.ff-input{ resize:vertical; min-height:110px; }

  .ff-body .ff-input--amount{ text-align:left; font-weight:860; letter-spacing:0.01em; }
  .ff-body .ff-input--amountFlagship{ font-size:16px; padding:12px 12px; }

  .ff-body .ff-alert{
    border-radius: var(--ff-r-3);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    padding:12px 12px;
    box-shadow: var(--ff-shadow3);
    font-size:13px;
    line-height:1.55;
    color: var(--ff-text);
  }
  .ff-body .ff-alert--info{ border-color: rgba(99,102,241,0.30); background: rgba(99,102,241,0.10); }
  .ff-body .ff-alert--error{ border-color: rgba(153,27,27,0.42); background: rgba(153,27,27,0.12); }

  .ff-body .ff-disclosure{
    border:1px solid var(--ff-outline);
    border-radius: var(--ff-r-3);
    background: var(--ff-control-bg-soft);
    overflow: clip;
  }
  .ff-body .ff-disclosure__sum{
    list-style:none;
    display:grid;
    grid-template-columns: 1fr auto;
    gap: var(--ff-2);
    align-items:center;
    padding:12px 12px;
    cursor:pointer;
    user-select:none;
    font-weight: 820;
    color: var(--ff-text);
    min-width:0;
  }
  .ff-body summary.ff-disclosure__sum::-webkit-details-marker{ display:none; }
  .ff-body .ff-disclosure__sum::after{
    content:"▾";
    font-size:14px;
    opacity:0.8;
    transform: rotate(0deg);
    transition: transform var(--ff-med) var(--ff-ease);
  }
  .ff-body details[open] summary.ff-disclosure__sum::after{ transform: rotate(180deg); }
  .ff-body .ff-disclosure__panel{ padding: 0 12px 12px; border-top:1px solid var(--ff-outline); }

  .ff-body .ff-meter{
    border-radius: var(--ff-r-pill);
    border:1px solid var(--ff-outline);
    background: rgba(2,6,23,0.04);
    overflow: clip;
    padding:6px;
  }
  .ff-body .ff-meter__progress{
    width:100%;
    height:10px;
    appearance:none;
    border-radius: var(--ff-r-pill);
    overflow: clip;
    display:block;
  }
  .ff-body .ff-meter__progress::-webkit-progress-bar{ background: rgba(15,23,42,0.12); border-radius: var(--ff-r-pill); }
  .ff-body .ff-meter__progress::-webkit-progress-value{
    background: linear-gradient(90deg, rgba(255,95,35,0.94), rgba(255,146,60,0.90));
    border-radius: var(--ff-r-pill);
  }
  .ff-body .ff-meter__progress::-moz-progress-bar{
    background: linear-gradient(90deg, rgba(255,95,35,0.94), rgba(255,146,60,0.90));
    border-radius: var(--ff-r-pill);
  }

  .ff-body .ff-skeleton{
    width:100%;
    height:100%;
    border-radius: var(--ff-r-2);
    background: linear-gradient(90deg, transparent, var(--ff-skel-sheen), transparent), var(--ff-skel);
    background-size: 220px 100%, auto;
    background-repeat:no-repeat;
    background-position:-220px 0, 0 0;
    animation: ff-skel 1.1s linear infinite;
  }
  @media (prefers-reduced-motion: reduce){
    .ff-body .ff-skeleton{ animation:none; background-position:0 0, 0 0; }
  }
  @keyframes ff-skel{ to{ background-position: 220px 0, 0 0; } }
}

/* ============================================================================
PAGES (chrome, hero, sections, overlays, footer, tabs, toasts)
============================================================================ */
@layer ff.pages{
  /* Chrome */
  .ff-body .ff-chrome{
    position: sticky;
    top: 0;
    z-index: var(--ff-z-chrome);
    padding-top: calc(10px + var(--ff-safe-t));
    isolation:isolate;
  }
  .ff-body .ff-chrome__stack{ display:grid; gap: var(--ff-2); }

  /* Announcement */
  .ff-body .ff-announce__inner{ border-radius: var(--ff-r-4); padding:10px 12px; }
  .ff-body .ff-announce__row{ display:flex; gap: var(--ff-2); align-items:center; flex-wrap:wrap; justify-content:space-between; }
  .ff-body .ff-announce__badge{
    font-size:12px;
    font-weight:900;
    letter-spacing: var(--ff-track-wide);
    text-transform:uppercase;
    padding:6px 10px;
    border-radius: var(--ff-r-pill);
    background: rgba(255,95,35,0.16);
    border:1px solid rgba(255,95,35,0.34);
    color: var(--ff-text);
    white-space:nowrap;
  }
  .ff-body .ff-announce__text{ margin:0; font-size:13px; color: var(--ff-text); flex:1 1 260px; min-width:0; text-wrap:pretty; }

  /* Topbar */
  .ff-body .ff-topbar{ padding-bottom: 6px; }
  .ff-body .ff-topbar__capsule{ border-radius: var(--ff-r-5); padding:10px; }
  .ff-body .ff-topbar__capsuleInner{ display:flex; flex-direction:column; }
  .ff-body .ff-topbar__mainRow{ width:100%; }
  .ff-body .ff-topbar__desktop-only{ display:none; }
  .ff-body .ff-topbar__mobile-only{ display:flex; }
  @media (min-width: 920px){
    .ff-body .ff-topbar__desktop-only{ display:block; }
    .ff-body .ff-topbar__mobile-only{ display:none; }
  }

  .ff-body .ff-platformBrand{ display:inline-flex; align-items:center; gap:10px; }
  .ff-body .ff-platformBrand__disc{
    width:32px; height:32px;
    border-radius: var(--ff-r-pill);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg-soft);
    display:inline-flex;
    align-items:center;
    justify-content:center;
  }
  .ff-body .ff-platformBrand__logo{ width:18px; height:18px; }
  .ff-body .ff-sep{ color: var(--ff-muted); opacity:0.9; }
  .ff-body .ff-sep--dot{ font-size:14px; line-height:1; }

  .ff-body .ff-topbarBrand{ display:inline-flex; align-items:center; gap:10px; font-weight:900; min-width:0; }
  .ff-body .ff-topbarBrand img{ border-radius:12px; border:1px solid var(--ff-outline); }
  .ff-body .ff-topbarBrand__text{
    font-size:14px;
    font-weight:900;
    white-space:nowrap;
    overflow:hidden;
    text-overflow: ellipsis;
    max-width: 44vw;
  }
  @media (min-width: 920px){ .ff-body .ff-topbarBrand__text{ max-width: 360px; } }

  .ff-body .ff-navPill{ border-radius: var(--ff-r-pill); padding:6px; }
  .ff-body .ff-nav{ display:inline-flex; gap:2px; padding:0; margin:0; }
  .ff-body .ff-nav__link{
    display:inline-flex;
    align-items:center;
    min-height:44px;
    padding:10px 12px;
    border-radius: var(--ff-r-pill);
    font-size:13px;
    font-weight:860;
    color: var(--ff-muted);
    border:1px solid transparent;
    transition: background var(--ff-fast) var(--ff-ease), color var(--ff-fast) var(--ff-ease), border-color var(--ff-fast) var(--ff-ease), box-shadow var(--ff-fast) var(--ff-ease);
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-nav__link:hover{
      background: var(--ff-control-bg-hover);
      color: var(--ff-text);
      border-color: var(--ff-outline);
      box-shadow: var(--ff-shadow3);
    }
  }

  /* Drawer */
  .ff-body .ff-drawer{
    position: fixed;
    inset: 0;
    z-index: var(--ff-z-drawer);
    display:none;
    pointer-events:none;
  }
  .ff-body .ff-drawer__backdrop{
    position:absolute;
    inset:0;
    background: rgba(2,6,23,0.58);
    border:0; padding:0; margin:0;
    cursor:pointer;
    pointer-events:auto;
  }
  .ff-body .ff-drawer__panel{
    position:absolute;
    top:0; right:0;
    height:100%;
    width: min(420px, 92vw);
    background: var(--ff-surface2);
    border-left: 1px solid var(--ff-outline);
    box-shadow: var(--ff-shadow);
    padding: 14px;
    display:grid;
    grid-template-rows:auto 1fr;
    gap: 12px;
    transform: translateX(10px);
    min-height:0;
    pointer-events:auto;
  }
  .ff-body .ff-drawer__head{ display:flex; align-items:center; justify-content:space-between; gap:12px; min-width:0; }
  .ff-body .ff-drawer__orgLogo{ border-radius:12px; border:1px solid var(--ff-outline); }
  .ff-body .ff-drawer__body{ overflow:auto; padding-right:2px; min-height:0; }
  .ff-body .ff-brand{ display:flex; align-items:center; gap:12px; min-width:0; }
  .ff-body .ff-brand__title{ font-weight:920; letter-spacing: var(--ff-track); line-height: var(--ff-leading-tight); }
  .ff-body .ff-brand__sub{ font-size:13px; color: var(--ff-muted); margin:0; }
  .ff-body .ff-drawer__grid{ list-style:none; padding:0; margin:0; display:grid; gap:8px; }
  .ff-body .ff-drawer__link{
    display:flex; align-items:center; justify-content:space-between;
    padding:12px;
    border-radius: var(--ff-r-2);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg-soft);
    font-weight:860;
    color: var(--ff-text);
    transition: background var(--ff-fast) var(--ff-ease), border-color var(--ff-fast) var(--ff-ease), transform var(--ff-fast) var(--ff-ease);
  }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-drawer__link:hover{ border-color: var(--ff-outline-2); background: var(--ff-control-bg); transform: translateY(-1px); }
  }

  .ff-body .ff-drawer[hidden],
  .ff-body .ff-drawer[data-open="false"],
  .ff-body .ff-drawer[aria-hidden="true"]{ display:none; }
  .ff-body .ff-drawer:target,
  .ff-body .ff-drawer.is-open,
  .ff-body .ff-drawer[data-open="true"],
  .ff-body .ff-drawer[aria-hidden="false"]{ display:block !important; pointer-events:auto; }
  .ff-body .ff-drawer:target .ff-drawer__panel,
  .ff-body .ff-drawer.is-open .ff-drawer__panel,
  .ff-body .ff-drawer[data-open="true"] .ff-drawer__panel,
  .ff-body .ff-drawer[aria-hidden="false"] .ff-drawer__panel{ transform: translateX(0); transition: transform var(--ff-med) var(--ff-ease); }

  /* Hero */
  .ff-body .ff-hero{ overflow:hidden; }
  .ff-body .ff-hero__bg{ position:absolute; inset:0; pointer-events:none; }
  .ff-body .ff-hero__orb{ position:absolute; width:520px; height:520px; border-radius: var(--ff-r-pill); filter: blur(28px); opacity:0.36; }
  .ff-body .ff-hero__orb--a{ left:-160px; top:-140px; background: rgba(255,95,35,0.24); }
  .ff-body .ff-hero__orb--b{ right:-160px; top:-120px; background: rgba(99,102,241,0.18); }

  .ff-body .ff-hero__gridlines{
    position:absolute; inset:0;
    opacity:0.10;
    background-image:
      linear-gradient(to right, rgba(255,255,255,0.18) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(255,255,255,0.18) 1px, transparent 1px);
    background-size: 56px 56px;
    mask-image: radial-gradient(60% 60% at 50% 30%, black, transparent 70%);
  }
  .ff-root[data-theme="light"] .ff-body .ff-hero__gridlines,
  .ff-root:not([data-theme]) .ff-body .ff-hero__gridlines{
    opacity:0.08;
    background-image:
      linear-gradient(to right, rgba(2,6,23,0.12) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(2,6,23,0.12) 1px, transparent 1px);
  }

  .ff-body .ff-hero__grid{
    display:grid;
    gap: var(--ff-5);
    grid-template-columns: minmax(0,1fr);
    align-items:start;
  }
  @media (min-width: 980px){
    .ff-body .ff-hero__grid{ grid-template-columns: minmax(0,1.25fr) minmax(0,0.75fr); }
    .ff-body .ff-heroPanel{ position: sticky; top: calc(92px + var(--ff-safe-t)); }
  }
  .ff-body .ff-hero__capsule{ border-radius: var(--ff-r-5); }
  .ff-body .ff-hero__capsuleInner{ padding: var(--ff-density-pad); }
  .ff-body .ff-heroContext{ list-style:none; padding:0; margin:0 0 var(--ff-4); display:flex; flex-wrap:wrap; gap: var(--ff-2); }
  .ff-body .ff-heroHeader{ min-width:0; }
  .ff-body .ff-heroTitle{ margin:0; }
  .ff-body .ff-heroLine{ display:block; }
  .ff-body .ff-heroLead{ margin-top: var(--ff-3); }
  .ff-body .ff-heroName{ color: var(--ff-accent-text); }

  .ff-body .ff-heroCtas{ margin-top: var(--ff-4); display:grid; gap: var(--ff-2); }
  .ff-body .ff-heroCtas .ff-btn--primary{ align-items:flex-start; justify-content:flex-start; padding:12px 14px; }
  .ff-body .ff-heroCtas .ff-btn__sub{ margin-top:4px; }

  .ff-body .ff-hero__kpis{
    display:grid;
    gap: var(--ff-2);
    grid-template-columns: repeat(3, minmax(0,1fr));
    margin-top: var(--ff-4);
  }
  @media (max-width: 680px){ .ff-body .ff-hero__kpis{ grid-template-columns: 1fr; } }
  .ff-body .ff-kpiCard{ border-radius: var(--ff-r-3); border:1px solid var(--ff-outline); background: var(--ff-control-bg-soft); padding:12px; }
  .ff-body .ff-kpi__label{ margin:0; }
  .ff-body .ff-kpi__value{ margin:0; }

  .ff-body .ff-donorTicker{
    border:1px dashed var(--ff-outline);
    border-radius: var(--ff-r-2);
    padding:10px 12px;
    background: var(--ff-control-bg-soft);
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .ff-body .ff-ticker__track{ display:flex; flex-wrap:wrap; gap:8px; }

  .ff-body .ff-rail__track{
    margin-top: var(--ff-3);
    display:grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(160px, 1fr);
    gap: var(--ff-2);
    overflow-x:auto;
    padding-bottom:6px;
    scroll-snap-type: x mandatory;
    overscroll-behavior-x: contain;
    -webkit-overflow-scrolling: touch;
  }
  @media (min-width: 920px){ .ff-body .ff-rail__track{ grid-auto-columns: minmax(180px, 1fr); } }
  .ff-body .ff-railcard{
    position:relative;
    border-radius: var(--ff-r-4);
    border:1px solid var(--ff-outline);
    background: var(--ff-surface2);
    overflow: clip;
    box-shadow: var(--ff-shadow3);
    scroll-snap-align: start;
    min-height: 168px;
    display:grid;
    align-content:end;
  }
  .ff-body .ff-railcard__img{ width:100%; height:100%; object-fit: cover; aspect-ratio: 16/10; }
  .ff-body .ff-railcard__meta{
    position:absolute; inset:auto 0 0 0;
    padding:10px;
    background: linear-gradient(180deg, rgba(2,6,23,0), rgba(2,6,23,0.72));
    color: rgba(255,255,255,0.96);
    display:grid; gap:6px;
  }
  .ff-body .ff-railcard__chip{
    display:inline-flex;
    width: fit-content;
    padding:5px 8px;
    border-radius: var(--ff-r-pill);
    border:1px solid rgba(255,255,255,0.26);
    background: rgba(255,255,255,0.10);
    font-size:12px;
    font-weight: 860;
    letter-spacing: 0.01em;
  }
  .ff-body .ff-railcard__name{ font-weight:920; letter-spacing: var(--ff-track); line-height:1.1; text-shadow: 0 1px 10px rgba(0,0,0,0.35); }

  /* QR */
  .ff-body .ff-qr{ margin:0; display:grid; justify-items:start; gap:8px; }
  .ff-body .ff-qr__img{
    width:144px; height:144px;
    border-radius:16px;
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg-soft);
    box-shadow: var(--ff-shadow3);
    object-fit: contain;
  }

  /* Impact + tiers */
  .ff-body .ff-impactPick__chips{ list-style:none; padding:0; margin:0; display:flex; flex-wrap:wrap; gap: var(--ff-2); }
  .ff-body .ff-impactTierGrid{
    list-style:none; padding:0; margin:0;
    display:grid;
    gap: var(--ff-3);
    grid-template-columns: repeat(auto-fit, minmax(min(240px,100%), 1fr));
  }
  .ff-body .ff-impactTier{ border-radius: var(--ff-r-4); }
  .ff-body .ff-impactTier__head{ display:grid; gap:6px; }
  .ff-body .ff-impactTier__footer{ margin-top: var(--ff-2); display:flex; justify-content:flex-start; }

  /* Story */
  .ff-body .ff-storyGrid{
    display:grid;
    gap: var(--ff-4);
    grid-template-columns: 1fr;
    align-items:start;
    min-width:0;
  }
  @media (min-width: 980px){
    .ff-body .ff-storyGrid{ grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr); }
  }
  .ff-body .ff-storyPoster{
    position:relative;
    display:block;
    border-radius: var(--ff-r-4);
    overflow: clip;
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg-soft);
    box-shadow: var(--ff-shadow3);
  }
  .ff-body .ff-storyPoster__img{ width:100%; height:auto; display:block; }
  .ff-body .ff-storyPoster__overlay{
    position:absolute; inset:0;
    display:grid; place-items:center;
    background: radial-gradient(600px 340px at 50% 50%, rgba(2,6,23,0.35), rgba(2,6,23,0.72));
    color: rgba(255,255,255,0.96);
  }
  .ff-body .ff-storyPoster__play{
    width:64px; height:64px;
    border-radius: var(--ff-r-pill);
    display:grid; place-items:center;
    border:1px solid rgba(255,255,255,0.26);
    background: rgba(255,255,255,0.12);
    font-size:22px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.32);
  }
  .ff-body .ff-storyPoster__label{
    margin-top:10px;
    font-size:13px;
    font-weight: 900;
    letter-spacing: var(--ff-track-wide);
    text-transform: uppercase;
  }
  .ff-body .ff-storyList{ margin:0; padding-left: 18px; display:grid; gap:8px; }
  .ff-body .ff-quote{
    margin:0;
    border-left: 3px solid rgba(255,95,35,0.55);
    padding-left: 12px;
  }

  /* Teams */
  .ff-body .ff-teamGrid{
    list-style:none;
    padding:0;
    margin:0;
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(min(280px,100%), 1fr));
    gap: var(--ff-3);
  }
  .ff-body .ff-teamGrid--compact{ grid-template-columns: repeat(auto-fit, minmax(min(260px,100%), 1fr)); }
  .ff-body .ff-teamCard{ border-radius: var(--ff-r-4); }
  .ff-body .ff-teamCard.is-featured{ border-color: rgba(255,95,35,0.30); box-shadow: var(--ff-glow), var(--ff-shadow3); }
  .ff-body .ff-teamCard__inner{ display:flex; flex-direction:column; gap: var(--ff-2); min-height:0; }
  .ff-body .ff-teamCard__media{ margin:0; border-radius: var(--ff-r-3); overflow: clip; border:1px solid var(--ff-outline); background: var(--ff-control-bg-soft); }
  .ff-body .ff-teamCard__img{ width:100%; height:auto; display:block; aspect-ratio: 16/10; object-fit: cover; }
  .ff-body .ff-teamStats{ display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: var(--ff-2); margin:0; }
  .ff-body .ff-teamStat{ display:grid; gap:6px; padding:10px 12px; border-radius: var(--ff-r-3); border:1px solid var(--ff-outline); background: var(--ff-control-bg-soft); }
  .ff-body .ff-teamProgressWrap{ display:grid; gap:8px; }
  .ff-body .ff-teamProgress{ width:100%; height:10px; appearance:none; border-radius: var(--ff-r-pill); overflow: clip; }
  .ff-body .ff-teamProgress::-webkit-progress-bar{ background: rgba(15,23,42,0.12); }
  .ff-body .ff-teamProgress::-webkit-progress-value{ background: linear-gradient(90deg, rgba(99,102,241,0.82), rgba(52,211,153,0.72)); }
  .ff-body .ff-teamProgress::-moz-progress-bar{ background: linear-gradient(90deg, rgba(99,102,241,0.82), rgba(52,211,153,0.72)); }
  .ff-body .ff-teamsDisclosure{ margin-top: var(--ff-3); }

  /* Sponsors */
  .ff-body .ff-sponsorCard{
    border-radius: var(--ff-r-5);
    padding: var(--ff-density-pad);
    border:1px solid var(--ff-outline);
    background: var(--ff-glass);
    box-shadow: var(--ff-shadow2);
  }
  .ff-body .ff-sponsorWallHead{ margin-bottom: var(--ff-2); }
  .ff-body .ff-sponsorWall{
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap: var(--ff-2);
    padding:12px;
    border-radius: var(--ff-r-4);
    border:1px dashed var(--ff-outline);
    background: var(--ff-control-bg-soft);
    min-height:84px;
  }
  @media (max-width: 680px){ .ff-body .ff-sponsorWall{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
  @media (max-width: 420px){ .ff-body .ff-sponsorWall{ grid-template-columns: 1fr; } }
  .ff-body .ff-sponsorWall__item{ border-radius: var(--ff-r-3); min-height:38px; }

  .ff-body .ff-sponsorGrid{
    list-style:none; padding:0; margin: var(--ff-3) 0 0;
    display:grid; gap: var(--ff-3);
    grid-template-columns: repeat(auto-fit, minmax(min(240px,100%), 1fr));
  }
  .ff-body .ff-tierCard{
    border-radius: var(--ff-r-4);
    border:1px solid var(--ff-outline);
    background: var(--ff-surface2);
    box-shadow: var(--ff-shadow3);
    padding: 14px;
    display:flex;
    flex-direction:column;
    gap: 12px;
    min-height: 0;
  }
  .ff-body .ff-tierCard--recommended{
    border-color: rgba(255,95,35,0.34);
    box-shadow: var(--ff-glow), var(--ff-shadow3);
  }
  .ff-body .ff-tierCard--vip{
    border-color: rgba(99,102,241,0.34);
    box-shadow: 0 0 0 1px rgba(99,102,241,0.16), 0 18px 60px rgba(99,102,241,0.10), var(--ff-shadow3);
  }
  .ff-body .ff-tierHead{ display:flex; flex-direction:column; gap: 8px; }
  .ff-body .ff-tierTitleRow{ display:flex; align-items:center; justify-content:space-between; gap: 10px; }
  .ff-body .ff-tierName{ margin:0; font-size:16px; font-weight: 920; letter-spacing: var(--ff-track); }
  .ff-body .ff-tierPill{
    font-size:12px;
    font-weight: 900;
    padding: 6px 10px;
    border-radius: var(--ff-r-pill);
    border: 1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    white-space: nowrap;
  }
  .ff-body .ff-tierPrice{ margin:0; }
  .ff-body .ff-tierAmt{ font-weight: 920; }
  .ff-body .ff-tierSuffix{ opacity: 0.85; }
  .ff-body .ff-tierList{ margin:0; padding-left: 18px; display:grid; gap: 8px; }
  .ff-body .ff-tierFoot{ margin-top: auto; }

  .ff-body .ff-sponsorMeta{ margin-top: var(--ff-3); }

  /* Trust+FAQ section */
  .ff-body .ff-trust-faq{}
  .ff-body .ff-faqList{ }
  .ff-body .ff-faqItem{ }

  /* Toast host */
  .ff-body .ff-toasts{
    position: fixed;
    top: calc(10px + var(--ff-safe-t));
    left: 50%;
    transform: translateX(-50%);
    z-index: var(--ff-z-toast);
    width: min(520px, calc(100vw - (var(--ff-gutter) * 2)));
    display:grid;
    gap:10px;
    pointer-events:none;
  }
  .ff-body .ff-toasts:empty{ display:none; }
  .ff-body .ff-toast{
    pointer-events:auto;
    border-radius: var(--ff-r-4);
    border:1px solid var(--ff-outline);
    background: var(--ff-surface2);
    box-shadow: var(--ff-shadow2);
    padding:12px;
    display:grid;
    gap:6px;
  }

  /* Overlays (sheet/modal) — deterministic stacking */
  .ff-body .ff-sheet,
  .ff-body .ff-modal{
    position: fixed;
    inset: 0;
    z-index: var(--ff-z-overlay);
    display:none;
    place-items: center;
    padding: calc(14px + var(--ff-safe-t)) var(--ff-gutter) calc(14px + var(--ff-safe-b));
    pointer-events:none;
  }

  .ff-body .ff-sheet[hidden],
  .ff-body .ff-modal[hidden],
  .ff-body .ff-sheet[data-open="false"],
  .ff-body .ff-modal[data-open="false"],
  .ff-body .ff-sheet[aria-hidden="true"],
  .ff-body .ff-modal[aria-hidden="true"]{ display:none; }

  .ff-body .ff-sheet:target,
  .ff-body .ff-sheet.is-open,
  .ff-body .ff-sheet[data-open="true"],
  .ff-body .ff-sheet[aria-hidden="false"],
  .ff-body .ff-modal:target,
  .ff-body .ff-modal.is-open,
  .ff-body .ff-modal[data-open="true"],
  .ff-body .ff-modal[aria-hidden="false"]{ display:grid !important; pointer-events:auto; }

  .ff-body .ff-sheet__backdrop,
  .ff-body .ff-modal__backdrop{
    position:absolute;
    inset:0;
    background: rgba(2,6,23,0.66);
    pointer-events:auto;
    z-index: 0;
  }

  .ff-body .ff-sheet__panel,
  .ff-body .ff-modal__panel{
    position: relative;
    z-index: 1;
    pointer-events:auto;
    transform: translateY(6px) scale(0.99);
    opacity: 0.98;
    will-change: transform, opacity;
  }

  .ff-body .ff-sheet:target .ff-sheet__panel,
  .ff-body .ff-sheet.is-open .ff-sheet__panel,
  .ff-body .ff-sheet[data-open="true"] .ff-sheet__panel,
  .ff-body .ff-sheet[aria-hidden="false"] .ff-sheet__panel,
  .ff-body .ff-modal:target .ff-modal__panel,
  .ff-body .ff-modal.is-open .ff-modal__panel,
  .ff-body .ff-modal[data-open="true"] .ff-modal__panel,
  .ff-body .ff-modal[aria-hidden="false"] .ff-modal__panel{
    transform: translateY(0) scale(1);
    opacity: 1;
    transition: transform var(--ff-med) var(--ff-ease-2), opacity var(--ff-med) var(--ff-ease-2);
  }
  @media (prefers-reduced-motion: reduce){
    .ff-body .ff-sheet__panel, .ff-body .ff-modal__panel{ transform:none; opacity:1; }
    .ff-body .ff-sheet:target .ff-sheet__panel,
    .ff-body .ff-sheet.is-open .ff-sheet__panel,
    .ff-body .ff-sheet[data-open="true"] .ff-sheet__panel,
    .ff-body .ff-sheet[aria-hidden="false"] .ff-sheet__panel,
    .ff-body .ff-modal:target .ff-modal__panel,
    .ff-body .ff-modal.is-open .ff-modal__panel,
    .ff-body .ff-modal[data-open="true"] .ff-modal__panel,
    .ff-body .ff-modal[aria-hidden="false"] .ff-modal__panel{ transition:none; }
  }

  /* Checkout sheet panel sizing + scrolling contract */
  .ff-body .ff-sheet__panel{
    width: min(740px, 100%);
    max-height: min(86dvh, 860px);
    border-radius: var(--ff-r-5);
    overflow:hidden;
    border:1px solid var(--ff-outline);
    background: var(--ff-surface2);
    box-shadow: var(--ff-shadow);
    display:flex;
    flex-direction:column;
    min-height:0;
  }
  @media (max-width: 560px){
    .ff-body .ff-sheet{ place-items: end center; }
    .ff-body .ff-sheet__panel{
      width:100%;
      max-height: min(92dvh, 920px);
      border-bottom-left-radius:0;
      border-bottom-right-radius:0;
    }
  }

  .ff-body .ff-sheet__viewport{ flex:1 1 auto; min-height:0; overflow:hidden; display:flex; flex-direction:column; }
  .ff-body .ff-sheet__content{ flex:1 1 auto; min-height:0; overflow:auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; }
  .ff-body .ff-sheet__scroll{ min-height:0; }
  .ff-body .ff-sheet__header{ flex:0 0 auto; position: sticky; top:0; z-index: 2; background: var(--ff-surface2); border-bottom: 1px solid var(--ff-outline); }
  .ff-body .ff-sheet__footer{ flex:0 0 auto; }

  .ff-body .ff-sheet--checkout .ff-checkoutShell{ flex:1 1 auto; min-height:0; display:flex; flex-direction:column; overflow:hidden; }
  .ff-body .ff-sheet--checkout .ff-sheet__content{ padding: var(--ff-density-pad); padding-bottom: max(10px, var(--ff-safe-b)); }
  .ff-body .ff-sheet--checkout .ff-sheet__footer{
    position: sticky;
    bottom: 0;
    z-index: 2;
    padding: 10px var(--ff-density-pad) max(12px, var(--ff-safe-b));
    border-top: 1px solid var(--ff-outline);
    background: var(--ff-surface2);
  }

  /* Modals */
  .ff-body .ff-modal__panel{
    width: min(720px, 100%);
    max-height: min(86dvh, 860px);
    border-radius: var(--ff-r-5);
    overflow:hidden;
    border:1px solid var(--ff-outline);
    background: var(--ff-surface2);
    box-shadow: var(--ff-shadow);
    padding: var(--ff-density-pad);
    display:flex;
    flex-direction:column;
    min-height:0;
  }
  .ff-body .ff-modal__panel--video{ width: min(920px, 100%); }
  .ff-body .ff-modal__head{ display:flex; align-items:flex-start; justify-content:space-between; gap:12px; min-width:0; }
  .ff-body .ff-modal__title{ margin:0; font-size:20px; font-weight:900; letter-spacing:-0.01em; }
  .ff-body .ff-modal__body{ flex:1 1 auto; min-height:0; overflow:auto; padding-right:2px; }

  .ff-body .ff-modal__foot--sticky{
    position: sticky;
    bottom: 0;
    z-index: 2;
    padding-top: var(--ff-2);
    margin-top: var(--ff-2);
    border-top: 1px solid var(--ff-outline);
    background: var(--ff-surface2);
  }

  .ff-body .ff-videoFrame{
    border-radius: var(--ff-r-4);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    padding:12px;
    min-height: 220px;
    display:grid;
    place-items:center;
    overflow:hidden;
  }

  .ff-body .ff-paymentMount,
  .ff-body .ff-paypalMount{
    border-radius: var(--ff-r-4);
    border:1px solid var(--ff-outline);
    background: var(--ff-control-bg);
    padding:12px;
    min-height: 74px;
    display:grid;
    place-items:center;
    overflow:hidden;
  }
  .ff-body .ff-skeleton--payment{ min-height: 54px; border-radius: var(--ff-r-2); }
  .ff-body .ff-skeleton--video{ min-height: 220px; border-radius: var(--ff-r-3); }

  /* Tabs */
  .ff-body .ff-tabs{
    position: fixed;
    left:0; right:0; bottom:0;
    z-index: var(--ff-z-tabs);
    padding: 10px var(--ff-gutter) calc(10px + var(--ff-safe-b));
    pointer-events:none;
  }
  @media (min-width: 920px){ .ff-body .ff-tabs{ display:none; } }
  .ff-body .ff-tabs__scroller{
    pointer-events:auto;
    border-radius: var(--ff-r-5);
    border:1px solid var(--ff-outline);
    background: var(--ff-glass);
    box-shadow: var(--ff-shadow2);
    padding:8px;
    overflow-x:auto;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-x: contain;
  }
  .ff-body .ff-tabs__list{ list-style:none; margin:0; padding:0; display:flex; gap:8px; align-items:center; }
  .ff-body .ff-tab{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-height:40px;
    padding:10px 12px;
    border-radius: var(--ff-r-pill);
    border:1px solid transparent;
    background: rgba(255,255,255,0.08);
    color: var(--ff-text);
    font-weight: 900;
    font-size:13px;
    letter-spacing:-0.01em;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
    pointer-events:auto;
  }
  @media (hover:hover) and (pointer:fine){
    .ff-body .ff-tab:hover{ border-color: var(--ff-outline); background: var(--ff-control-bg-hover); box-shadow: var(--ff-shadow3); }
  }
  .ff-body .ff-tab--cta{
    background: linear-gradient(180deg, rgba(255,95,35,0.98), rgba(255,95,35,0.84));
    border-color: rgba(255,95,35,0.62);
    color: var(--ff-accent-ink);
    box-shadow: 0 10px 22px rgba(255,95,35,0.22);
  }

  /* Back to top */
  .ff-body .ff-backtotop{
    position: fixed;
    right: var(--ff-gutter);
    bottom: calc(84px + var(--ff-safe-b));
    z-index: var(--ff-z-backtotop);
    border-radius: var(--ff-r-pill);
    border:1px solid var(--ff-outline);
    background: var(--ff-glass);
    box-shadow: var(--ff-shadow3);
    padding:10px 12px;
    display:inline-flex;
    align-items:center;
    gap:8px;
    font-weight: 900;
    font-size: 13px;
    pointer-events:auto;
  }
  @media (min-width: 920px){ .ff-body .ff-backtotop{ bottom: calc(18px + var(--ff-safe-b)); } }
  @media (max-width: 420px){ .ff-body .ff-backtotop__text{ display:none; } }

  /* Footer */
  .ff-body .ff-footer{ padding-top:0; padding-bottom: calc(14px + var(--ff-safe-b)); }
  @media (min-width: 920px){ .ff-body .ff-footer{ padding-bottom:22px; } }
  .ff-body .ff-footerTray{ border-radius: var(--ff-r-5); padding:12px; box-shadow: var(--ff-shadow2); }
  .ff-body .ff-footer__grid{
    display:grid;
    gap: var(--ff-4);
    grid-template-columns: 1fr;
    margin-top: var(--ff-3);
  }
  @media (min-width: 920px){
    .ff-body .ff-footer__grid{ grid-template-columns: minmax(0, 1fr) minmax(0, 0.7fr); }
  }
  .ff-body .ff-footer__linkgrid{ list-style:none; padding:0; margin:0; display:grid; gap: 10px; }
  .ff-body .ff-footer__link{ color: var(--ff-link); text-decoration: none !important; font-weight: 820; }
  .ff-body .ff-footer__link:hover{ text-decoration: underline !important; text-decoration-color: var(--ff-link-underline); }
}

/* ============================================================================
FF_CHECKOUT_OVERLAY_CONTRACT_V1 (Playwright-safe)
Fixes:
- Close button must be topmost clickable target (no layer intercept)
- Backdrop below panel; panel remains interactive (NO pointer-events:none)
Scope: #checkout only
============================================================================ */

.ff-body #checkout.ff-sheet,
.ff-body #checkout[data-ff-checkout-sheet]{
  position: fixed !important;
  inset: 0 !important;
  isolation: isolate !important;
}

/* Backdrop: clickable but ALWAYS below panel */
.ff-body #checkout :where(.ff-sheet__backdrop, a.ff-sheet__backdrop, .ff-sheet__backdrop--flagship, .ff-modal__backdrop, .ff-overlay__backdrop, [data-ff-backdrop], .ff-backdrop){
  position: absolute !important;
  inset: 0 !important;
  z-index: 0 !important;
  pointer-events: auto !important;
}

/* Panel: above backdrop, interactive */
.ff-body #checkout :where(.ff-sheet__panel, .ff-sheet__panel--flagship){
  position: relative !important;
  z-index: 1 !important;
  pointer-events: auto !important;
}

/* Header stays above panel content */
.ff-body #checkout :where(.ff-sheet__header, .ff-sheet__head){
  position: sticky !important;
  top: 0 !important;
  z-index: 2 !important;
  pointer-events: auto !important;
}

/* Close button must ALWAYS win hit-testing */
.ff-body #checkout :where(
  button[data-ff-close-checkout],
  [data-ff-close-checkout],
  .ff-sheet__close,
  .ff-close,
  [data-ff-close],
  button[aria-label="Close"],
  a[aria-label="Close"]
){
  position: relative !important;
  z-index: 2147483647 !important;
  pointer-events: auto !important;
  touch-action: manipulation !important;
}

/* Kill click-stealing decorative pseudos */
.ff-body #checkout :where(
  .ff-sheet__panel,
  .ff-sheet__header,
  .ff-sheet__viewport,
  .ff-sheet__content,
  .ff-sheet__scroll,
  .ff-checkoutShell,
  .ff-checkoutBody,
  .ff-glass,
  .ff-surface,
  .ff-card
)::before,
.ff-body #checkout :where(
  .ff-sheet__panel,
  .ff-sheet__header,
  .ff-sheet__viewport,
  .ff-sheet__content,
  .ff-sheet__scroll,
  .ff-checkoutShell,
  .ff-checkoutBody,
  .ff-glass,
  .ff-surface,
  .ff-card
)::after{
  pointer-events: none !important;
}

/* Keep scroll contract sane */
.ff-body #checkout :where(.ff-sheet__viewport, [data-ff-checkout-viewport]){ min-height: 0 !important; }
.ff-body #checkout :where(.ff-sheet__content, [data-ff-checkout-content]){ min-height: 0 !important; }
.ff-body #checkout :where(.ff-sheet__scroll, [data-ff-checkout-scroll]){
  min-height: 0 !important;
  overflow: auto !important;
  -webkit-overflow-scrolling: touch !important;
  overscroll-behavior: contain !important;
}

/* ============================================================================
UTILITIES (including hook/ID/attr stubs so audits can be green without _auto_stubs)
============================================================================ */
@layer ff.utilities{
  .ff-body .ff-m-0{ margin:0 !important; }
  .ff-body .ff-mt-1{ margin-top: var(--ff-1) !important; }
  .ff-body .ff-mt-2{ margin-top: var(--ff-2) !important; }
  .ff-body .ff-mt-3{ margin-top: var(--ff-3) !important; }
  .ff-body .ff-mt-4{ margin-top: var(--ff-4) !important; }
  .ff-body .ff-mt-5{ margin-top: var(--ff-5) !important; }
  .ff-body .ff-mb-0{ margin-bottom:0 !important; }

  .ff-body .ff-gap-0{ gap:0 !important; }
  .ff-body .ff-gap-2{ gap: var(--ff-2) !important; }
  .ff-body .ff-gap-3{ gap: var(--ff-3) !important; }

  .ff-body .ff-link{ color: var(--ff-link); }
  .ff-body .ff-hidden{ display:none !important; }
  .ff-body .ff-minw-0{ min-width:0 !important; }
  .ff-body .ff-w-100{ width:100% !important; }
  .ff-body .ff-nowrap{ white-space:nowrap !important; }

  .ff-body .ff-truncate{ overflow:hidden !important; text-overflow:ellipsis !important; white-space:nowrap !important; }

  .ff-body [hidden]{ display:none !important; }
  .ff-body [aria-disabled="true"]{ opacity:0.72; pointer-events:none; }

  /* Playwright-safe checkout stacking hardening (scoped and minimal) */
  .ff-body #checkout .ff-sheet__backdrop,
  .ff-body #checkout .ff-sheet__backdrop--flagship{
    z-index: 0 !important;
    pointer-events: auto !important;
  }
  .ff-body #checkout .ff-sheet__panel,
  .ff-body #checkout .ff-sheet__panel--flagship{
    z-index: 1 !important;
    pointer-events: auto !important;
  }
  .ff-body #checkout .ff-sheet__header{ position: relative !important; z-index: 2 !important; }
  .ff-body #checkout button[data-ff-close-checkout]{ position: relative !important; z-index: 3 !important; }

  /* Payment mounts must be visible once checkout is open (don’t fight [hidden] globally) */
  .ff-body #checkout:target .ff-paymentMount,
  .ff-body #checkout:target .ff-paypalMount,
  .ff-body .ff-sheet[data-open="true"] .ff-paymentMount,
  .ff-body .ff-sheet[aria-hidden="false"] .ff-paymentMount,
  .ff-body .ff-sheet[data-open="true"] .ff-paypalMount,
  .ff-body .ff-sheet[aria-hidden="false"] .ff-paypalMount{
    display: grid;
    visibility: visible;
    opacity: 1;
  }

  /* Optional burst hook */
  .ff-body .ff-burst{ position: fixed; inset: 0; pointer-events:none; z-index: calc(var(--ff-z-toast) + 1); }
  /* audit stubs (harmless) */
.ff-body .ff-heroMedia{}
.ff-body .ff-progress{}
.ff-body .ff-storyCard{}

.ff-body #cardPayLegend{}
.ff-body #sponsorInterestDesc{}
.ff-body #sponsorInterestTitle{}
.ff-body #sponsorInterestTrust{}
.ff-body #trust-faq{}
.ff-body #trustFaqLead{}
.ff-body #trustFaqTitle{}

  /* --------------------------------------------------------------------------
     Hook-alias + audit-parity stubs (IDs + data-ff attrs used by index.html)
     Keep these extremely light; visuals come from class system above.
  -------------------------------------------------------------------------- */

  /* IDs referenced in template (kept for audits / deterministic hooks) */
  .ff-body #ffLive{}
  .ff-body #ffSelectors{}
  .ff-body #ffVideoTitle{}
  .ff-body #progressLead{}
  .ff-body #progressTitle{}
  .ff-body #heroTitle{}
  .ff-body #heroLead{}
  .ff-body #trustUseFunds{}
  .ff-body #trustReceipts{}
  .ff-body #trustRefunds{}
  .ff-body #tierCommunityName{}
  .ff-body #tierPartnerName{}

  /* data-ff attribute selectors referenced in template/JS */
  .ff-body [data-ff-announce]{}
  .ff-body [data-ff-brand]{}
  .ff-body [data-ff-checkout-scroll]{}
  .ff-body [data-ff-checkout-status]{}
  .ff-body [data-ff-data-mode]{}
  .ff-body [data-ff-donor-name]{}
  .ff-body [data-ff-donor-ticker]{}
  .ff-body [data-ff-email]{}
  .ff-body [data-ff-hero-capsule]{}
  .ff-body [data-ff-id]{}
  .ff-body [data-ff-impact-activity]{}
  .ff-body [data-ff-live]{}
  .ff-body [data-ff-match-meta]{}
  .ff-body [data-ff-match-state]{}
  .ff-body [data-ff-open-checkout]{}
  .ff-body [data-ff-open-drawer]{}
  .ff-body [data-ff-open-sponsor]{}
  .ff-body [data-ff-qr]{}
  .ff-body [data-ff-section]{}
  .ff-body [data-ff-share]{}
  .ff-body [data-ff-ticker]{}
  .ff-body [data-ff-tier]{}
  .ff-body [data-ff-video-frame]{}
  .ff-body [data-ff-video-modal]{}
  .ff-body [data-ff-sponsor-modal]{}
  .ff-body [data-ff-drawer]{}
  .ff-body [data-ff-toasts]{}

  @media print{
    .ff-body :where(.ff-tabs,.ff-backtotop,.ff-toasts,.ff-drawer,.ff-sheet,.ff-modal){ display:none !important; }
    .ff-body{ background: rgb(255,255,255) !important; color: rgb(0,0,0) !important; }
    .ff-body .ff-section{ content-visibility: visible !important; }
  }

  .ff-body .ff-checkoutShell--flagship{}

/* [ff-css] MISSING_SELECTORS_SHIM v1 */
  /* Auto-generated selector presence shim to satisfy UI/UX gate.
     This does NOT change styling unless you add declarations later. */
  .ff-body :where(
      .ff-backtotop--flagship,
      .ff-backtotop__icon,
      .ff-callout,
      .ff-callout--flagship,
      .ff-checkoutBody--flagship,
      .ff-checkoutHead,
      .ff-checkoutHead--flagship,
      .ff-checkoutSuccess,
      .ff-disclosure--flagship,
      .ff-drawer__block,
      .ff-faqList--compact,
      .ff-fieldset,
      .ff-footer__linkgrid--compact,
      .ff-footerBrand--compact,
      .ff-footerBrand--flagship,
      .ff-footerGrid--compact,
      .ff-footerGrid--flagship,
      .ff-footerGrid--tight,
      .ff-footerNav--compact,
      .ff-footerTray--compact,
      .ff-footerTrust,
      .ff-hero__kpis--flagship,
      .ff-hero__shell,
      .ff-heroAccent,
      .ff-heroCtas--flagship,
      .ff-heroMedia--flagship,
      .ff-heroPanel--flagship,
      .ff-heroPanelHead,
      .ff-heroPowered,
      .ff-impact,
      .ff-impactCard--flagship,
      .ff-impactPick,
      .ff-impactPick--flagship,
      .ff-impactPick__chips--flagship,
      .ff-impactTier--flagship,
      .ff-impactTierGrid--flagship,
      .ff-kpi,
      .ff-main,
      .ff-modal--compact,
      .ff-modal--flagship,
      .ff-modal--video,
      .ff-modal__backdrop--flagship,
      .ff-modal__foot--flagship,
      .ff-modal__head--flagship,
      .ff-modal__panel--flagship,
      .ff-nav--pill,
      .ff-paymentMount--flagship,
      .ff-paypalMount--flagship,
      .ff-pill--verified,
      .ff-platformBrand--mark,
      .ff-poweredby,
      .ff-rail__item,
      .ff-rail__track--flagship,
      .ff-sectionhead--flagship,
      .ff-sectionhead__text,
      .ff-sheet--flagship,
      .ff-sheet__footer--sticky,
      .ff-sheet__scroll--flagship,
      .ff-sheet__viewport--flagship,
      .ff-skiplink
    ){}
  .ff-body :where(
      .ff-sponsorCell,
      .ff-sponsors,
      .ff-sponsorWallBlock,
      .ff-story,
      .ff-storyCopy,
      .ff-storyMedia,
      .ff-storyMeta,
      .ff-tab--pill,
      .ff-tabs--flagship,
      .ff-tabs__item,
      .ff-tabs__list--flagship,
      .ff-tabs__scroller--flagship,
      .ff-teams,
      .ff-themeToggle,
      .ff-topbar__brandCluster,
      .ff-topbar__capsule--flagship,
      .ff-topbar__rightCluster,
      .ff-topbarBrand--flagship,
      .ff-topbarBrand__pill,
      .ff-vipSpotlight
    ){}
  .ff-body :where(
      #checkoutDesc,
      #checkoutErrorText,
      #checkoutTitle,
      #drawer,
      #ffDrawerPanel,
      #ffDrawerTitle,
      #ffSuccessDesc,
      #ffSuccessTitle,
      #ffTopbar,
      #heroAccentLine,
      #heroPanelProgressText,
      #heroPanelTitle,
      #heroRailDesc,
      #heroRailTitle,
      #progress,
      #sponsor-interest,
      #sponsorEmailHelp,
      #sponsors,
      #sponsorsLead,
      #sponsorsTitle,
      #tierChampionBullets,
      #tierChampionName,
      #tierCommunityBullets,
      #tierPartnerBullets,
      #tierVipBullets,
      #tierVipName
    ){}
  .ff-body :where(
      [data-ff-amount],
      [data-ff-amount-input],
      [data-ff-backtotop],
      [data-ff-checkout-error],
      [data-ff-checkout-stage],
      [data-ff-checkout-success],
      [data-ff-chrome],
      [data-ff-chrome-stack],
      [data-ff-close-drawer],
      [data-ff-close-sponsor],
      [data-ff-close-video],
      [data-ff-deadline],
      [data-ff-donate-form],
      [data-ff-footer],
      [data-ff-footer-trust],
      [data-ff-goal],
      [data-ff-hero-panel],
      [data-ff-hero-rail],
      [data-ff-home],
      [data-ff-main],
      [data-ff-message],
      [data-ff-meter],
      [data-ff-open-video],
      [data-ff-payment-element],
      [data-ff-paypal-error],
      [data-ff-paypal-mount],
      [data-ff-paypal-msg],
      [data-ff-paypal-skeleton],
      [data-ff-pct],
      [data-ff-player-id],
      [data-ff-rail-cols],
      [data-ff-raised],
      [data-ff-scrollbar],
      [data-ff-shell],
      [data-ff-sponsor-a-player],
      [data-ff-sponsor-amount],
      [data-ff-sponsor-card],
      [data-ff-sponsor-email],
      [data-ff-sponsor-error],
      [data-ff-sponsor-message],
      [data-ff-sponsor-name],
      [data-ff-sponsor-status],
      [data-ff-sponsor-submit],
      [data-ff-sponsor-tier],
      [data-ff-sponsor-wall],
      [data-ff-story],
      [data-ff-story-sr],
      [data-ff-stripe-error],
      [data-ff-stripe-mount],
      [data-ff-stripe-msg],
      [data-ff-stripe-skeleton],
      [data-ff-tabs],
      [data-ff-team-id],
      [data-ff-theme-toggle],
      [data-ff-ticker-track],
      [data-ff-topbar],
      [data-ff-video-sr],
      [data-ff-video-src],
      [data-ff-video-title],
      [data-ff-vip-spotlight]
    ){}
  /* [ff-css] MISSING_SELECTORS_SHIM v1 END */
}

/* EOF: app/static/css/ff.css */


/* ============================================================================
FF HOTFIX (overlay hit-testing): checkout backdrop must NEVER intercept UI
- Fixes: close button + amount chips unclickable due to backdrop or root intercept
- Strategy:
  * #checkout: pointer-events:none (cannot intercept)
  * panel + backdrop: pointer-events:auto
  * panel above backdrop via z-index
  * kill pointer-events on pseudo-elements that might cover UI
============================================================================ */

.ff-body #checkout.ff-sheet,
.ff-body #checkout.ff-sheet--checkout,
.ff-body #checkout[data-ff-checkout-sheet] {
  isolation: isolate !important;
  pointer-events: none !important;
}

/* Backdrop: receives clicks, but must sit BELOW the panel */
.ff-body #checkout .ff-sheet__backdrop,
.ff-body #checkout a.ff-sheet__backdrop {
  position: fixed !important;
  inset: 0 !important;
  z-index: 0 !important;
  pointer-events: auto !important;
}

/* Panel: interactive content ABOVE backdrop */
.ff-body #checkout .ff-sheet__panel {
  position: fixed !important;
  inset: 0 !important;
  z-index: 2 !important;
  pointer-events: auto !important;
}

/* Ensure interior stays interactive */
.ff-body #checkout .ff-sheet__viewport,
.ff-body #checkout .ff-sheet__content,
.ff-body #checkout .ff-sheet__scroll,
.ff-body #checkout .ff-checkoutShell,
.ff-body #checkout .ff-checkoutBody,
.ff-body #checkout form,
.ff-body #checkout input,
.ff-body #checkout button,
.ff-body #checkout a {
  pointer-events: auto !important;
}
/* ===== overlay z-index / pointer-events fixes ===== */
.ff-root {
  /* provide a sane default if tokens are missing */
  --ff-z-overlay: 1000;
}

/* backdrop sits below the panel, receives clicks */
.ff-sheet__backdrop {
  position: fixed;
  inset: 0;
  z-index: calc(var(--ff-z-overlay) + 10);
  pointer-events: auto; /* important so clicks register */
  -webkit-tap-highlight-color: transparent;
}

/* sheet panel sits above backdrop */
.ff-sheet__panel,
[data-ff-checkout-sheet] .ff-sheet__panel {
  position: fixed; /* or keep current positioning — preserve contract */
  z-index: calc(var(--ff-z-overlay) + 20);
  pointer-events: auto;
}

/* close button must be above panel content */
.ff-sheet__close,
[data-ff-checkout-sheet] .ff-sheet__close {
  z-index: calc(var(--ff-z-overlay) + 30);
  position: relative; /* ensure z-index applies within stacking context */
}

/* ensure when sheet is "closed" it's logically hidden */
[data-ff-checkout-sheet][hidden] {
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}
/* Close button must be above everything in the header */
.ff-body #checkout .ff-sheet__header {
  position: relative !important;
  z-index: 3 !important;
}
.ff-body #checkout button[data-ff-close-checkout] {
  position: relative !important;
  z-index: 4 !important;
}

/* If any pseudo overlays exist, they must NOT steal clicks */
.ff-body #checkout::before,
.ff-body #checkout::after,
.ff-body #checkout .ff-sheet__panel::before,
.ff-body #checkout .ff-sheet__panel::after,
.ff-body #checkout .ff-sheet__viewport::before,
.ff-body #checkout .ff-sheet__viewport::after {
  pointer-events: none !important;
}

/* ============================================================================
FF_POLISH_CONVERSION_V1
- Subtle affordances that increase donation confidence
============================================================================ */

/* Amount chips feel more "pressable" */
.ff-body .ff-chip--impact {
  transition: transform var(--ff-fast) var(--ff-ease),
              box-shadow var(--ff-fast) var(--ff-ease),
              border-color var(--ff-fast) var(--ff-ease);
}
.ff-body .ff-chip--impact:active {
  transform: translateY(1px) scale(0.99);
}

/* Checkout primary CTA gets extra gravity */
.ff-body .ff-sheet--checkout .ff-btn--primary {
  box-shadow:
    0 14px 34px rgba(255,95,35,0.28),
    inset 0 1px 0 rgba(255,255,255,0.35);
}

/* Trust text readability bump */
.ff-body .ff-trust-faq,
.ff-body .ff-help {
  font-size: 13.5px;
}

/* ============================================================================
FF_LIVE_SIGNALING_V1
- Makes the page feel alive without lying
============================================================================ */

.ff-body [data-ff-live]::after {
  content: "LIVE";
  margin-left: 6px;
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 900;
  border-radius: var(--ff-r-pill);
  background: rgba(22,101,52,0.16);
  border: 1px solid rgba(22,101,52,0.32);
  color: var(--ff-text);
}

/* ============================================================================
FF_SPONSOR_PRESTIGE_V1
============================================================================ */

.ff-body .ff-tierCard--vip {
  background:
    linear-gradient(180deg, rgba(99,102,241,0.08), transparent),
    var(--ff-surface2);
}

.ff-body .ff-tierCard--recommended::before {
  content: "Popular";
  align-self: flex-start;
  margin-bottom: 4px;
  font-size: 11px;
  font-weight: 900;
  letter-spacing: var(--ff-track-wide);
  text-transform: uppercase;
  color: var(--ff-accent-text);
}

/* ============================================================================
FF_MOBILE_CHECKOUT_COMFORT_V1
============================================================================ */

@media (max-width: 560px){
  .ff-body .ff-sheet--checkout .ff-btn--primary {
    min-height: 52px;
    font-size: 16px;
  }

  .ff-body .ff-sheet--checkout .ff-input--amount {
    font-size: 18px;
  }
}

/* ============================================================================
  FF CONTRAST RESCUE (v1)
  - Fix primary button + rail chip contrast in light/dark.
  - Hook-safe: no renames, only overrides.
============================================================================ */

@layer ff.controls {
  /* ---- PRIMARY BUTTONS: force correct bg/fg pairing ---- */
  .ff-body :where(a.ff-btn.ff-btn--primary, button.ff-btn.ff-btn--primary) {
    background: var(--ff-accent-cta, #c2410c) !important;
    border-color: rgba(255, 255, 255, 0.18) !important;
    color: var(--ff-on-accent, #fff) !important;
  }

  .ff-body :where(a.ff-btn.ff-btn--primary, button.ff-btn.ff-btn--primary) :where(.ff-btn__label, .ff-btn__meta, .ff-btn__sub, span) {
    color: inherit !important;
  }

  .ff-body :where(a.ff-btn.ff-btn--primary, button.ff-btn.ff-btn--primary):where(:hover, :focus-visible) {
    filter: brightness(1.05) saturate(1.02);
  }

  /* ---- HERO RAIL CHIP: fix white-on-white / black-on-black ---- */
  .ff-body .ff-railcard__chip {
    background: rgba(10, 13, 20, 0.08) !important;
    color: rgba(10, 13, 20, 0.92) !important;
    border: 1px solid rgba(10, 13, 20, 0.12) !important;
  }

  /* Dark theme chip overrides (supports multiple theme conventions) */
  .ff-root[data-ff-theme="dark"] .ff-body .ff-railcard__chip,
  .ff-root[data-theme="dark"] .ff-body .ff-railcard__chip,
  .ff-root.dark .ff-body .ff-railcard__chip {
    background: rgba(255, 255, 255, 0.10) !important;
    color: rgba(255, 255, 255, 0.92) !important;
    border-color: rgba(255, 255, 255, 0.14) !important;
  }
}

/* ============================================================================
  FF OVERLAY HIT-TARGET RESCUE (v1)
  - Ensures checkout close button is topmost clickable target.
  - Prevents overlay pseudo/decor layers from intercepting clicks.
============================================================================ */

@layer ff.controls {
  /* Create predictable stacking context for overlays/sheets */
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) {
    position: relative;
    isolation: isolate;
  }

  /* Backdrops should NEVER sit above close buttons */
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-backdrop, .ff-overlay__backdrop, .ff-modal__backdrop, [data-ff-backdrop]) {
    pointer-events: auto;
    z-index: 0;
  }

  /* Prevent decorative pseudo elements from intercepting clicks */
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  )::before,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  )::after,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-glass, .ff-surface)::before,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-glass, .ff-surface)::after {
    pointer-events: none;
  }

  /* Make close button always topmost & clickable */
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(
    .ff-close,
    .ff-overlay__close,
    .ff-modal__close,
    .ff-sheet__close,
    [data-ff-close],
    a[aria-label="Close"],
    button[aria-label="Close"]
  ) {
    position: relative;
    z-index: 50;
    pointer-events: auto;
    touch-action: manipulation;
  }

  /* If the close button sits inside a header/topbar, make that header not sit under an intercepting layer */
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(header, .ff-header, .ff-sheet__head, .ff-modal__head, .ff-overlay__head) {
    position: relative;
    z-index: 40;
  }
}

/* EOF: FF OVERLAY HIT-TARGET RESCUE */

/* EOF: FF CONTRAST RESCUE */

/* ============================================================================
  FF OVERLAY HIT-TARGET RESCUE (v1)
  - Ensures checkout close button is topmost clickable target.
  - Prevents overlay pseudo/decor layers from intercepting clicks.
============================================================================ */

@layer ff.controls {
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) {
    position: relative;
    isolation: isolate;
  }

  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-backdrop, .ff-overlay__backdrop, .ff-modal__backdrop, [data-ff-backdrop]) {
    pointer-events: auto;
    z-index: 0;
  }

  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  )::before,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  )::after,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-glass, .ff-surface)::before,
  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(.ff-glass, .ff-surface)::after {
    pointer-events: none;
  }

  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(
    .ff-close,
    .ff-overlay__close,
    .ff-modal__close,
    .ff-sheet__close,
    [data-ff-close],
    a[aria-label="Close"],
    button[aria-label="Close"]
  ) {
    position: relative;
    z-index: 50;
    pointer-events: auto;
    touch-action: manipulation;
  }

  .ff-body :where(
    #checkout,
    [data-ff-overlay],
    .ff-overlay,
    .ff-sheet,
    .ff-modal
  ) :where(header, .ff-header, .ff-sheet__head, .ff-modal__head, .ff-overlay__head) {
    position: relative;
    z-index: 40;
  }
}

/* EOF: FF OVERLAY HIT-TARGET RESCUE */

/* ============================================================================
FF_CHECKOUT_TOPMOST_HARDEN_V2 (Playwright gate fix)
- Guarantees: close button is topmost clickable target
- Fixes: any earlier pointer-events:none on #checkout or overlay wrappers
- Scope: #checkout only
============================================================================ */

@layer ff.controls {
  /* Never allow checkout root to be non-interactive */
  .ff-body :where(#checkout, #checkout.ff-sheet, #checkout[data-ff-checkout-sheet]) {
    pointer-events: auto !important;
    isolation: isolate !important;
    position: fixed !important;
    inset: 0 !important;
  }

  /* Backdrop stays below panel */
  .ff-body #checkout :where(.ff-sheet__backdrop, a.ff-sheet__backdrop, .ff-sheet__backdrop--flagship, .ff-modal__backdrop, .ff-overlay__backdrop, [data-ff-backdrop], .ff-backdrop) {
    position: fixed !important;
    inset: 0 !important;
    z-index: 0 !important;
    pointer-events: auto !important;
  }

  /* Panel above backdrop */
  .ff-body #checkout :where(.ff-sheet__panel, .ff-sheet__panel--flagship) {
    position: relative !important;
    z-index: 1 !important;
    pointer-events: auto !important;
  }

  /* Header above panel content */
  .ff-body #checkout :where(.ff-sheet__header, .ff-sheet__head) {
    position: sticky !important;
    top: 0 !important;
    z-index: 2 !important;
    pointer-events: auto !important;
  }

  /* Close button must always win hit-testing */
  .ff-body #checkout :where(
    button[data-ff-close-checkout],
    [data-ff-close-checkout],
    .ff-sheet__close,
    .ff-close,
    [data-ff-close],
    button[aria-label="Close"],
    a[aria-label="Close"]
  ) {
    position: relative !important;
    z-index: 2147483647 !important;
    pointer-events: auto !important;
    touch-action: manipulation !important;
  }

  /* Kill any click-stealing decorative pseudos inside checkout */
  .ff-body #checkout :where(
    .ff-sheet__panel,
    .ff-sheet__header,
    .ff-sheet__viewport,
    .ff-sheet__content,
    .ff-sheet__scroll,
    .ff-checkoutShell,
    .ff-checkoutBody,
    .ff-glass,
    .ff-surface,
    .ff-card
  )::before,
  .ff-body #checkout :where(
    .ff-sheet__panel,
    .ff-sheet__header,
    .ff-sheet__viewport,
    .ff-sheet__content,
    .ff-sheet__scroll,
    .ff-checkoutShell,
    .ff-checkoutBody,
    .ff-glass,
    .ff-surface,
    .ff-card
  )::after {
    pointer-events: none !important;
  }
}


/* Ensure checkout backdrop is visible whenever checkout is open */
.ff-body #checkout:where(:target, .is-open, [data-open="true"], [aria-hidden="false"]) .ff-sheet__backdrop,
.ff-body #checkout:where(:target, .is-open, [data-open="true"], [aria-hidden="false"]) a.ff-sheet__backdrop{
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* Override accidental hidden attr on backdrop while open */
.ff-body #checkout:where(:target, .is-open, [data-open="true"], [aria-hidden="false"]) .ff-sheet__backdrop[hidden],
.ff-body #checkout:where(:target, .is-open, [data-open="true"], [aria-hidden="false"]) a.ff-sheet__backdrop[hidden]{
  display: block !important;
}

/* ============================================================================
   FF_OVERLAY_HIDDEN_OVERRIDE_V1
   Contract: [hidden] ALWAYS means hidden (even if :target)
============================================================================ */
.ff-body .ff-sheet[hidden],
.ff-body .ff-modal[hidden],
.ff-body .ff-sheet:target[hidden],
.ff-body .ff-modal:target[hidden]{
  display: none !important;
  visibility: hidden !important;
  pointer-events: none !important;
}
